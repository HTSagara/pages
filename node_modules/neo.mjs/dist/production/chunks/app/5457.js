"use strict";(self.webpackChunkneo_mjs=self.webpackChunkneo_mjs||[]).push([[5457],{1842:(e,t,d)=>{d.d(t,{A:()=>i});var n=d(2583);class o extends n.A{static config={className:"Neo.util.Style"};static compareStyles(e,t){let d={};return Neo.isString(e)&&(e=Neo.core.Util.createStyleObject(e)),Neo.isString(t)&&(t=Neo.core.Util.createStyleObject(t)),e||t?t?e?(Object.keys(e).forEach((function(n){t.hasOwnProperty(n)&&t[n]===e[n]||(d[n]=e[n])})),Object.keys(t).forEach((function(t){e.hasOwnProperty(t)||(d[t]=null)})),Object.keys(d).length>0?d:null):void Object.keys(t).forEach((function(e){d[e]=null})):Neo.clone(e):null}}Neo.applyClassConfig(o);const i=o},5457:(e,t,d)=>{d.r(t),d.d(t,{default:()=>c});var n=d(2583),o=d(6270),i=d(1842);class r{constructor(e){Object.assign(this,{attributes:e.attributes||[],childNodes:e.childNodes||[],className:e.className||[],id:e.id||Neo.getId("vnode"),innerHTML:e.innerHTML,nodeName:e.nodeName,style:e.style,vtype:e.vtype||"vnode"})}}Neo.ns("Neo.vdom",!0).VNode=r;const a=r;var s=d(4483);class l extends n.A{static config={className:"Neo.vdom.Helper",remote:{app:["create","update"]},singleton:!0};returnChildNodeOuterHtml=!1;voidAttributes=["checked","required"];voidElements=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];create(e){let t,d=e.appName,n=!0===e.autoMount,o=e.parentId,i=e.parentIndex;return delete e.appName,delete e.autoMount,delete e.parentId,delete e.parentIndex,t=this.parseHelper(e),t.outerHTML=this.createStringFromVnode(t),n&&Object.assign(t,{appName:d,autoMount:!0,parentId:o,parentIndex:i}),Neo.config.useVdomWorker?t:Promise.resolve(t)}createCloseTag(e){return this.voidElements.indexOf(e.nodeName)>-1?"":"</"+e.nodeName+">"}createDeltas(e){let t,d,n,r,a,l,c,p,h,u,N,m,f,v,y,b=this,g=e.deltas||[],V=e.index,x=e.newVnode,O=e.newVnodeRoot||x,k=e.oldVnode,I=e.oldVnodeRoot||k,H=e.parentId;if(x&&!k)I&&(h=b.findVnode(I,x.id,k)),h||g.push({action:"insertNode",id:x.id,index:V,outerHTML:b.createStringFromVnode(x),parentId:H});else if(!x&&k)if(O&&(p=b.findVnode(O,k.id,x)),p)g.push({action:"moveNode",id:k.id,index:p.index,parentId:p.parentNode.id}),h=b.findVnode(I,p.parentNode.id),b.createDeltas({deltas:g,newVnode:p.vnode,newVnodeRoot:O,oldVnode:k,oldVnodeRoot:I,parentId:p.parentNode.id}),h.vnode.childNodes.splice(p.index,0,p.vnode);else{if(d={action:"removeNode",id:k.id},"text"===k.vtype){let e=b.findVnode(I,k.id);d.parentId=e?.parentNode.id}g.push(d)}else{if(x&&k&&x.id!==k.id){if(p=b.findVnode(O,k.id,x),h=b.findVnode(I,x.id,k),!p&&!h)return g.push({action:"removeNode",id:k.id}),g.push({action:"insertNode",id:x.id,index:V,outerHTML:b.createStringFromVnode(x),parentId:H}),{indexDelta:0};if(p&&h&&p.parentNode.id===h.parentNode.id)g.push({action:"moveNode",id:h.vnode.id,index:V,parentId:H}),b.createDeltas({deltas:g,newVnode:x,newVnodeRoot:O,oldVnode:h.vnode,oldVnodeRoot:I,parentId:p.parentNode.id}),h.parentNode.childNodes.splice(V,0,h);else{if(!p&&h){if(x.id===h.vnode.id){if(a=0,s.A.findChildVnodeById(k,x.id))g.push({action:"replaceChild",fromId:k.id,parentId:H,toId:x.id});else{let e=s.A.findChildVnode(I,h.vnode.id),t=s.A.findChildVnode(I,k.id);if(a=1,e.parentNode.id===t.parentNode.id){let d=s.A.findChildVnode(O,x.id),n=V+1;for(r=V+1,v=t.parentNode.childNodes,c=e.index;r<c;r++)s.A.findChildVnode(d.parentNode,v[r].id)||n++;e.parentNode.childNodes.splice(e.index,1),e.index!==n&&g.push({action:"moveNode",id:h.vnode.id,index:V,parentId:H}),a=0}g.push({action:"removeNode",id:k.id,parentId:H})}return b.createDeltas({deltas:g,newVnode:x,newVnodeRoot:O,oldVnode:h.vnode,oldVnodeRoot:I,parentId:H}),{indexDelta:a}}return g.push({action:"removeNode",id:k.id}),{indexDelta:1}}if(!h)return y=p&&s.A.findChildVnodeById(x,k.id),y&&g.push({action:"removeNode",id:p.vnode.id}),g.push({action:"insertNode",id:x.id,index:V,outerHTML:b.createStringFromVnode(x),parentId:H}),{indexDelta:y?0:-1};if(p){a=0;let e=s.A.findChildVnode(O,x.id),t=e.parentNode.id===p.parentNode.id;return t&&e.index>p.index&&(a=e.index-p.index),t&&e.parentNode.childNodes[p.index].id===p.vnode.id||g.push({action:"moveNode",id:p.vnode.id,index:p.index,parentId:p.parentNode.id}),b.createDeltas({deltas:g,newVnode:p.vnode,newVnodeRoot:O,oldVnode:k,oldVnodeRoot:I,parentId:p.parentNode.id}),{indexDelta:0}}}}x&&k&&x.id===k.id&&("text"===x.vtype&&x.innerHTML!==k.innerHTML?g.push({action:"updateVtext",id:x.id,parentId:s.A.findChildVnode(O,x.id).parentNode.id,value:x.innerHTML}):(l=Object.keys(x),Object.keys(k).forEach((e=>{x.hasOwnProperty(e)?"attributes"===e&&Object.keys(k[e]).forEach((t=>{x[e].hasOwnProperty(t)||(x[e][t]=null)})):l.push(e)})),l.forEach((e=>{switch(d={},n=x[e],e){case"attributes":t={},Object.entries(n).forEach((([e,d])=>{k.attributes.hasOwnProperty(e)&&k.attributes[e]===d||null!==d&&!Neo.isString(d)&&Neo.isEmpty(d)||(t[e]=d)})),Object.keys(t).length>0&&(d.attributes=t,Object.entries(t).forEach((([e,t])=>{null!==t&&""!==t||delete x.attributes[e]})));break;case"childNodes":for(r=0,a=0,c=Math.max(n.length,k.childNodes.length);r<c;r++)f=b.createDeltas({deltas:g,index:r,newVnode:n[r],newVnodeRoot:O,oldVnode:k.childNodes[r+a],oldVnodeRoot:I,parentId:x.id}),f&&f.indexDelta&&(a+=f.indexDelta);if(a<0)for(r=n.length+a;r<k.childNodes.length;r++)g.push({action:"removeNode",id:k.childNodes[r].id});break;case"nodeName":case"innerHTML":n!==k[e]&&(d[e]=n);break;case"style":u=i.A.compareStyles(n,k.style),u&&(d.style=u);break;case"className":k.className?(N=o.A.difference(n,k.className),m=o.A.difference(k.className,n)):(N=n,m=[]),(N.length>0||m.length>0)&&(d.cls={add:N,remove:m})}Object.keys(d).length>0&&(d.id=x.id,g.push(d))}))))}return g}createOpenTag(e){let t,d="<"+e.nodeName,n=e.attributes,o=e.className;return e.style&&(t=Neo.createStyles(e.style),""!==t&&(d+=` style="${t}"`)),o&&(Array.isArray(o)&&(o=o.join(" ")),""!==o&&(d+=` class="${o}"`)),e.id&&(Neo.config.useDomIds?d+=` id="${e.id}"`:d+=` data-neo-id="${e.id}"`),Object.entries(n).forEach((([e,t])=>{this.voidAttributes.includes(e)?"true"===t&&(d+=` ${e}`):"removeDom"!==e&&(d+=` ${e}="${t?.replaceAll?.('"',"&quot;")??t}"`)})),d+">"}createStringFromVnode(e){let t=this;switch(e.vtype){case"root":return t.createStringFromVnode(e.childNodes[0]);case"text":return void 0===e.innerHTML?"":String(e.innerHTML);case"vnode":return t.createOpenTag(e)+t.createTagContent(e)+t.createCloseTag(e);default:return""}}createTagContent(e){if(e.innerHTML)return e.innerHTML;let t,d,n="",o=e.childNodes?e.childNodes.length:0,i=0;for(;i<o;i++)t=e.childNodes[i],d=this.createStringFromVnode(t),t.innerHTML!==d&&this.returnChildNodeOuterHtml&&(t.outerHTML=d),n+=d;return n}findVnode(e,t,d,n){n||(n=0);let o,i,r,a,s=null;if(e.id===t)s={index:n,parentNode:d,vnode:e};else if("text"!==e.vtype)for(o=e.childNodes,r=0,a=o?.length||0;r<a;r++)if(i=this.findVnode(o[r],t,e,r),i&&i.vnode.id===t){s=i;break}return s&&"root"===s.parentId&&(s.index=null),s}parseHelper(e){if(!0===e.removeDom)return null;if("text"===e.vtype)return e.id||(e.id=Neo.getId("vtext")),e.innerHTML=`\x3c!-- ${e.id} --\x3e${e.html||""}\x3c!-- /neo-vtext --\x3e`,delete e.html,e;let t,d=this,n={attributes:{},childNodes:[],style:{}};return e.tag||(e.tag="div"),Object.entries(e).forEach((([e,o])=>{let i,r,a;if(null!=o&&"flag"!==e)switch(e){case"tag":case"nodeName":n.nodeName=o;break;case"html":case"innerHTML":n.innerHTML=o.toString();break;case"children":case"childNodes":case"cn":Array.isArray(o)||(o=[o]),r=[],o.forEach((e=>{!0!==e.removeDom&&(delete e.removeDom,t=d.parseHelper(e),t&&r.push(t))})),n.childNodes=r;break;case"cls":o&&!Array.isArray(o)?n.className=[o]:Array.isArray(o)&&o.length<1||(n.className=o);break;case"data":o&&"Object"===Neo.typeOf(o)&&Object.entries(o).forEach((([e,t])=>{n.attributes[`data-${Neo.decamel(e)}`]=t}));break;case"height":case"maxHeight":case"maxWidth":case"minHeight":case"minWidth":case"width":i=o!=parseInt(o),n.style[e]=o+(i?"":"px");break;case"id":n.id=o;break;case"style":a=n.style,Neo.isString(o)?n.style=Object.assign(a,Neo.core.Util.createStyleObject(o)):n.style=Object.assign(a,o);break;default:"removeDom"!==e&&(n.attributes[e]=o+"")}})),new a(n)}update(e){let t=this.parseHelper(e.vdom),d={deltas:this.createDeltas({newVnode:t,oldVnode:e.vnode}),updateVdom:!0,vnode:t};return Neo.config.useVdomWorker?d:Promise.resolve(d)}}const c=Neo.applyClassConfig(l)}}]);