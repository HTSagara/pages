"use strict";(self.webpackChunkneo_mjs=self.webpackChunkneo_mjs||[]).push([[5457],{8596:(e,t,a)=>{a.d(t,{A:()=>n});var o=a(2583);class d extends o.A{static charEntityMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;",$:"&dollar;","\\":"&bsol;","/":"&sol;"};static charPattern=/[&<>"'$\\]/g;static entityPattern=/(&amp;)|(&lt;)|(&gt;)|(&quot;)|(&apos;)|(&dollar;)|(&bsol;)|(&sol;)/g;static config={className:"Neo.util.String"};static escapeHtml(e){let t=this;return Neo.isString(e)?e.replace(t.charPattern,t.getEntityFromChar.bind(t)):e}static getCharFromEntity(e){return Object.keys(this.charEntityMap).find((t=>this.charEntityMap[t]===e))||e}static getEntityFromChar(e){return this.charEntityMap[e]||e}static unescapeHtml(e){let t=this;return Neo.isString(e)?e.replace(t.entityPattern,t.getCharFromEntity.bind(t)):e}static uncapitalize(e){return e&&e[0].toLowerCase()+e.substring(1)}}Neo.setupClass(d);const n=d},1842:(e,t,a)=>{a.d(t,{A:()=>n});var o=a(2583);class d extends o.A{static config={className:"Neo.util.Style"};static compareStyles(e,t){let a={};return Neo.isString(e)&&(e=Neo.createStyleObject(e)),Neo.isString(t)&&(t=Neo.createStyleObject(t)),e||t?t?e?(Object.keys(e).forEach((o=>{t.hasOwnProperty(o)&&t[o]===e[o]||(a[o]=e[o])})),Object.keys(t).forEach((t=>{e.hasOwnProperty(t)||(a[t]=null)})),Object.keys(a).length>0?a:null):void Object.keys(t).forEach((function(e){a[e]=null})):Neo.clone(e):null}}Neo.setupClass(d);const n=d},5457:(e,t,a)=>{a.r(t),a.d(t,{default:()=>c});var o=a(2583),d=a(6270),n=a(8596),r=a(1842);class s{constructor(e){Object.assign(this,{attributes:e.attributes||[],childNodes:e.childNodes||[],className:e.className||[],id:e.id||Neo.getId("vnode"),innerHTML:e.innerHTML,nodeName:e.nodeName,style:e.style,vtype:e.vtype||"vnode"}),e.static&&(this.static=!0)}}Neo.ns("Neo.vdom",!0).VNode=s;const i=s;class l extends o.A{static config={className:"Neo.vdom.Helper",remote:{app:["create","update"]},singleton:!0};returnChildNodeOuterHtml=!1;voidAttributes=["checked","required"];voidElements=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];create(e){let t,a=!0===e.autoMount,{appName:o,parentId:d,parentIndex:n,windowId:r}=e;return delete e.appName,delete e.autoMount,delete e.parentId,delete e.parentIndex,delete e.windowId,t=this.createVnode(e),t.outerHTML=this.createStringFromVnode(t),a&&Object.assign(t,{appName:o,autoMount:!0,parentId:d,parentIndex:n,windowId:r}),Neo.config.useVdomWorker?t:Promise.resolve(t)}createCloseTag(e){return this.voidElements.indexOf(e.nodeName)>-1?"":"</"+e.nodeName+">"}compareAttributes(e){let t,a,o,n,s,i,l,{deltas:c,oldVnode:p,vnode:u,vnodeMap:h}=e;return"text"===u.vtype&&u.innerHTML!==p.innerHTML?c.default.push({action:"updateVtext",id:u.id,parentId:h.get(u.id).parentNode.id,value:u.innerHTML}):(n=Object.keys(u),Object.keys(p).forEach((e=>{u.hasOwnProperty(e)?"attributes"===e&&Object.keys(p[e]).forEach((t=>{u[e].hasOwnProperty(t)||(u[e][t]=null)})):n.push(e)})),n.forEach((e=>{switch(a={},o=u[e],e){case"attributes":t={},Object.entries(o).forEach((([e,a])=>{p.attributes.hasOwnProperty(e)&&p.attributes[e]===a||null!==a&&!Neo.isString(a)&&Neo.isEmpty(a)||(t[e]=a)})),Object.keys(t).length>0&&(a.attributes=t,Object.entries(t).forEach((([e,t])=>{null!==t&&""!==t||delete u.attributes[e]})));break;case"nodeName":case"innerHTML":o!==p[e]&&(a[e]=o);break;case"style":s=r.A.compareStyles(o,p.style),s&&(a.style=s);break;case"className":p.className?(i=d.A.difference(o,p.className),l=d.A.difference(p.className,o)):(i=o,l=[]),(i.length>0||l.length>0)&&(a.cls={},i.length>0&&(a.cls.add=i),l.length>0&&(a.cls.remove=l))}Object.keys(a).length>0&&(a.id=u.id,c.default.push(a))}))),c}createDeltas(e){let{deltas:t={default:[],remove:[]},oldVnode:a,vnode:o}=e,d=a?.id,n=o?.id;if(!o&&d)return t.remove.push({action:"removeNode",id:d}),t;if(o.static)return t;if(n!==d)throw new Error(`createDeltas() must get called for the same node. ${n}, ${d}`);let r,s,i,l=this,c=e.oldVnodeMap||l.createVnodeMap({vnode:a}),p=e.vnodeMap||l.createVnodeMap({vnode:o}),u=o.childNodes||[],h=a.childNodes||[],m=0,N=0,v=Math.max(u.length,h.length);if(l.compareAttributes({deltas:t,oldVnode:a,vnode:o,vnodeMap:p}),0===u.length&&h.length>1)return t.remove.push({action:"removeAll",parentId:n}),t;for(;m<v&&(r=u[m],i=h[m+N],r||i);m++)if(r&&r.id===i?.id)l.createDeltas({deltas:t,oldVnode:i,oldVnodeMap:c,vnode:r,vnodeMap:p});else{if(i){if(s=p.get(i.id),!s){l.removeNode({deltas:t,oldVnode:i,oldVnodeMap:c}),m--;continue}if(r&&n!==s.parentNode.id){m--,N++;continue}}r&&l[c.get(r.id)?"moveNode":"insertNode"]({deltas:t,oldVnodeMap:c,vnode:r,vnodeMap:p})}return t}createOpenTag(e){let t,a="<"+e.nodeName,{attributes:o}=e,d=e.className;return e.style&&(t=Neo.createStyles(e.style),""!==t&&(a+=` style="${t}"`)),d&&(Array.isArray(d)&&(d=d.join(" ")),""!==d&&(a+=` class="${d}"`)),e.id&&(Neo.config.useDomIds?a+=` id="${e.id}"`:a+=` data-neo-id="${e.id}"`),Object.entries(o).forEach((([e,t])=>{this.voidAttributes.includes(e)?"true"===t&&(a+=` ${e}`):"removeDom"!==e&&("value"===e&&(t=n.A.escapeHtml(t)),a+=` ${e}="${t?.replaceAll?.('"',"&quot;")??t}"`)})),a+">"}createStringFromVnode(e,t){let a=this,o=e?.id;if(o&&t?.get(o))return"";switch(e.vtype){case"root":return a.createStringFromVnode(e.childNodes[0],t);case"text":return void 0===e.innerHTML?"":String(e.innerHTML);case"vnode":return a.createOpenTag(e)+a.createTagContent(e,t)+a.createCloseTag(e);default:return""}}createTagContent(e,t){if(e.innerHTML)return e.innerHTML;let a,o,d="",n=e.childNodes?e.childNodes.length:0,r=0;for(;r<n;r++)a=e.childNodes[r],o=this.createStringFromVnode(a,t),a.innerHTML!==o&&this.returnChildNodeOuterHtml&&(a.outerHTML=o),d+=o;return d}createVnode(e){if(!0===e.removeDom)return null;if("text"===e.vtype)return e.id||(e.id=Neo.getId("vtext")),e.innerHTML=`\x3c!-- ${e.id} --\x3e${e.html||""}\x3c!-- /neo-vtext --\x3e`,delete e.html,e;let t,a=this,o={attributes:{},childNodes:[],style:{}};return e.tag||(e.tag="div"),Object.entries(e).forEach((([e,d])=>{let n,r,s;if(null!=d&&"flag"!==e)switch(e){case"tag":case"nodeName":o.nodeName=d;break;case"html":case"innerHTML":o.innerHTML=d.toString();break;case"children":case"childNodes":case"cn":Array.isArray(d)||(d=[d]),r=[],d.forEach((e=>{!0!==e.removeDom&&(delete e.removeDom,t=a.createVnode(e),t&&r.push(t))})),o.childNodes=r;break;case"cls":d&&!Array.isArray(d)?o.className=[d]:Array.isArray(d)&&d.length<1||(o.className=d);break;case"data":d&&"Object"===Neo.typeOf(d)&&Object.entries(d).forEach((([e,t])=>{o.attributes[`data-${Neo.decamel(e)}`]=t}));break;case"height":case"maxHeight":case"maxWidth":case"minHeight":case"minWidth":case"width":n=d!=parseInt(d),o.style[e]=d+(n?"":"px");break;case"id":o.id=d;break;case"static":o.static=d;break;case"style":s=o.style,Neo.isString(d)?o.style=Object.assign(s,Neo.core.Util.createStyleObject(d)):o.style=Object.assign(s,d);break;default:"removeDom"!==e&&(o.attributes[e]=d+"")}})),new i(o)}createVnodeMap(e){let{vnode:t,parentNode:a=null,index:o=0,map:d=new Map}=e,n=t?.id;return d.set(n,{id:n,index:o,parentNode:a,vnode:t}),t?.childNodes?.forEach(((e,a)=>{this.createVnodeMap({vnode:e,parentNode:t,index:a,map:d})})),d}findMovedNodes(e){let{movedNodes:t=new Map,oldVnodeMap:a,vnode:o,vnodeMap:d}=e,n=o?.id;return n&&(a.get(n)?t.set(n,d.get(n)):o.childNodes.forEach((e=>{"text"!==e.vtype&&this.findMovedNodes({movedNodes:t,oldVnodeMap:a,vnode:e,vnodeMap:d})}))),t}insertNode(e){let{deltas:t,oldVnodeMap:a,vnode:o,vnodeMap:d}=e,n=d.get(o.id),{index:r}=n,s=n.parentNode.id,i=this,l=i.findMovedNodes({oldVnodeMap:a,vnode:o,vnodeMap:d}),c=i.createStringFromVnode(o,l);t.default.push({action:"insertNode",index:r,outerHTML:c,parentId:s}),a.get(s).vnode.childNodes.splice(r,0,o),l.forEach((e=>{let{id:o}=e,n=e.parentNode.id;t.default.push({action:"moveNode",id:o,index:e.index,parentId:n}),i.createDeltas({deltas:t,oldVnode:a.get(o).vnode,oldVnodeMap:a,vnode:e.vnode,vnodeMap:d})}))}moveNode(e){let{deltas:t,oldVnodeMap:a,vnode:o,vnodeMap:n}=e,r=n.get(o.id),{index:s,parentNode:i}=r,l=i.id,c=a.get(o.id),p=c.parentNode,{childNodes:u}=p;if(l!==p.id){d.A.remove(u,c.vnode);let e=a.get(l);e&&(c.parentNode=e.vnode,u=c.parentNode.childNodes)}t.default.push({action:"moveNode",id:o.id,index:s,parentId:l}),d.A.insert(u,s,c.vnode),this.createDeltas({deltas:t,oldVnode:c.vnode,oldVnodeMap:a,vnode:o,vnodeMap:n})}removeNode(e){let{deltas:t,oldVnode:a,oldVnodeMap:o}=e,n={action:"removeNode",id:a.id},{parentNode:r}=o.get(a.id);"text"===a.vtype&&(n.parentId=r.id),t.remove.push(n),d.A.remove(r.childNodes,a)}update(e){let t=this.createVnode(e.vdom),a=this.createDeltas({oldVnode:e.vnode,vnode:t});a=a.default.concat(a.remove);let o={deltas:a,updateVdom:!0,vnode:t};return Neo.config.useVdomWorker?o:Promise.resolve(o)}}const c=Neo.setupClass(l)}}]);