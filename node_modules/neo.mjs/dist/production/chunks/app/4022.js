"use strict";(self.webpackChunkneo_mjs=self.webpackChunkneo_mjs||[]).push([[4022],{4022:(e,t,o)=>{o.d(t,{Z:()=>f});var n=o(395),d=o(6717),r=o(9375),s=o(2718),i=o(5328);class a extends r.Z{static config={className:"Neo.util.KeyNavigation",ntype:"keynav",component_:null,keyDownEventBubble:!1,keys_:null};add(e){this._keys.push(...this.parseKeys(e))}beforeGetComponent(){return Neo.getComponent(this._component)}beforeSetComponent(e){return e?.id}destroy(){this.unregister(),super.destroy()}onKeyDown(e){if(e.key){let t,o=this,n=e.key.toUpperCase();n=o.parseUpperCaseKey(n),o.keys.forEach((o=>{t=Neo.get(o.scope),o.key.toUpperCase()===n&&t[o.fn]?.apply(t,[e])}))}}parseKeys(e){if(!Array.isArray(e)){let t=this._component,o=[];t&&(Object.entries(e).forEach((([e,n])=>{o.push({fn:n,key:e,scope:t})})),e=o)}return e}parseUpperCaseKey(e){switch(e){case" ":e="SPACE";break;case"ARROWDOWN":e="DOWN";break;case"ARROWLEFT":e="LEFT";break;case"ARROWRIGHT":e="RIGHT";break;case"ARROWUP":e="UP"}return e}register(e){let t=this;t.component=e,t.keys=t.parseKeys(t.keys),e.addDomListeners({keydown:{bubble:t.keyDownEventBubble,fn:t.onKeyDown,scope:t}})}removeKey(e){let t,o=this._keys,n=0,d=o.length;for(;n<d;n++)if(t=o[n],Neo.isEqual(t,e)){i.Z.remove(o,t);break}}removeKeys(e){Array.isArray(e)&&e.forEach((e=>this.removeKey(e)))}unregister(){}}Neo.applyClassConfig(a);const l=a;var m=o(8041),p=(o(2544),o(6112)),h=o(8288),u=o(6500),c=o(4757);class g extends r.Z{static hideModes=["removeDom","visibility"];static observable=!0;static config={className:"Neo.component.Base",ntype:"component",appName_:null,autoMount:!1,autoRender:!1,baseCls:[],bind:null,cls_:null,containsFocus_:!1,controller_:null,data_:null,disabled_:!1,domListeners_:null,droppable_:!1,dropZone:null,dropZoneConfig:null,hasBeenMounted:!1,hasRenderingListener:!1,hasUnmountedVdomChanges_:!1,height_:null,hidden_:!1,hideMode_:"removeDom",html_:null,isVdomUpdating:!1,keys_:null,maxHeight_:null,maxWidth_:null,minHeight_:null,minWidth_:null,model_:null,modelData:null,mounted_:!1,needsVdomUpdate:!1,parentId:"document.body",plugins_:null,rendering_:!1,role_:null,silentVdomUpdate_:!1,style_:null,tooltips_:null,ui_:null,vnode_:null,width_:null,wrapperCls_:null,wrapperStyle_:null,_vdom:{}};get listeners(){return this._listeners||{}}set listeners(e){this._listeners=e}get rendered(){return this._rendered||!1}set rendered(e){let t=this;t._rendered=e,!0===e&&t.fire("rendered",t.id)}get vdom(){return this._vdom}set vdom(e){this.afterSetVdom(e,e)}addCls(e){let t=this.cls;i.Z.add(t,e),this.cls=t}addDomListeners(e){Array.isArray(e)||(e=[e]);let t=this.domListeners;t.push(...e),this.domListeners=t}addStyle(e){return"string"==typeof e&&(e=h.Z.createStyleObject(e)),this.style=Object.assign(this.style,e)}afterSetAppName(e,t){e&&Neo.currentWorker.insertThemeFiles(e,this.__proto__)}afterSetCls(e,t){t=t||[];let o,n=this,d=n.vdom,r=n.getVdomRoot();d!==r?r.cls=[...e]:(o=i.Z.union(n.wrapperCls,e),i.Z.remove(o,i.Z.difference(t,e)),d.cls=o),n.isVdomUpdating||n.silentVdomUpdate?n.needsVdomUpdate=!0:n.mounted&&n.updateCls(e,t,r.id)}afterSetConfig(e,t,o){if(Neo.currentWorker.isUsingViewModels&&void 0!==o){let o=this.bind?.[e];o?.twoWay&&this.getModel()?.setData(o.key,t)}}afterSetDisabled(e,t){let o=this.cls;i.Z[e?"add":"remove"](o,"neo-disabled"),this.cls=o}afterSetDomListeners(e,t){let o=this;o.getController()?.parseDomListeners(o),s.Z.updateDomListeners(o,e,t)}afterSetDroppable(e,t){let n=this;e&&!n.dropZone&&o.e(608).then(o.bind(o,608)).then((e=>{n.dropZone=Neo.create({module:e.default,appName:n.appName,owner:n,...n.dropZoneConfig})}))}afterSetHasUnmountedVdomChanges(e,t){if(e||!e&&t){let t,o=d.Z.getParentIds(this),n=0,r=o.length;for(;n<r;n++)t=Neo.getComponent(o[n]),t&&(t._hasUnmountedVdomChanges=e)}}afterSetHeight(e,t){this.changeVdomRootKey("height",e)}afterSetHidden(e,t){let o=this;e&&void 0===t&&"removeDom"===o.hideMode?o.vdom.removeDom=!0:(e||void 0!==t)&&o[e?"hide":"show"]()}afterSetHtml(e,t){this.changeVdomRootKey("html",e)}afterSetId(e,t){super.afterSetId(e,t),this.changeVdomRootKey("id",e),t&&d.Z.unregister(t),d.Z.register(this)}afterSetMaxHeight(e,t){this.changeVdomRootKey("maxHeight",e)}afterSetMaxWidth(e,t){this.changeVdomRootKey("maxWidth",e)}afterSetMinHeight(e,t){this.changeVdomRootKey("minHeight",e)}afterSetMinWidth(e,t){this.changeVdomRootKey("minWidth",e)}afterSetMounted(e,t){if(void 0!==t){let t=this;e&&(t.hasBeenMounted=!0,t.domListeners?.length>0&&setTimeout((()=>{s.Z.mountDomListeners(t)}),100),t.fire("mounted",t.id))}}afterSetRole(e,t){this.changeVdomRootKey("role",e)}afterSetStyle(e,t){(e||void 0!==t)&&this.updateStyle(e,t)}afterSetTooltips(e,t){if(e){let t=this;Neo.ns("Neo.tooltip.Base")?t.createTooltips(e):Promise.all([o.e(9119),o.e(25)]).then(o.bind(o,44)).then((o=>{t.createTooltips(e)}))}}afterSetUi(e,t){let o=this,n=o.cls;i.Z.remove(n,`neo-${o.ntype}-${t}`),e&&""!==e&&i.Z.add(n,`neo-${o.ntype}-${e}`),o.cls=n}afterSetVdom(e,t){let o,n=this,d=Neo.apps[n.appName],r=e;n._vdom!==r&&(m.Z.warn("vdom got replaced for: "+n.id+". Copying the content into the reference holder object"),Object.keys(n._vdom).forEach((e=>{delete n._vdom[e]})),r=Object.assign(n._vdom,r)),n.silentVdomUpdate?n.needsVdomUpdate=!0:(n.mounted||!n.isConstructed||n.hasRenderingListener||!0!==d?.rendering?n.mounted&&n.vnode&&n.updateVdom(r,n.vnode):(n.hasRenderingListener=!0,o=d.on("mounted",(()=>{d.un("mounted",o),setTimeout((()=>{n.vnode&&n.updateVdom(n.vdom,n.vnode)}),50)}))),n.hasUnmountedVdomChanges=!n.mounted&&n.hasBeenMounted)}afterSetVnode(e,t){void 0!==t&&this.syncVnodeTree()}afterSetWidth(e,t){this.changeVdomRootKey("width",e)}afterSetWrapperCls(e,t){t=t||[],e=e||[];let o=this,n=o.vdom,d=o.getVdomRoot(),r=o.vdom?.cls||[];n===d?(r=i.Z.union(r,e),i.Z.remove(r,i.Z.difference(t,e)),n.cls=r):(e=e||[],t&&i.Z.remove(r,t),i.Z.add(r,e),n&&(n.cls=r)),o.isVdomUpdating||o.silentVdomUpdate?o.needsVdomUpdate=!0:o.mounted&&o.updateCls(e,t)}afterSetWrapperStyle(e,t){if(e||void 0!==t){let o=this,n=o.vdom;n.id?o.updateStyle(e,t,n.id):(n.style=e,o.update())}}beforeGetCls(e){return e?[...e]:[]}beforeGetData(e){return this.getModel().getHierarchyData()}beforeGetStyle(e){return{...e}}beforeGetWrapperCls(e){return e?[...e]:[]}beforeGetWrapperStyle(e){return{...Object.assign(this.vdom.style||{},e)}}beforeSetCls(e,t){return i.Z.union(e||[],this.baseCls)}beforeSetController(e,t){return t?.destroy(),e?n.Z.beforeSetInstance(e,null,{component:this}):e}beforeSetDomListeners(e,t){return Neo.isObject(e)&&(e=[e]),e||[]}beforeSetHideMode(e,t){return this.beforeSetEnumValue(e,t,"hideMode")}beforeSetKeys(e,t){return t?.destroy(),e&&(e=n.Z.beforeSetInstance(e,l,{keys:e})),e}beforeSetModel(e,t){if(t?.destroy(),e){let t=this,o={component:t};return t.modelData&&(o.data=t.modelData),n.Z.beforeSetInstance(e,"Neo.model.Component",o)}return null}beforeSetPlugins(e,t){return Array.isArray(e)&&e.forEach(((t,o)=>{e[o]=n.Z.beforeSetInstance(t,null,{owner:this})})),e}beforeSetSilentVdomUpdate(e,t){return!0===e?Neo.isNumber(t)?t+1:1:Neo.isNumber(t)&&t>0?t-1:0}changeVdomRootKey(e,t){let o=this.getVdomRoot();t?o[e]=t:delete o[e],this.update()}createTooltips(e){Array.isArray(e)||(e=[e]);let t,o=this,n=[];e.forEach((e=>{t=Neo.create("Neo.tooltip.Base",{appName:o.appName,componentId:o.id,...e}),n.push(t)})),o._tooltips=n}destroy(e=!1,t=!1){let o,n=this,r=n.parentId,s=Neo.getComponent(r),i=s?.getModel();n.domListeners=[],n.controller=null,n.reference&&n.getController()?.removeReference(n),n.model=null,n.bind&&i?.removeBindings(n.id),n.plugins?.forEach((e=>{e.destroy()})),e&&r&&("document.body"===r?Neo.applyDeltas(n.appName,{action:"removeNode",id:n.vdom.id}):(o=s.vdom,u.Z.removeVdomChild(o,n.vdom.id),s[t?"_vdom":"vdom"]=o)),d.Z.unregister(n),super.destroy()}down(e,t=!0){return d.Z.down(this,e,t)}focus(e=this.id){Neo.main.DomAccess.focus({id:e}).catch((e=>{console.log("Error attempting to receive focus for component",e,this)}))}getApp(){return Neo.apps[this.appName]}getConfigInstanceByNtype(e,t){let o,n=this,d=n[e];return!d||t&&t!==d.ntype?n.parentId&&(o=Neo.getComponent(n.parentId)||Neo.get(n.parentId),o)?o.getConfigInstanceByNtype(e,t):null:d}getController(e){return this.getConfigInstanceByNtype("controller",e)}getDomRect(e=this.id,t=this.appName){return Neo.main.DomAccess.getBoundingClientRect({appName:t,id:e})}getModel(e){return Neo.currentWorker.isUsingViewModels?this.getConfigInstanceByNtype("model",e):null}getMountedParentId(){let e=this.parentId,t=Neo.getComponent(e),o=t?.getVdomItemsRoot?.();return o?o.id:e}getMountedParentIndex(){let e,t=Neo.getComponent(this.parentId),o=t?.items||[],n=0,d=0,r=o.length;for(;n<r;n++){if(e=o[n],e===this)return d;e.hidden||"removeDom"!==e.hideMode||d++}}getParents(){return d.Z.getParents(this)}getPlugin(e){e="string"!=typeof e?e:{id:e};let t,o=this;for(const n of o.plugins||[]){t=!0;for(const o in e)if(n[o]!==e[o]){t=!1;break}if(t)return n}return null}getReference(e){return this.down({reference:e})}getTheme(){let e,t,o,n=this,d="neo-theme-";for(const e of n.cls||[])if(e.startsWith(d))return e;if(e=Neo.apps[n.appName],t=e?.mainView,t){o=u.Z.getParentNodes(t.vdom,n.id);for(const e of o||[])for(const t of e.cls||[])if(t.startsWith(d))return t}return Neo.config.themes?.[0]}getVdomChild(e,t){let o=u.Z.findVdomChild(t||this.vdom,e);return o?.vdom}getVdomRoot(){return this.vdom}getVnodeRoot(){return this.vnode}hide(e){let t=this;if("visibility"!==t.hideMode){let o=function(){t.unmount()};e?setTimeout(o,e):o()}else{let e=t.style;e.visibility="hidden",t.style=e}t._hidden=!0}init(){this.autoRender&&this.render()}initConfig(e,t){super.initConfig(e,t);let o=this;o.getController()?.parseConfig(o),o.getModel()?.parseConfig(o)}mergeConfig(...e){let t=this,o=super.mergeConfig(...e),n={...t._vdom||{},...o.vdom||{}};return t._vdom=Neo.clone(n,!0,!0),t[Neo.isEmpty(o.style)?"_style":"style"]=o.style,t.wrapperStyle=Neo.clone(o.wrapperStyle,!1),delete o.style,delete o._vdom,delete o.vdom,delete o.wrapperStyle,o}async mount(){let e,t,o=this;if(!o.vnode)throw new Error("Component vnode must be generated before mounting, use Component.render()");o.hasUnmountedVdomChanges?(o.hasUnmountedVdomChanges=!1,t=d.Z.getChildIds(o.vnode),t.forEach((t=>{e=Neo.getComponent(t),e&&(e._hasUnmountedVdomChanges=!1)})),o.render(!0)):(await Neo.currentWorker.promiseMessage("main",{action:"mountDom",appName:o.appName,id:o.id,html:o.vnode.outerHTML,parentId:o.getMountedParentId(),parentIndex:o.getMountedParentIndex()}),delete o.vdom.removeDom,await Neo.timeout(30),o.mounted=!0)}onConstructed(){super.onConstructed(),this.keys?.register(this)}onRender(e,t){let o=this,n=Neo.apps[o.appName];if(o.rendering=!1,n){n.rendered||(n.rendering=!1,n.rendered=!0,n.fire("render")),o.vnode=e;let r,s=d.Z.getChildIds(e),i=0,a=s.length;for(;i<a;i++)r=Neo.getComponent(s[i]),r&&(r.rendered=!0);o._rendered=!0,o.fire("rendered",o.id),t&&(o.mounted=!0,n.mounted||(n.mounted=!0,n.fire("mounted")))}}promiseVdomUpdate(e=this.vdom,t=this.vnode){let o=this,n=o.vdom;return n!==e&&(m.Z.warn("vdom got replaced for: "+o.id+". Copying the content into the reference holder object"),Object.keys(n).forEach((e=>{delete n[e]})),e=Object.assign(o._vdom,e)),o.silentVdomUpdate?Promise.resolve():new Promise(((n,d)=>{o.mounted?o.updateVdom(e,t,n,d):(o.update(),n())}))}removeCls(e){let t=this.cls;i.Z.remove(t,e),this.cls=t}removeDomListeners(e){Array.isArray(e)||(e=[e]);let t,o,n=this.domListeners;e.forEach((e=>{for(t=0,o=n.length;t<o;t++)if(Neo.isEqual(e,n[t])){n.splice(t,1);break}})),this.domListeners=n}removeStyle(e){"string"==typeof e&&(e=[e]);let t=this.style,o=!1;return Object.entries(t).forEach((n=>{e.indexOf(n)>-1&&(delete t[n],o=!0)})),o&&(this.style=t),t}render(e){let t=this,o=e||t.autoMount,n=Neo.apps[t.appName],d=Neo.config.useVdomWorker;t.rendering=!0,n.rendered||(n.rendering=!0),t.vdom&&(t.isVdomUpdating=!0,delete t.vdom.removeDom,Neo.vdom.Helper.create({appName:t.appName,autoMount:o,parentId:o?t.getMountedParentId():void 0,parentIndex:o?t.getMountedParentIndex():void 0,...t.vdom}).then((e=>{t.onRender(e,!!d&&o),t.isVdomUpdating=!1,o&&!d&&t.mount()})))}set(e={},t=!1){let o=this,n=!1===e.hidden&&e.hidden!==o.hidden;return o.silentVdomUpdate=!0,super.set(e),o.silentVdomUpdate=!1,t||!o.needsVdomUpdate?Promise.resolve():n?(o.show(),Promise.resolve()):o.promiseVdomUpdate()}setSilent(e={}){return this.set(e,!0)}show(){let e=this;if("visibility"!==e.hideMode)delete e.vdom.removeDom,e.silentVdomUpdate?e.needsVdomUpdate=!0:!e.mounted&&e.render(!0);else{let t=e.style;delete t.visibility,e.style=t}e._hidden=!1}syncVdomIds(e=this.vnode,t=this.vdom){u.Z.syncVdomIds(e,t)}syncVnodeTree(e=this.vnode){let t,o=this;o.syncVdomIds(),d.Z.getChildren(o).forEach((e=>{t=c.Z.findChildVnode(o.vnode,e.vdom.id),t?(e._vnode=t.vnode,e.rendered||(e._rendered=!0,e.fire("rendered",e.id)),e.mounted=!0):console.warn("syncVnodeTree: Could not replace the child vnode for",e.id)})),d.Z.getParents(o).forEach(((e,t)=>{o.vnode?0===t&&o.vnode.outerHTML?e.vnode.childNodes.splice(o.parentIndex||0,0,o.vnode):c.Z.replaceChildVnode(e.vnode,o.vnode.id,o.vnode):0===t&&c.Z.removeChildVnode(e.vnode,o.id)}))}toggleCls(e,t){let o=this.cls;i.Z.toggle(o,e,t),this.cls=o}unmount(){let e=this;e.vdom.removeDom=!0,e._hidden=!0,e.mounted=!1,Neo.currentWorker.promiseMessage("main",{action:"updateDom",appName:e.appName,deltas:[{action:"removeNode",id:e.vdom.id}]}).catch((t=>{console.log("Error attempting to unmount component",t,e)}))}up(e){return d.Z.up(this.id,e)}update(){this.afterSetVdom(this.vdom,null)}updateCls(e,t,o=this.id){let n=this,d=n.vnode,r=c.Z.findChildVnode(n.vnode,{id:o})?.vnode;Neo.isEqual(e,t)||(r&&(r.className=e,n.vnode=d),Neo.applyDeltas(n.appName,{id:o,cls:{add:i.Z.difference(e,t),remove:i.Z.difference(t,e)}}))}updateStyle(e,t,o=this.id){let n,d,r=this,s=p.Z.compareStyles(e,t),i=u.Z.findVdomChild(r.vdom,o),a=r.vnode&&c.Z.findChildVnode(r.vnode,o);s&&(r.hasUnmountedVdomChanges||(r.hasUnmountedVdomChanges=!r.mounted&&r.hasBeenMounted),i.vdom.style=e,r.silentVdomUpdate?r.needsVdomUpdate=!0:r.mounted&&(d=a.vnode.style,Object.entries(s).forEach((([e,t])=>{null===t?delete a.vnode.style[e]:d[e]=t})),n={action:"updateDom",deltas:[{id:o,style:s}]},Neo.currentWorker.isSharedWorker&&(n.appName=r.appName),Neo.currentWorker.sendMessage("main",n)))}updateVdom(e,t,o,n){let d,r,s=this;s.isVdomUpdating?s.needsVdomUpdate=!0:(s.isVdomUpdating=!0,r={vdom:e,vnode:t},Neo.currentWorker.isSharedWorker&&(r.appName=s.appName),Neo.vdom.Helper.update(r).catch((e=>{console.log("Error attempting to update component dom",e,s),s.isVdomUpdating=!1,n?.()})).then((e=>{s.vnode=e.vnode,s.isVdomUpdating=!1,d=e.deltas,!Neo.config.useVdomWorker&&d.length>0?Neo.applyDeltas(s.appName,d).then((()=>{o?.(),s.needsVdomUpdate&&(s.needsVdomUpdate=!1,s.vdom=s.vdom)})):(o?.(),s.needsVdomUpdate&&(s.needsVdomUpdate=!1,s.vdom=s.vdom))})))}}Neo.applyClassConfig(g);const f=g},6112:(e,t,o)=>{o.d(t,{Z:()=>r});var n=o(9375);class d extends n.Z{static config={className:"Neo.util.Style"};static compareStyles(e,t){let o={};return Neo.isString(e)&&(e=Neo.core.Util.createStyleObject(e)),Neo.isString(t)&&(t=Neo.core.Util.createStyleObject(t)),e||t?t?e?(Object.keys(e).forEach((function(n){t.hasOwnProperty(n)&&t[n]===e[n]||(o[n]=e[n])})),Object.keys(t).forEach((function(t){e.hasOwnProperty(t)||(o[t]=null)})),Object.keys(o).length>0?o:null):void Object.keys(t).forEach((function(e){o[e]=null})):Neo.clone(e):null}}Neo.applyClassConfig(d);const r=d}}]);