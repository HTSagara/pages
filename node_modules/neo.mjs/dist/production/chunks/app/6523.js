"use strict";(self.webpackChunkneo_mjs=self.webpackChunkneo_mjs||[]).push([[6523],{6523:(e,t,n)=>{n.r(t),n.d(t,{onStart:()=>k}),Neo.overwrites={Neo:{form:{field:{Text:{labelPosition_:"inline",showOptionalText_:!0}}}}},Neo.overwrites;var o=n(1345),a=n(9147),r=n(9119),s=n(3846);class i extends s.Z{static config={className:"Form.view.FormContainerController"};onComponentConstructed(){super.onComponentConstructed(),this.component.on({fieldChange:e=>console.log("fieldChange",e),fieldFocusLeave:e=>console.log("fieldFocusLeave",e),fieldUserChange:e=>console.log("fieldUserChange",e)})}onNextPageButtonClick(e){this.getModel().data.activeIndex++}onPrevPageButtonClick(e){this.getModel().data.activeIndex--}async onSaveButtonClick(e){let t=this.getReference("main-form"),n=await t.getValues();Neo.main.addon.LocalStorage.updateLocalStorageItem({appName:this.component.appName,key:"neo-form",value:JSON.stringify(n)})}}Neo.applyClassConfig(i);const l=i;var d=n(5163),c=n(5031);class u extends a.Z{static config={className:"Form.view.FormContainer",baseCls:["form-form-container","neo-container"],controller:l,items:[{module:c.Z,cls:["form-header"],flex:"none",items:[{module:d.Z,bind:{text:e=>e.activeTitle},cls:["form-header-label"],flex:"none"},"->",{iconCls:["fas","fa-file"],handler:"onValidatePageButtonClick",text:"Validate page"},{iconCls:["fas","fa-layer-group"],handler:"onValidateAllPagesButtonClick",style:{marginLeft:"1em"},text:"Validate all pages"},{iconCls:["fas","fa-floppy-disk"],handler:"onSaveButtonClick",style:{marginLeft:"1em"},text:"Save"}]},{module:r.Z,reference:"pages-container",layout:{ntype:"card",bind:{activeIndex:e=>e.activeIndex}},items:[{module:()=>Promise.all([n.e(2577),n.e(2416)]).then(n.bind(n,2416))},{module:()=>Promise.all([n.e(2577),n.e(5886),n.e(5921)]).then(n.bind(n,5921))},{module:()=>Promise.all([n.e(2577),n.e(2587)]).then(n.bind(n,2587))},{module:()=>n.e(2329).then(n.bind(n,2329))},{module:()=>n.e(1389).then(n.bind(n,1389))},{module:()=>Promise.all([n.e(2577),n.e(4609)]).then(n.bind(n,2770))},{module:()=>Promise.all([n.e(2577),n.e(8133)]).then(n.bind(n,8133))},{module:()=>Promise.all([n.e(2577),n.e(3961)]).then(n.bind(n,3961))},{module:()=>n.e(6173).then(n.bind(n,6173))},{module:()=>Promise.all([n.e(2577),n.e(5108),n.e(8075)]).then(n.bind(n,8075))},{module:()=>Promise.all([n.e(2577),n.e(5108),n.e(9479)]).then(n.bind(n,9479))},{module:()=>Promise.all([n.e(2577),n.e(7128)]).then(n.bind(n,7128))},{module:()=>Promise.all([n.e(2577),n.e(4727)]).then(n.bind(n,4727))},{module:()=>Promise.all([n.e(2577),n.e(7013)]).then(n.bind(n,7013))},{module:()=>Promise.all([n.e(2577),n.e(8966)]).then(n.bind(n,8966))}]},{module:c.Z,cls:["form-footer"],flex:"none",items:[{bind:{disabled:e=>0===e.activeIndex},handler:"onPrevPageButtonClick",iconCls:"fas fa-chevron-left",text:"Back"},"->",{bind:{disabled:e=>e.activeIndex===e.maxIndex},handler:"onNextPageButtonClick",iconCls:"fas fa-chevron-right",iconPosition:"right",style:{marginLeft:"1em"},text:"Next page"}]}]}}Neo.applyClassConfig(u);const f=u;var m=n(9585);class h extends m.Z{static config={className:"Form.view.SideNavList",baseCls:["form-side-nav-list","neo-list"],useHeaders:!0};createItemContent(e,t){let n=e[this.displayField];return e.isHeader?n:[{tag:"i",cls:this.getIconCls(e)},{html:n}]}getIconCls(e){let t=["neo-list-icon"];return!0===e.isValid?[...t,"neo-color-green","far","fa-circle-check"]:!1===e.isValid?[...t,"neo-color-red","far","fa-circle-xmark"]:[...t,"neo-color-blue","far","fa-circle"]}onSelect(e){let t=this,n=t.store.get(t.getItemRecordId(e[0]));t.getModel().setData({activeIndex:n.cardIndex,activeTitle:n.name})}onStoreLoad(){let e=-1;this.store.items.forEach((t=>{t.isHeader||e++})),this.getModel().data.maxIndex=e,super.onStoreLoad()}}Neo.applyClassConfig(h);const g=h;class p extends s.Z{static config={className:"Form.view.ViewportController"};async onValidateAllPagesButtonClick(e){let t=this.getReference("main-form"),n=await t.validate(),o=await t.getValues();console.log("All pages",{isValid:n,formValues:o}),await this.updateRecordValidityState()}async onValidatePageButtonClick(e){let t=this,n=t.getModel().data.activeIndex,o=t.getReference("pages-container").items[n],a=await o.getValues();await o.validate(),await t.updateRecordValidityState(n),console.log(`Current page: ${n+1}`,a)}async updateRecordValidityState(e=null){let t,n,o,a=this,r=a.getModel(),s=a.getReference("pages-container"),i=a.getReference("side-nav"),l=r.getStore("sideNav"),d=0,c=s.items.length;for(Neo.isNumber(e)&&(d=e,c=e+1);d<c;d++)o=s.items[d],n=i.getActiveIndex(d),t=await o.isValid(),l.getAt(n).isValid=t}}Neo.applyClassConfig(p);const v=p;var C=n(1758),N=n(2281);class y extends N.Z{static config={className:"Form.model.SideNav",fields:[{name:"cardIndex",type:"Integer"},{name:"id",type:"String"},{name:"isHeader",type:"Boolean"},{name:"isValid",type:"Boolean"},{name:"name",type:"String"}]}}Neo.applyClassConfig(y);const b=y;var x=n(5959);class P extends x.Z{static config={className:"Form.store.SideNav",model:b}}Neo.applyClassConfig(P);const S=P;class w extends C.Z{static config={className:"Form.view.ViewportModel",data:{activeIndex:0,activeTitle:"",maxIndex:0},stores:{sideNav:{module:S,autoLoad:!0,url:"../../resources/examples/data/formSideNav.json"}}};formData=null;construct(e){super.construct(e),Neo.main.addon.LocalStorage.readLocalStorageItem({appName:this.component.appName,key:"neo-form"}).then((e=>{this.formData=JSON.parse(e.value)}))}onDataPropertyChange(e,t,n){super.onDataPropertyChange(e,t,n);let o=this;if(o.formData&&"activeIndex"===e){let a=o.getController().getReference("pages-container").items[t];a instanceof Neo.core.Base?a.setValues(o.formData,!0):setTimeout((()=>{o.onDataPropertyChange(e,t,n)}),30)}}}Neo.applyClassConfig(w);const V=w;class E extends o.Z{static config={className:"Form.view.Viewport",controller:v,items:[{ntype:"container",style:{margin:"0 1em"},width:"300",items:[{flex:"none",vdom:{tag:"h1",innerHTML:"Nested Forms"}},{module:g,reference:"side-nav",bind:{headerlessActiveIndex:e=>e.activeIndex,store:"stores.sideNav"}}]},{module:f,reference:"main-form",style:{margin:"20px"}}],layout:{ntype:"hbox",align:"stretch"},model:V}}Neo.applyClassConfig(E);const F=E,k=()=>Neo.app({mainView:F,name:"Form"})},3846:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(3106),a=n(8041);class r extends o.Z{static config={className:"Neo.controller.Component",ntype:"component-controller",component:null,parent_:null,references:null};construct(e){super.construct(e);let t,n=this,o=n.component;n.references={},o.isConstructed?n.onComponentConstructed():t=o.on("constructed",(()=>{o.un("constructed",t),n.onComponentConstructed()}))}beforeSetParent(e,t){return e||this.getParent()}getHandlerScope(e,t){let n=this,o=n.parent;return!(!t||!t.resolveCallback(e,t).fn)||(Neo.isFunction(n[e])?n:o?o.getHandlerScope(e):null)}getModel(e=!1){let t=this.component;return e?t.model:t.getModel()}getParent(){let e=this;return e.parent?e.parent:e.component.parent?.getController()||null}getReference(e){let t=this,n=t.references[e];return n||(n=t.component.down({reference:e}),n&&(t.references[e]=n)),n||null}getStore(e){return this.getModel().getStore(e)}onComponentConstructed(){}parseConfig(e=this.component){let t,n,o=this,r=e.handler,s=e.listeners,i=e.reference,l=e.validator;r&&"string"==typeof r&&(n=o.getHandlerScope(r,e),!0!==n&&(e.handler=n[r].bind(e.handlerScope||n))),s&&Object.entries(s).forEach((([r,i])=>{"scope"!==r&&"delegate"!==r&&(Neo.isString(i)?(t=i,n=o.getHandlerScope(t,e),n?!0!==n&&(s[r]={},s[r].fn=n[t].bind(n)):a.Z.logError("Unknown event handler for",t,e)):i.forEach((r=>{Neo.isObject(r)&&r.hasOwnProperty("fn")&&Neo.isString(r.fn)&&(t=r.fn,n=o.getHandlerScope(t,e),n?!0!==n&&(r.fn=n[t].bind(n)):a.Z.logError("Unknown event handler for",t,e))})))})),Neo.isString(l)&&(n=o.getHandlerScope(l),n?e.validator=n[l].bind(n):a.Z.logError("Unknown validator for",e.id,e)),i&&(o.references[i]=e)}parseDomListeners(e=this.component){let t,n,o=this,r=e.domListeners;r&&r.forEach((r=>{Object.entries(r).forEach((([s,i])=>{t=null,"scope"!==s&&"delegate"!==s&&(Neo.isString(i)?t=i:Neo.isObject(i)&&i.hasOwnProperty("fn")&&Neo.isString(i.fn)&&(t=i.fn),t&&(n=o.getHandlerScope(t),n?r[s]=n[t].bind(n):a.Z.logError("Unknown domEvent handler for",t,e)))}))}))}removeReference(e){let t,n=this.references;for(t in n)if(e===n[t]){delete n[t];break}this.getParent()?.removeReference(e)}}Neo.applyClassConfig(r);const s=r},9147:(e,t,n)=>{n.d(t,{Z:()=>l});var o=n(9119),a=n(3980),r=n(6717),s=n(5328);class i extends o.Z{static config={className:"Neo.form.Container",ntype:"form-container",baseCls:["neo-form-container"],vdom:{tag:"form",cn:[],onsubmit:"return false;"}};static adjustTreeLeaves(e={},t,n,o=""){let a,r,s;Object.entries(e).forEach((([i,l])=>{a=!0,r=""===o?i:`${o}.${i}`,s=Neo.typeOf(l),"Array"!==s&&"Object"!==s||(a=n.includes(r),"Array"===s?l.forEach(((e,o)=>{"Object"===Neo.typeOf(e)&&this.adjustTreeLeaves(e,t,n,`${r}[${o}]`)})):"Object"===s&&this.adjustTreeLeaves(l,t,n,r)),a&&(e[i]=i===t?l:{[t]:l})}))}findNotLoadedModules(e=this,t=[]){return e.items.forEach((n=>{"Function"!==Neo.typeOf(n.module)||n.isLoading?n.items&&this.findNotLoadedModules(n,t):t.push({item:n,parent:e})})),t}async getField(e){await this.loadModules();let t,n=r.Z.getChildComponents(this);for(t of n)if(t instanceof a.Z&&(t.name===e||t.id===e))return t;return null}getFieldPath(e){let t=e.formGroup?e.formGroup.split("."):[];return t.push(e.name||e.id),t.join(".")}async getFields(){let e=[];return await this.loadModules(),r.Z.getChildComponents(this).forEach((t=>{t instanceof a.Z&&e.push(t)})),e}async getValues(){let e,t,n,o,a,r=await this.getFields(),s=Neo.form.field.Radio,i={};return r.forEach((r=>{a=r.getValue(),r.name?(e=r.name,r.formGroup&&(e=r.formGroup+"."+e),o=e.split("."),t=o.pop(),n=Neo.nsWithArrays(o,!0,i)):(t=r.id,n=i),s&&r instanceof s?Object.hasOwn(n,t)?a!==r.uncheckedValue&&(n[t]=a):n[t]=a:Object.hasOwn(n,t)&&void 0!==a?(n[t]===r.uncheckedValue?n[t]=[]:Array.isArray(n[t])||(n[t]=[n[t]]),a!==r.uncheckedValue&&n[t].unshift(a)):void 0!==a&&(n[t]=a)})),i}async isValid(){let e=await this.getFields(),t=0,n=e.length;for(;t<n;t++)if(!e[t].isValid())return!1;return!0}async loadModules(){let e=this.findNotLoadedModules(),t=[];return e.forEach((e=>{t.push(e.parent.layout.loadModule(e.item))})),e=await Promise.all(t),e}async reset(e={}){let t,n,o=this;(await o.getFields()).forEach((a=>{t=o.getFieldPath(a),n=Neo.nsWithArrays(t,!1,e),a.reset(t?n:null)}))}async setConfigs(e={},t=!1){let n,o,a,r,s,i=this;(await i.getFields()).forEach((l=>{r=i.getFieldPath(l),n=Neo.nsWithArrays(r,!1,e),n&&(t&&(l.suspendEvents=!0),o=Neo.form.field?.CheckBox&&l instanceof Neo.form.field.CheckBox,a=Neo.form.field?.Radio&&l instanceof Neo.form.field.Radio,s=n.value,(o||a)&&Object.hasOwn(n,"value")&&(n=Neo.clone(n,!0),a?n.checked=l.value===s:o&&("Array"===Neo.typeOf(s)?s.includes(l.value)&&(n.checked=!0):n.checked=l.value===s),delete n.value),l.set(n),t&&delete l.suspendEvents)}))}async setValues(e={},t=!1){let n,o=await this.getFields(),a=[];o.map((e=>{n=e.getPath(),n&&s.Z.add(a,n)})),e=Neo.clone(e,!0),i.adjustTreeLeaves(e,"value",a),await this.setConfigs(e,t)}async validate(){let e,t=!0;return(await this.getFields()).forEach((n=>{e=n.validate?.(!1),e||(t=!1)})),t}}Neo.applyClassConfig(i);const l=i},3980:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(4022),a=n(6717);class r extends o.Z{static delayable={fireChangeEvent:{type:"debounce",timer:1e3},fireUserChangeEvent:{type:"debounce",timer:1e3}};static config={className:"Neo.form.field.Base",ntype:"basefield",formGroup_:null,name_:null,renderName_:!0,renderPath:!0,value_:null};formGroupString=null;path=null;afterSetName(e,t){let n=this;n.renderName&&n.changeInputElKey("name",n.renderPath?n.getPath():e)}afterSetValue(e,t){void 0!==t&&this.fireChangeEvent(e,t)}beforeGetFormGroup(e){let t,n=this,o=[];return n.formGroupString?n.formGroupString:(e&&o.push(e),a.Z.getParents(n).forEach((e=>{e.formGroup&&o.unshift(e.formGroup)})),t=o.join("."),n.formGroupString=t,t)}changeInputElKey(e,t,n=!1){let o=this;t||Neo.isBoolean(t)||0===t?o.getInputEl()[e]=t:delete o.getInputEl()[e],!n&&o.update()}doFireChangeEvent(e,t,n){let o=this,r=Neo.form?.Container,s="field"+Neo.capitalize(n),i={component:o,oldValue:t,value:e};Neo.isFunction(o.getGroupValue)&&(i.groupValue=o.getGroupValue()),o.fire(n,i),o.suspendEvents||a.Z.getParents(o).forEach((e=>{r&&e instanceof r&&e.fire(s,i)}))}fireChangeEvent(e,t){this.doFireChangeEvent(e,t,"change")}fireUserChangeEvent(e,t){this.doFireChangeEvent(e,t,"userChange")}getClosestForm(){let e,t=this,n=Neo.form?.Container;for(e of a.Z.getParents(t))if(n&&e instanceof n)return e;return null}getInputEl(){return this.vdom}getPath(){let e,t=this;if(!t.name)return null;if(!t.path){if(e=t.formGroup?t.formGroup.split("."):[],t.name&&e.push(t.name),e.length<1)return null;t.path=e.join(".")}return t.path||(t.path="none"),"none"===t.path?null:t.path}getValue(){return this.value}isValid(){return!0}onFocusLeave(e){super.onFocusLeave?.(e);let t=this,n=Neo.form?.Container,o={...e,component:t,value:t.getValue()};Neo.isFunction(t.getGroupValue)&&(o.groupValue=t.getGroupValue()),t.suspendEvents||a.Z.getParents(t).forEach((e=>{n&&e instanceof n&&e.fire("fieldFocusLeave",o)}))}reset(e=null){this.value=e}validate(e=!0){return!0}}Neo.applyClassConfig(r);const s=r}}]);