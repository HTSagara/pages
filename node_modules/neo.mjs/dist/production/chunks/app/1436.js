"use strict";(self.webpackChunkneo_mjs=self.webpackChunkneo_mjs||[]).push([[1436],{1436:(e,t,n)=>{n.r(t),n.d(t,{default:()=>g});var o=n(4022),a=n(9892),r=n(5328);class i extends o.Z{static intervals=[15,30,60];static config={className:"Neo.calendar.view.week.TimeAxisComponent",baseCls:["neo-calendar-timeaxis"],bind:{endTime:e=>e.endTime,startTime:e=>e.startTime},endTime_:"24:00",interval_:30,rowHeight_:20,startTime_:"00:00",vdom:{style:{}}};construct(e){super.construct(e);let t=this;t.createItems(),t.afterSetRowHeight(t.rowHeight,0)}afterSetEndTime(e,t){if(void 0!==t){let t=this;e||(t._endTime="24:00"),t.afterSetRowHeight(t.rowHeight,0)}}afterSetInterval(e,t){void 0!==t&&this.afterSetRowHeight(this.rowHeight,0)}afterSetRowHeight(e,t){if(void 0!==t&&this.vdom.cn){let e,t,n=this,o=n.getTime(n.endTime),a=n.getTime(n.startTime),r=n.vdom,i=n.rowHeight,s=n.getRowsPerItem(),l=s*i+s,d=i+(o-a)*l;for(Object.assign(r.style,{backgroundImage:`linear-gradient(var(--c-w-background-color) ${l-1}px, var(--c-w-border-color) 1px)`,backgroundPositionY:1-l+"px",backgroundSize:`0.4em ${l}px`,height:d-i+1+"px",maxHeight:d-i+1+"px"}),e=0;e<25;e++)t={height:`${l}px`},e===a?t.marginTop=-2-i*(1===s?.5:2===s?1:2)+"px":delete t.marginTop,r.cn[e].style=t,r.cn[e].removeDom=e<a||e-1>=o;n.fire("change",{component:n,rowHeight:i,rowsPerItem:s,totalHeight:d})}}afterSetStartTime(e,t){void 0!==t&&this.afterSetRowHeight(this.rowHeight,0)}beforeSetInterval(e,t){return this.beforeSetEnumValue(e,t,"interval")}createItems(){let e,t,n=this.vdom;for(n.cn=[],t=0;t<25;t++)e=24===t?"00:00":(t<10?"0":"")+t+":00",n.cn.push({cls:["neo-c-w-timeaxis-item"],cn:[{html:e}]})}getRowsPerItem(){return 60===this.interval?1:30===this.interval?2:4}getTime(e){return e.split(":").map(Number)[0]}}Neo.applyClassConfig(i);const s=i;var l=n(6500);const d=new Date,m=d.getDate(),c=d.getMonth(),u=d.getFullYear();class h extends o.Z{static timeAxisPositions=["end","start"];static config={className:"Neo.calendar.view.week.Component",baseCls:["neo-calendar-weekcomponent"],bind:{calendarStore:"stores.calendars",currentDate:e=>e.currentDate,enableDrag:e=>e.events.enableDrag,endTime:e=>e.endTime,eventBorder:e=>e.events.border,eventStore:"stores.events",intlFormat_time:e=>e.intlFormat_time,locale:e=>e.locale,minimumEventDuration:e=>e.minimumEventDuration,showWeekends:e=>e.showWeekends,startTime:e=>e.startTime,weekStartDay:e=>e.weekStartDay},calendarStore_:null,columnsBuffer_:7,columnsVisible_:7,currentDate_:null,dayNameFormat_:"short",enableDrag_:!0,eventBorder_:null,eventDragZone:null,eventStore_:null,firstColumnDate:null,headerCreated:!1,intlFormat_day:null,intlFormat_time_:null,isUpdating:!1,locale_:Neo.config.locale,minimumEventDuration:30,needsEventUpdate:!1,owner:null,pluginDragDropConfig:null,pluginEventResizableConfig:null,showEventEndTime_:!1,showWeekends_:!0,timeAxis:null,timeAxisConfig:null,timeAxisPosition_:"start",totalColumns:null,vdom:{cn:[{cls:["neo-scroll-overlay"]},{cls:["neo-c-w-scrollcontainer"],flag:"neo-c-w-scrollcontainer",cn:[{cls:["neo-header-row"],flag:"neo-header-row",cn:[]},{cls:["neo-c-w-column-timeaxis-container"],flag:"neo-c-w-column-timeaxis-container",cn:[{cls:["neo-c-w-column-container"],flag:"neo-c-w-column-container",style:{},cn:[]}]}]}]},weekStartDay_:0};construct(e){super.construct(e);let t=this;t.addDomListeners([{dblclick:t.onEventDoubleClick,scope:t,delegate:".neo-event"},{wheel:t.onWheel,scope:t}]),t.timeAxis=Neo.create(s,{appName:t.appName,parentId:t.id,listeners:{change:t.onTimeAxisChange,scope:t},...t.timeAxisConfig}),t.getColumnTimeAxisContainer().cn["start"===t.timeAxisPosition?"unshift":"push"](t.timeAxis.vdom),t.calendarStore.getCount()>0&&t.eventStore.getCount()>0&&(t.needsEventUpdate=!0),t.updateHeader(!0,t.needsEventUpdate),t.needsEventUpdate&&t.updateEvents(!1),t.headerCreated=!0}adjustTotalHeight(e,t=!1){let n=e.rowHeight,o=e.rowsPerItem,a=e.totalHeight-n,r=0,i=[];for(;r<o;r++)i.push(`var(--c-w-background-color) ${r*n+r}px`,`var(--c-w-background-color) ${(r+1)*n+r}px`,"var(--c-w-border-color) 0");Object.assign(this.getColumnContainer().style,{backgroundImage:`linear-gradient(${i.join(",")})`,backgroundSize:`1px ${o*n+o}px`,height:`${a}px`,maxHeight:`${a}px`}),!t&&this.update()}afterSetCalendarStore(e,t){let n=this,o={load:n.onCalendarStoreLoad,recordChange:n.onCalendarStoreRecordChange,scope:n};t?.un(o),e?.on(o)}afterSetColumnsBuffer(e,t){this.totalColumns=this.visibleColumns+2*e}afterSetColumnsVisible(e,t){this.totalColumns=2*this.columnsBuffer+e}afterSetCurrentDate(e,t){let n=this;n.isConstructed&&(n.updateHeader(!1,!0),n.updateEvents())}afterSetDayNameFormat(e,t){let n=this;n.intlFormat_day=new Intl.DateTimeFormat(n.locale,{weekday:e}),t&&n.updateHeader()}afterSetEnableDrag(e,t){e&&!this.getPlugin({flag:"dragdrop"})&&Promise.all([n.e(8362).then(n.bind(n,8362)),n.e(9253).then(n.bind(n,9253))]).then((e=>{let t=this,n=t.plugins||[];n.push({module:e[0].default,appName:t.appName,flag:"dragdrop",...t.pluginDragDropConfig},{module:e[1].default,appName:t.appName,delegationCls:"neo-event",directions:["b","t"],flag:"resizable",...t.pluginEventResizableConfig}),t.plugins=n}))}afterSetEventBorder(e,t){let n=this.cls;t&&r.Z.remove(n,`neo-event-border-${t}`),e&&r.Z.add(n,`neo-event-border-${e}`),this.cls=n}afterSetEventStore(e,t){let n=this,o={load:n.onEventStoreLoad,recordChange:n.onEventStoreRecordChange,scope:n};t?.un(o),e?.on(o)}afterSetLocale(e,t){if(t){let t=this;t.intlFormat_day=new Intl.DateTimeFormat(e,{weekday:t.dayNameFormat}),t.updateHeader()}}async afterSetMounted(e,t){super.afterSetMounted(e,t);let n,o=this;e&&(o.needsEventUpdate&&(o.updateEvents(),o.needsEventUpdate=!1),await o.timeout(70),n=await o.getDomRect(o.getColumnContainer().id),Neo.main.DomAccess.scrollBy({appName:o.appName,direction:"left",id:o.getScrollContainer().id,value:n.width*o.columnsBuffer/o.columnsVisible/3}))}afterSetShowEventEndTime(e,t){void 0!==t&&this.updateEvents()}afterSetShowWeekends(e,t){let n=this,o=n.cls;r.Z[e?"add":"remove"](o,"neo-show-weekends"),n._cls=o,void 0!==t&&(n.updateHeader(!1,!0),n.updateEvents())}afterSetTimeAxisPosition(e,t){let n=this,o=n.cls,a=n.getColumnTimeAxisContainer();r.Z["end"===e?"add":"remove"](o,"neo-timeaxis-end"),void 0!==t&&a.cn.unshift(a.cn.pop()),n.cls=o,n.update()}afterSetWeekStartDay(e,t){void 0!==t&&(this.updateHeader(!1,!0),this.updateEvents())}beforeSetDayNameFormat(e,t){return this.beforeSetEnumValue(e,t,"dayNameFormat",a.Z.prototype.dayNameFormats)}beforeSetTimeAxisPosition(e,t){return this.beforeSetEnumValue(e,t,"timeAxisPosition")}beforeSetWeekStartDay(e,t){return this.beforeSetEnumValue(e,t,"weekStartDay",a.Z.prototype.weekStartDays)}createColumnAndHeader(e){let t,n,o=["neo-c-w-column","neo-draggable"],r=e.getDate(),i=e.getDay(),s=["neo-date"],l=!1;return 0!==i&&6!==i||(o.push("neo-weekend"),!this.showWeekends&&(l=!0)),r===m&&e.getMonth()===c&&e.getFullYear()===u&&s.push("neo-today"),t={cls:o,flag:a.Z.convertToyyyymmdd(e),removeDom:l},n={cls:["neo-header-row-item"],removeDom:l,cn:[{cls:["neo-day"],html:this.intlFormat_day.format(e)},{cls:s,html:r}]},{column:t,header:n}}destroy(...e){this.timeAxis=null,super.destroy(...e)}getColumnContainer(){return l.Z.getByFlag(this.vdom,"neo-c-w-column-container")}getColumnId(e){return`${this.id}_col_${a.Z.convertToyyyymmdd(e)}`}getColumnHeaderId(e){return`${this.id}_ch_${a.Z.convertToyyyymmdd(e)}`}getColumnTimeAxisContainer(){return l.Z.getByFlag(this.vdom,"neo-c-w-column-timeaxis-container")}getEventId(e){return`${this.id}__${e}`}getHeaderContainer(){return l.Z.getByFlag(this.vdom,"neo-header-row")}getIdKey(){return"c-w"}getScrollContainer(){return l.Z.getByFlag(this.vdom,"neo-c-w-scrollcontainer")}onCalendarStoreLoad(e){this.eventStore.getCount()>0&&this.updateEvents()}onCalendarStoreRecordChange(e){this.updateEvents()}onEventDoubleClick(e){if(this.data.events.enableEdit){!e.path[0].cls.includes("neo-event")&&e.path.shift();let t=this,n=t.owner.editEventContainer,o=e.path[0],a=l.Z.findVdomChild(t.vdom,o.id).vdom,r=t.eventStore.get(a.flag),i=n.style;Object.assign(i,{left:`${o.rect.width+15}px`,top:a.style.top}),n.setSilent({parentId:e.path[1].id,record:r,style:i}),n.render(!0)}}onEventStoreLoad(e){this.calendarStore.getCount()>0&&this.updateEvents()}onEventStoreRecordChange(e){this.updateEvents()}onFocusChange(e){let t=e.oldPath,n=e.path;t?.[0]?.cls.includes("neo-event")&&Neo.applyDeltas(this.appName,{id:t[0].id,cls:{remove:["neo-focus"]}}),n?.[0]?.cls.includes("neo-event")&&Neo.applyDeltas(this.appName,{id:n[0].id,cls:{add:["neo-focus"]}})}onTimeAxisChange(e){let t=this;t.adjustTotalHeight(e,t.headerCreated),t.headerCreated&&t.updateEvents()}onWheel(e){if(!this.isUpdating&&Math.abs(e.deltaX)>Math.abs(e.deltaY)){let t,n,o,a=this,r=a.getColumnContainer(),i=a.columnsBuffer,s=a.columnsVisible,l=a.firstColumnDate,d=a.getHeaderContainer(),m=0,c=50,u=e.clientWidth-c;if(e.deltaX>0&&Math.round(e.scrollLeft/u*i)>i+s-1){for(n=new Date(r.cn[r.cn.length-1].flag),r.cn.splice(0,i),d.cn.splice(0,i);m<i;m++)n.setDate(n.getDate()+1),t=a.createColumnAndHeader(n),r.cn.push(t.column),d.cn.push(t.header);l.setDate(l.getDate()+i),setTimeout((()=>{a.updateEvents(!1,i+s,a.totalColumns)}),50),o=-u}else if(e.deltaX<0&&Math.round(e.scrollLeft/u*i)<1){for(n=new Date(r.cn[0].flag),r.cn.length=i+s,d.cn.length=i+s;m<i;m++)n.setDate(n.getDate()-1),t=a.createColumnAndHeader(n),r.cn.unshift(t.column),d.cn.unshift(t.header);l.setDate(l.getDate()-i),setTimeout((()=>{a.updateEvents(!1,0,i)}),50),o=u}o&&(a.isUpdating=!0,a.promiseVdomUpdate().then((()=>{Neo.main.DomAccess.scrollBy({direction:"left",id:a.getScrollContainer().id,value:o}).then((()=>{a.isUpdating=!1}))})))}}setFirstColumnDate(e){e.setDate(e.getDate()-e.getDay()+this.weekStartDay-this.columnsBuffer)}updateEvents(e=!1,t=0,n=this.totalColumns){let o=this;if(o.mounted){let r,i,s,l,d,m,c,u,h,g,p,v,f,C,w,D,y=o.calendarStore,S=o.eventStore,b=o.timeAxis,_=b.getTime(o.endTime),E=b.getTime(o.startTime),x=_-E,T=a.Z.clone(o.firstColumnDate),H=o.vdom,k=o.getColumnContainer(),$=t,F=o.showEventEndTime;for(T.setDate(T.getDate()+t);$<n;$++){for(i=k.cn[$],i.cn=[],s=S.getDayRecords(T),p=s.length,g=0;g<p;g++)if(v=s[g],r=y.get(v.calendarId),r?.active){if(d=v.endDate,C=v.startDate,_<=C.getHours()||E>=d.getHours())continue;_<d.getHours()&&(d=a.Z.clone(d),d.setHours(_),d.setMinutes(0)),E>C.getHours()&&(C=a.Z.clone(C),C.setHours(E),C.setMinutes(0)),l=(d-C)/60/60/1e3,m=["neo-event","neo-draggable",`neo-${r.color}`],c=60*l/b.interval,u=!1,h=Math.round(l/x*100*1e3)/1e3,f=v[S.keyProperty],w=(60*C.getHours()+C.getMinutes())/60,D=Math.round((w-E)/x*100*1e3)/1e3,c<=2&&(u=b.rowHeight*c<(F?50:34),!u||F&&b.rowHeight/c>=34||m.push("neo-overflow")),F=!(u&&1===c||!F),F&&m.push("neo-show-end-time"),i.cn.push({cls:m,flag:f,id:o.getEventId(f),tabIndex:-1,cn:[{cls:["neo-event-time"],html:o.intlFormat_time.format(v.startDate),id:`${o.id}__time__${f}`},{cls:["neo-event-title"],html:v.title,id:`${o.id}__title__${f}`},{cls:["neo-event-time","neo-event-end-time"],html:o.intlFormat_time.format(v.endDate),id:`${o.id}__enddate__${f}`,removeDom:!F}],style:{height:`calc(${h}% - 2px)`,top:`calc(${D}% + 1px)`,width:"calc(100% - 1px)"}})}T.setDate(T.getDate()+1)}o[e?"_vdom":"vdom"]=H}else o.needsEventUpdate=!0}updateHeader(e=!1,t=!1){let n,o,r,i,s,l,d=this,h=d.currentDate,g=d.vdom,p=d.getColumnContainer(),v=d.getHeaderContainer(),f=0,C=d.showWeekends;for(d.setFirstColumnDate(h),d.firstColumnDate=a.Z.clone(h);f<d.totalColumns;f++)n=["neo-c-w-column","neo-draggable"],o=h.getDate(),r=h.getDay(),i=["neo-date"],l=!1,0!==r&&6!==r||(n.push("neo-weekend"),!C&&(l=!0)),o===m&&h.getMonth()===c&&h.getFullYear()===u&&i.push("neo-today"),s=d.getColumnHeaderId(h),e?(p.cn.push({cls:n,flag:a.Z.convertToyyyymmdd(h),id:d.getColumnId(h),removeDom:l}),v.cn.push({cls:["neo-header-row-item"],id:s,removeDom:l,cn:[{cls:["neo-day"],html:d.intlFormat_day.format(h),id:`${s}_day`},{cls:i,html:o,id:`${s}_date`}]})):(Object.assign(p.cn[f],{cls:n,flag:a.Z.convertToyyyymmdd(h),id:d.getColumnId(h),removeDom:l}),Object.assign(v.cn[f],{id:s,removeDom:l}),Object.assign(v.cn[f].cn[0],{html:d.intlFormat_day.format(h),id:`${s}_day`}),Object.assign(v.cn[f].cn[1],{cls:i,html:o,id:`${s}_date`})),h.setDate(h.getDate()+1);d[t?"_vdom":"vdom"]=g}}Neo.applyClassConfig(h);const g=h}}]);