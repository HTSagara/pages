"use strict";(self.webpackChunkneo_mjs=self.webpackChunkneo_mjs||[]).push([[8879],{8879:(e,t,n)=>{n.r(t),n.d(t,{default:()=>P});var a=n(232),o=n(5608);class s extends o.A{static config={className:"Portal.view.learn.ContentView",baseCls:["learn-content"]};record=null;onClick(e){let t=this,n=t.record;e.altKey&&e.shiftKey&&!e.metaKey?t.fire("edit",{component:t,record:n}):!e.altKey&&e.shiftKey&&e.metaKey&&t.fire("refresh",{component:t,record:n})}onConstructed(){super.onConstructed();let e=this;e.addDomListeners({click:e.onClick,scope:e})}}Neo.applyClassConfig(s);const r=s;var i=n(8202);class l extends i.A{static config={className:"Portal.model.Content",fields:[{name:"className",type:"String"},{name:"collapsed",type:"Boolean"},{name:"id",type:"Integer"},{name:"isLeaf",type:"Boolean"},{name:"name",type:"String"},{name:"parentId",type:"Integer"},{name:"path",type:"String"}]}}Neo.applyClassConfig(l);const c=l;var h=n(3303);class d extends h.A{static config={className:"LearnNeo.store.Content",model:c};xonConstructed(){super.onConstructed()}xload(){this.model=c,Neo.Main.getByPath({path:"location.search"}).then((e=>{const t=e?.substr(1)||"",n=t?JSON.parse(`{"${decodeURI(t.replace(/&/g,'","').replace(/=/g,'":"'))}"}`):{};this.deck=n.deck||"learnneo",this.url=`${this.contentPath}/tree.json`,super.load(),console.log(n)}))}get contentPath(){return`../../../resources/data/deck/${this.deck}`}doLoadStore(){const e=this;Neo.Xhr.promiseJson({url:`${this.contentPath}/tree.json`}).then((t=>{e.data=t.json.data}))}}Neo.applyClassConfig(d);const p=d;var u=n(9294),g=n(2044);class m extends a.A{static config={className:"Portal.view.learn.LivePreview",baseCls:["learn-live-preview"],value_:null,autoMount:!0,autoRender:!0,height:400,layout:"fit",items:[{module:u.A,reference:"tab-container",cls:"live-preview-container",items:[{module:g.A,hideLabel:!0,style:{height:"100%"},reference:"textArea",tabButtonConfig:{text:"Source"},listeners:{change:e=>e.component.up({className:"Portal.view.learn.LivePreview"}).value=e.value}},{tabButtonConfig:{text:"Preview"},reference:"preview",ntype:"container"}]}]};afterSetValue(e,t){e&&(this.getItem("textArea").value=e)}onConstructed(){super.onConstructed();let e=this;e.getReference("tab-container").on("activeIndexChange",e.onActiveIndexChange,e)}doRunSource(){let e=this.value;const t=/import\s+([\w-]+)\s+from\s+['"]([^'"]+)['"]/,n=/export\s+(?:default\s+)?(?:const|let|var|class|function|async\s+function|generator\s+function|async\s+generator\s+function|(\{[\s\S]*?\}))/g,a=[],o=[],s=[],r=this.findLastClassName(e);e.split("\n").forEach((e=>{let r=e.match(t);if(r){let e=r[1],t=r[2];s.push({moduleName:e,path:t}),o.push(e)}else e.match(n)||a.push(e)}));var i=[],l=[];const c=`\n            Promise.all([\n                ${s.map((e=>(i.push(`${e.moduleName}Module`),l.push(`const ${e.moduleName} = ${e.moduleName}Module.default`),`import("${e.path}")`))).join(",\n")}\n            ])\n            .then(([${i.join(", ")}]) => {\n                    ${l.join("\n")}\n                    ${a.join("\n")}\n                    if (${r} && Neo.component.Base.isPrototypeOf(${r})) container.add({module:${r}});\n                })\n            .catch(error=>container.add({ntype:'component',html:error.message}));\n        `,h=this.getReference("preview");h.removeAll();try{new Function("container",c)(h)}catch(e){h.add({ntype:"component",html:e.message})}}getItem(e,t=this.items){let n,a,o=0,s=t.length;for(;o<s;o++){if(n=t[o],n.reference===e)return n;if(n.items&&(a=this.getItem(e,n.items),a))return a}return null}onActiveIndexChange(e){"preview"===e.item.reference&&this.doRunSource()}findLastClassName(e){const t=/class\s+([a-zA-Z$_][a-zA-Z0-9$_]*)\s*(?:extends\s+[a-zA-Z$_][a-zA-Z0-9$_]*)?\s*{[\s\S]*?}/g;let n,a=null;for(;null!==(n=t.exec(e));)a=n[1];return a}}Neo.applyClassConfig(m);const f=m;var C=n(9375);class y extends C.A{static config={className:"Portal.view.learn.ContentTreeList",cls:["topics-tree"],showCollapseExpandAllIcons:!1,store:p};get contentPath(){return`../../resources/data/deck/${this.deck}`}async doFetchContent(e){let t=this,n=`${t.contentPath}`;if(n+=e.path?`/pages/${e.path}`:`/p/${e.id}.md`,e.isLeaf&&n){const a=await fetch(n),o=await a.text();let s=await this.highlightPreContent(o),r={};s=this.extractNeoContent(s,r),await Neo.main.addon.Markdown.markdownToHtml(s).then((n=>{n=t.insertLabDivs(n),t.fire("contentChange",{component:t,html:n,record:e,isLab:e.name?.startsWith("Lab:")})}),(()=>t.fire("contentChange",{component:t}))),await this.timeout(50),Object.keys(r).forEach((e=>{Neo.create(f,{value:r[e],parentId:e,appName:this.appName})}))}}extractNeoContent(e,t){let n=0;return e.replace(/<pre\s+data-neo\s*>([\s\S]*?)<\/pre>/g,((e,a)=>{const o=`pre-live-preview-${Neo.core.IdGenerator.getId()}-${n++}`;return t[o]=a,`<div id="${o}"></div>`}))}insertLabDivs(e){let t=e.replace(/<!--\s*lab\s*-->/g,'<div class="lab">');return t=t.replace(/<!--\s*\/lab\s*-->/g,"</div>"),t}async highlightPreContent(e){const t=[];let n=0;var a=e.replace(/<pre\s+data-javascript\s*>([\s\S]*?)<\/pre>/g,((e,a)=>{const o=`__NEO-PRE-TOKEN-${++n}__`;return t.push(this.getHighlightPromise(a,o,`pre-preview-${Neo.core.IdGenerator.getId()}`)),o}));return Promise.all(t).then((e=>(e.forEach((e=>a=a.replace(e.token,e.after))),a)))}getHighlightPromise(e,t,n){return Neo.main.addon.HighlightJS.highlightAuto(e).then((e=>({after:`<pre data-javascript id="${n}">${e.value}</pre>`,token:t})))}doLoadStore(){const e=this;Neo.Xhr.promiseJson({url:`${this.contentPath}/t.json`}).then((t=>{e.store.data=t.json.data,e.createItems(null,e.getListItemsRoot(),0),e.update()}))}onConstructed(){super.onConstructed();let e=this;Neo.main.addon.HighlightJS.loadLibrary({appName:e.appName,highlightJsPath:"../../docs/resources/highlight/highlight.pack.js",themePath:"../../docs/resources/highlightjs-custom-github-theme.css"}),Neo.Main.getByPath({path:"location.search"}).then((t=>{const n=t?.substr(1)||"",a=n?JSON.parse(`{"${decodeURI(n.replace(/&/g,'","').replace(/=/g,'":"'))}"}`):{};e.deck=a.deck||"learnneo",e.doLoadStore()}))}onLeafItemClick(e){super.onLeafItemClick(e),this.doFetchContent(e)}}Neo.applyClassConfig(y);const v=y;var N=n(5800);class w extends N.A{static config={className:"Portal.view.learn.MainContainerController"};onConstructed(){super.onConstructed(),Neo.Main.getByPath({path:"location.search"}).then((e=>{const t=e?.substr(1)||"",n=t?JSON.parse(`{"${decodeURI(t.replace(/&/g,'","').replace(/=/g,'":"'))}"}`):{};this.getModel().setData("deck",n.deck||"learnneo")})),fetch("../../../../resources/data/deck/EditorConfig.json").then((e=>e.json().then((e=>this.getModel().setData("editorConfig",e)))))}async onContentChange(e){let t=this.getReference("content");t.toggleCls("lab",e.isLab),t.html=e.html,t.record=e.record}async onContentEdit(e){const t=this.getModel();console.log(e);const n=t.getData("editorConfig"),a=t.getData("deck");if(!n||!a)return;const o=`${n.root}/${a}/p/${e.record.id}.md`;await fetch("http://localhost:3000/openInEditor",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:o,editor:n.editor})})}onContentRefresh(e){this.getReference("tree").doFetchContent(e.record)}}Neo.applyClassConfig(w);const $=w;var S=n(635);class A extends S.A{static config={className:"Portal.view.learn.MainContainerModel",data:{},stores:{tree:{module:p,responseRoot:"data"}}}}Neo.applyClassConfig(A);const b=A;var I=n(1721);class x extends a.A{static config={className:"Portal.view.learn.MainContainer",controller:$,cls:["learnneo-maincontainer"],items:[{module:a.A,layout:"fit",minWidth:350,width:350,cls:"sidenav-container",items:[{module:v,reference:"tree",listeners:{contentChange:"onContentChange"}}]},{module:I.A,cls:["main-content-splitter"],resizeTarget:"previous",size:4},{module:r,reference:"content",listeners:{edit:"onContentEdit",refresh:"onContentRefresh"}}],layout:{ntype:"hbox",align:"stretch"},model:b}}Neo.applyClassConfig(x);const P=x},2044:(e,t,n)=>{n.d(t,{A:()=>r});var a=n(8596),o=n(3599);class s extends o.A{static wrapValues=["hard","off","soft",null];static config={className:"Neo.form.field.TextArea",ntype:"textarea",autoGrow_:!1,baseCls:["neo-textarea","neo-textfield"],clearable:!1,cols_:null,inputTag_:"textarea",inputType:null,resizable_:!1,rows_:3,wrap_:null};afterSetAutoGrow(e){e&&this.syncAutoGrowMonitor(),e||this.afterSetHeight(this._height)}afterSetCols(e,t){this.changeInputElKey("cols",e)}afterSetInputTag(e,t){this.changeInputElKey("tag",e)}afterSetMounted(e,t){super.afterSetMounted(e,t),this.syncAutoGrowMonitor()}afterSetResizable(e,t){this.getInputEl().style.resize=e?null:"none",this.update()}afterSetRows(e,t){this.changeInputElKey("rows",e)}afterSetValue(e,t){let n=this.getInputEl();n&&(n.html=a.A.escapeHtml(e)),super.afterSetValue(e,t)}afterSetWrap(e,t){this.changeInputElKey("wrap",e)}beforeSetWrap(e,t){return this.beforeSetEnumValue(e,t,"wrap","wrapValues")}async syncAutoGrowMonitor(){this.mounted&&this.autoGrow&&Neo.main.DomAccess.monitorAutoGrow({appName:this.appName,id:this.getInputElId(),autoGrow:this.autoGrow})}}Neo.applyClassConfig(s);const r=s}}]);