"use strict";(self.webpackChunkneo_mjs=self.webpackChunkneo_mjs||[]).push([[3322],{4460:(e,t,i)=>{i.d(t,{A:()=>l});var r=i(232),n=(i(6270),i(7027)),o=i(3599);class s extends o.A{static config={className:"Neo.form.field.Picker",ntype:"pickerfield",baseCls:["neo-pickerfield","neo-textfield"],clientRects:null,keys:{Enter:"onKeyDownEnter",Escape:"onKeyDownEscape"},picker:null,pickerConfig:null,pickerHeight:100,pickerIsMounted_:!1,pickerMaxHeight:200,pickerWidth:null,showPickerOnFocus:!1,triggers:[{module:n.A}]};construct(e){super.construct(e);let t=this;t.addDomListeners({click:t.onInputClick,scope:t})}afterSetMounted(e,t){!1===e&&t&&this.pickerIsMounted&&this.picker.hide(),super.afterSetMounted(e,t)}afterSetTheme(e,t){super.afterSetTheme(e,t),this.picker&&(this.picker.theme=e)}createPicker(){const e=this,{pickerWidth:t}=e,i=e.createPickerComponent();return e.picker=Neo.create(r.A,{parentId:"document.body",floating:!0,align:{edgeAlign:t?"t0-b0":"t-b",matchSize:!t,axisLock:!0,target:e.getInputWrapperId()},appName:e.appName,cls:["neo-picker-container","neo-container"],height:e.pickerHeight,hidden:!0,id:e.getPickerId(),items:i?[i]:[],maxHeight:e.pickerMaxHeight,theme:e.theme,width:t,...e.pickerConfig,onFocusLeave:t=>{let i,r=!1;for(i of t.oldPath)if(i.id===e.id){r=!0;break}r||(e.hidePicker(),super.onFocusLeave(t))}}),e.picker.on("hiddenChange",e.onPickerHiddenChange,e),e.picker}createPickerComponent(){return null}destroy(...e){let t=this.picker;!1===t?.hidden&&t.unmount(),t?.destroy(),super.destroy(...e)}getPicker(){return this.picker||this.createPicker()}getPickerId(){return`${this.id}__picker`}async hidePicker(){this.picker&&(this.picker.hidden=!0)}onFocusEnter(e){super.onFocusEnter(e),this.showPickerOnFocus&&this.showPicker()}onFocusLeave(e){let t,i=this,r=!1;for(t of e.oldPath)if(t.id===i.getPickerId()){r=!0;break}r||(i.hidePicker(),super.onFocusLeave(e))}onInputClick(e){!this.editable&&this.togglePicker()}onKeyDownEnter(e,t,i){!this.pickerIsMounted&&this.showPicker(t,i)}onKeyDownEscape(e){this.pickerIsMounted&&this.hidePicker()}onPickerHiddenChange(e){this.pickerIsMounted=!e.value}onPickerTriggerClick(){this.editable&&this.togglePicker()}showPicker(){this.getPicker().hidden=!1}togglePicker(){let e=this.getPicker();e.hidden=!e.hidden}}Neo.applyClassConfig(s);const l=s},3322:(e,t,i)=>{i.d(t,{A:()=>p});var r=i(2778),n=i(293),o=i(5156),s=i(4460),l=i(3303),c=i(825),a=i(3439);class d extends s.A{static triggerActions=["all","filtered"];static config={className:"Neo.form.field.Select",ntype:"selectfield",baseCls:["neo-selectfield","neo-pickerfield","neo-textfield"],displayField:"name",filterOperator_:"like",forceSelection:!1,activeRecordId:null,keys:{Down:"onKeyDownDown",Escape:"onKeyDownEscape"},lastManualInput:null,list:null,listConfig_:null,pickerHeight:null,record_:null,role:"combobox",store_:null,triggerAction_:"all",typeAhead_:!0,useFilter_:!0,valueField:"id",filterDelay:300};construct(e){super.construct(e),this.filterOnInput=(0,a.r)(this.filterOnInput,this,this.filterDelay),this.typeAhead&&this.updateTypeAhead()}afterSetRecord(e){if(this._picker?.isVisible){let t=this,i=t.list?.selectionModel;e?i?.select(e):i.deselectAll()}}afterSetStore(e,t){let i,r=this;e&&(r.useFilter&&(i=e.filters||[],i.push({includeEmptyValues:!0,operator:r.filterOperator,property:r.displayField,value:e.get(r.value)?.[r.displayField]||r.value}),e.filters=i),r.list&&(r.list.store=e),e.on("load",r.onStoreLoad,r))}afterSetTypeAhead(e,t){this.rendered&&this.updateTypeAhead()}beforeSetListConfig(e,t){return e&&this.parseItemConfigs(e),e}beforeSetStore(e,t){return t?.destroy(),"Object"!==Neo.typeOf(e)||e.model||e.module||e.ntype||(e.model={fields:[{name:"id",type:"String"},{name:"name",type:"String"}]}),r.A.beforeSetInstance(e,l.A)}beforeSetTriggerAction(e,t){return this.beforeSetEnumValue(e,t,"triggerAction")}beforeSetValue(e,t){let i,r=this,n=r.displayField,o=r.store;return Neo.isObject(e)?(r.record=e,e[n]):(i=o.isFiltered()?o.allItems.get(e):o.get(e),i?(r.record=i,i[n]):(r.record=o.find(n,e)[0]||null,e))}createPickerComponent(){const e=this;return e.list=Neo.create({module:o.A,appName:e.appName,displayField:e.displayField,role:"listbox",itemRole:"option",parentId:e.id,navigator:{eventSource:e.getInputElId()},selectionModel:{stayInList:!1},store:e.store,...e.listConfig}),e.getInputEl()["aria-controls"]=e.list.id,e.list.addDomListeners({neonavigate:{fn:e.onListItemNavigate,scope:e}}),e.list.selectionModel.on({selectionChange:e.onListItemSelectionChange,noChange:e.onListItemSelectionNoChange,scope:e}),e.list}fireChangeEvent(e,t){let i,r,o=this,s=Neo.form?.Container,l=o.record;o.forceSelection&&!l||(i=o.store.get(t)||null,r={component:o,oldRecord:i,oldValue:t,record:l,value:e},o.fire("change",r),o.suspendEvents||n.A.getParents(o).forEach((e=>{s&&e instanceof s&&e.fire("fieldChange",r)})))}getInputHintEl(){return c.A.findVdomChild(this.vdom,this.getInputHintId())?.vdom}getInputHintId(){return this.id+"__input-hint"}getRecord(){let e=this.list,t=e.selectionModel.getSelection()[0];return t&&this.store.get(e.getItemRecordId(t))||null}getValue(){let e=this;return e.record?.[e.valueField]||e.value}onConstructed(){const e=this.getInputEl();e["aria-expanded"]=!1,e["aria-haspopup"]="listbox",e["aria-activedescendant"]="",super.onConstructed(...arguments)}onFocusLeave(e){let t=this;t.record||(t.forceSelection?t.value=t.forceSelection?t.activeRecordId:null:t.getInputEl().value=""),t.updateTypeAheadValue(""),t.record||t.forceSelection||delete t.getInputEl().value,super.onFocusLeave(e)}filterOnInput(e){e.value?this.doFilter(e.value):this.picker&&this.picker?.hide()}onInputValueChange(e){this.lastManualInput=e.value,this.filterOnInput(e)}onKeyDownDown(e){this.picker&&!this.picker?.hidden||this.onPickerTriggerClick()}onPickerHiddenChange({value:e}){const t=this.getInputEl();super.onPickerHiddenChange(...arguments),e&&(t["aria-activedescendant"]=""),t["aria-expanded"]=!e,this.update()}onListItemSelectionChange({selection:e}){if(e?.length){const t=this,i=t.value,r=e[0],n="string"==typeof r?t.store.get(t.list.getItemRecordId(r)):r,o=n[t.displayField];t.hidePicker(),t.hintRecordId=null,t.record=n,t._value=o,t.getInputHintEl().value=null,t.afterSetValue(o,i,!0),t.fire("select",{record:n,value:o})}}onListItemSelectionNoChange(){this.hidePicker()}onListItemNavigate({activeItem:e,activeIndex:t}){if(t>=0){const i=this,{store:r}=i;i.activeRecord=r.getAt(t),i.activeRecordId=i.activeRecord[r.keyProperty||model.keyProperty],i.getInputEl()["aria-activedescendant"]=e,i.typeAhead?i.updateTypeAheadValue(i.lastManualInput):i.update()}}onStoreLoad(e){let t=this,i=t.value;i&&(t._value=null,t.value=i)}selectFirstListItem(){this.selectListItem(0)}selectLastListItem(){this.selectListItem(this.store.getCount()-1)}selectListItem(e){let t=this;Neo.isNumber(e)||(e=t.activeRecordId?t.store.indexOfKey(t.activeRecordId):0),t.list.selectItem(e)}onPickerTriggerClick(){let e=this;e.picker?.isVisible?e.picker.hidden=!0:e.readOnly||e.disabled||e.doFilter(null)}doFilter(e){let t=this,i=t.store.getFilter(t.displayField),{record:r,picker:n}=t;if(i&&(i.value=e),t.store.getCount()){t.getPicker().hidden=!1;const{list:e}=t,{selectionModel:i}=e;r&&(i.suspendEvents=!0,i.select(r),i.suspendEvents=!1),setTimeout((()=>{e.activeIndex=t.record||0}),100)}else n&&(n._hidden=!0)}updateTypeAhead(e=!1){let t=this,i=c.A.findVdomChild(t.vdom,{flag:"neo-real-input"}),r=t.vdom;t.typeAhead?i.parentNode.cn[i.index]={tag:"span",cls:["neo-input-field-wrapper"],cn:[{tag:"input",autocomplete:"off",autocorrect:"off",cls:["neo-textfield-input","neo-typeahead-input"],disabled:!0,id:t.getInputHintId(),spellcheck:"false"},i.vdom]}:c.A.replaceVdomChild(r,i.parentNode.id,i.vdom),!e&&t.update()}updateTypeAheadValue(e=this.lastManualInput,t=!1){let i=this,r=!1,{store:n,displayField:o}=i,s=i.getInputHintEl();if(!i.record&&e?.length>0){const t=e.toLocaleLowerCase();r=n.items.find((e=>e[o]?.toLowerCase?.()?.startsWith(t))),r&&s&&(s.value=e+r[o].substr(e.length),i.activeRecord=r,i.activeRecordId=r[n.keyProperty||n.model.keyProperty])}!r&&s&&(s.value=i.activeRecord=i.activeRecordId=null),!t&&i.update()}}Neo.applyClassConfig(d);const p=d},7027:(e,t,i)=>{i.d(t,{A:()=>o});var r=i(718);class n extends r.A{static config={className:"Neo.form.field.trigger.Picker",ntype:"trigger-picker",iconCls:"fa fa-caret-down",type:"picker"};onTriggerClick(e){this.field.onPickerTriggerClick()}}Neo.applyClassConfig(n);const o=n}}]);