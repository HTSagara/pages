"use strict";
(self["webpackChunkneo_mjs"] = self["webpackChunkneo_mjs"] || []).push([["vendors-apps_portal_view_examples_TabContainer_mjs"],{

/***/ "./apps/portal/model/Example.mjs":
/*!***************************************!*\
  !*** ./apps/portal/model/Example.mjs ***!
  \***************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _src_data_Model_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../src/data/Model.mjs */ "./src/data/Model.mjs");


/**
 * @class Portal.model.Example
 * @extends Neo.data.Model
 */
class Example extends _src_data_Model_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        /**
         * @member {String} className='Portal.model.Example'
         * @protected
         */
        className: 'Portal.model.Example',
        /**
         * @member {Object[]} fields
         * @protected
         */
        fields: [{
            name: 'backgroundColor',
            type: 'String'
        }, {
            name        : 'browsers',
            type        : 'Array',
            defaultValue: ['Chrome', 'Edge', 'Firefox', 'Safari']
        }, {
            name        : 'environments',
            type        : 'Array',
            defaultValue: ['Desktop']
        }, {
            name        : 'hidden',
            type        : 'Boolean',
            defaultValue: false
        }, {
            name: 'id',
            type: 'Integer'
        }, {
            name: 'image',
            type: 'String'
        }, {
            name: 'name',
            type: 'String'
        }, {
            name        : 'sharedWorkers',
            type        : 'Boolean',
            defaultValue: false
        }, {
            name: 'sourceUrl',
            type: 'String'
        }, {
            name: 'url',
            type: 'String'
        }]
    }
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Neo.setupClass(Example));


/***/ }),

/***/ "./apps/portal/store/Examples.mjs":
/*!****************************************!*\
  !*** ./apps/portal/store/Examples.mjs ***!
  \****************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _model_Example_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../model/Example.mjs */ "./apps/portal/model/Example.mjs");
/* harmony import */ var _src_data_Store_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../src/data/Store.mjs */ "./src/data/Store.mjs");



/**
 * @class Portal.store.Examples
 * @extends Neo.data.Store
 */
class Examples extends _src_data_Store_mjs__WEBPACK_IMPORTED_MODULE_1__["default"] {
    static config = {
        /**
         * @member {String} className='Portal.store.Examples'
         * @protected
         */
        className: 'Portal.store.Examples',
        /**
         * @member {String} keyProperty='id'
         */
        keyProperty: 'id',
        /**
         * @member {Neo.data.Model} model=Example
         */
        model: _model_Example_mjs__WEBPACK_IMPORTED_MODULE_0__["default"]
    }
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Neo.setupClass(Examples));


/***/ }),

/***/ "./apps/portal/view/examples/List.mjs":
/*!********************************************!*\
  !*** ./apps/portal/view/examples/List.mjs ***!
  \********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _src_list_Base_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../src/list/Base.mjs */ "./src/list/Base.mjs");
/* harmony import */ var _src_util_VDom_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../src/util/VDom.mjs */ "./src/util/VDom.mjs");



/**
 * @class Portal.view.examples.List
 * @extends Neo.list.Base
 */
class List extends _src_list_Base_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    /**
     * A regex to enforce a maxLength (word break)
     * @member {RegExp} nameRegEx
     * @protected
     * @static
     */
    static nameRegEx = /^(.{65}[^\s]*).*/

    static config = {
        /**
         * @member {String} className='Portal.view.examples.List'
         * @protected
         */
        className: 'Portal.view.examples.List',
        /**
         * @member {String[]} baseCls=['portal-examples-list','neo-list']
         */
        baseCls: ['portal-examples-list', 'neo-list'],
        /**
         * @member {String} baseUrl='https://neomjs.com/'
         */
        baseUrl: 'https://neomjs.com/',
        /**
         * The env of the example links.
         * Valid values are 'development', 'dist/development', 'dist/production'
         * @member {String} environment='development'
         */
        environment: 'development',
        /**
         * Specify how many example item images to preload when intersecting
         * @member {Number} preloadImages=5
         */
        preloadImages: 5,
        /**
         * @member {String} sourceBaseUrl='https://github.com/neomjs/neo/tree/dev/'
         */
        sourceBaseUrl: 'https://github.com/neomjs/neo/tree/dev/',
        /**
         * @member {Boolean} useWrapperNode=true
         */
        useWrapperNode: true,
        /**
         * @member {Object} _vdom
         */
        _vdom:
        {cn: [
            {tag: 'ul', cn: []}
        ]}
    }

    /**
     * @member {String} imageBasePath
     */
    get imageBasePath() {
        let basePath;

        if (Neo.config.isGitHubPages) {
            basePath = '../../../../resources_pub/website/examples';

            if (Neo.config.environment !== 'development') {
                basePath = '../../' + basePath
            }
        } else {
            basePath = 'https://raw.githubusercontent.com/neomjs/pages/main/resources_pub/website/examples'
        }

        return basePath
    }

    /**
     * @param {Object} config
     */
    construct(config) {
        super.construct(config);

        let me = this;

        me.addDomListeners({
            intersect: me.onIntersect,
            scope    : me
        })
    }

    /**
     * Triggered after the mounted config got changed
     * @param {Boolean} value
     * @param {Boolean} oldValue
     * @protected
     */
    afterSetMounted(value, oldValue) {
        super.afterSetMounted(value, oldValue);
        value && this.registerIntersectionObserver()
    }

    /**
     * @param {Object} record
     */
    createItemContent(record) {
        let me = this;

        return [
            {cls: ['content', 'neo-relative'], data: {recordId: record.id}, removeDom: me.isHiddenItem(record), cn: [
                {cls: ['neo-multi-window'], data: {neoTooltip: 'Multi Window Demo'}, removeDom: !record.sharedWorkers, cn: [
                    {cls: ['far', 'fa-window-restore']}
                ]},
                {cls: ['neo-full-size', 'preview-image'], flag: `image-${record.id}`},
                {cls: ['neo-absolute', 'neo-item-bottom-position'], cn: [
                    {...me.createLink(record)},
                    {cls: ['neo-top-20'], cn: [
                        {...me.createSourceLink(record)},
                        {cls: ['neo-inner-content'], cn: [
                            {cls: ['neo-inner-details'], html: record.browsers.join(', ')},
                            {cls: ['neo-inner-details'], html: record.environments.join(', ')}
                        ]}
                    ]}
                ]}
            ]}
        ]
    }

    /**
     *
     * @param {Object} record
     * @returns {Object}
     */
    createLink(record) {
        let externalLink = record.url.startsWith('http'),

        vdom = {
            tag : 'a',
            cls : ['neo-title'],
            cn  : [{html: record.name.replace(List.nameRegEx, "$1")}],
            href: record.url
        };

        // We can use a shorter syntax for pointing examples to neomjs.com, but not all examples have to be there.
        if (!externalLink) {
            vdom.href = this.baseUrl + record.url
        }

        // Do not open multi-window examples inside a new browser window, in case the environment is the same.
        // E.g. opening the multi-window covid app & the portal app inside the same app worker is problematic.
        if (!record.sharedWorkers || this.environment !== Neo.config.environment || externalLink) {
            vdom.target = '_blank'
        }

        return vdom
    }

    /**
     *
     * @param {Object} record
     * @returns {Object}
     */
    createSourceLink(record) {
        let vdom = {
            tag   : 'a',
            cls   : ['fab fa-github', 'neo-github-image'],
            href  : record.sourceUrl,
            target: '_blank'
        };

        // We can use a shorter syntax for pointing examples to neomjs/neo repo, but not all examples have to be there.
        if (!record.sourceUrl.startsWith('http')) {
            vdom.href = this.sourceBaseUrl + record.sourceUrl
        }

        return vdom
    }

    /**
     * @returns {Object}
     */
    getVdomRoot() {
        return this.vdom.cn[0]
    }

    /**
     * @returns {Object}
     */
    getVnodeRoot() {
        return this.vnode.childNodes[0]
    }

    /**
     * @param {Object} record
     * @returns {Boolean}
     */
    isHiddenItem(record) {
        if (record.hidden) {
            return true
        }

        // We only want to show the portal app for the non-current environment.
        // => A link to itself feels pointless
        return record.sourceUrl === 'apps/portal' && this.environment === Neo.config.environment
    }

    /**
     * @param {Object} data
     */
    onIntersect(data) {
        let me                     = this,
            {imageBasePath, store} = me,
            record                 = store.get(parseInt(data.data.recordId)),
            i                      = store.indexOf(record),
            len                    = Math.min(i + me.preloadImages, store.getCount()),
            needsUpdate            = false,
            node;

        for (; i < len; i++) {
            node = _src_util_VDom_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].getByFlag(me.vdom, `image-${record.id}`);

            if (!node.style) {
                needsUpdate = true;

                node.style = {
                    backgroundImage: [
                        `url('${imageBasePath}/${record.image}'),`,
                        'linear-gradient(',
                            'var(--portal-examples-list-gradient-start),',
                            'var(--portal-examples-list-gradient-end)',
                        ')'
                    ].join('')
                }
            }
        }

        needsUpdate && me.update()
    }

    /**
     *
     */
    async registerIntersectionObserver() {
        let me   = this,
            opts = {id: me.id, observe: ['.content'], windowId: me.windowId},
            i    = 0,
            len  = me.intersectionObserverReconnects,
            data;

        await me.timeout(150);

        data = await Neo.main.addon.IntersectionObserver.register({
            ...opts,
            callback: 'isVisible',
            root    : `#${me.parentId}`
        });

        if (data.countTargets < 1) {
            for (; i < len; i++) {
                await me.timeout(100);

                data = await Neo.main.addon.IntersectionObserver.observe(opts);

                if (data.countTargets > 0) {
                    break
                }
            }
        }
    }
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Neo.setupClass(List));


/***/ }),

/***/ "./apps/portal/view/examples/TabContainer.mjs":
/*!****************************************************!*\
  !*** ./apps/portal/view/examples/TabContainer.mjs ***!
  \****************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _src_tab_Container_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../src/tab/Container.mjs */ "./src/tab/Container.mjs");
/* harmony import */ var _store_Examples_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../store/Examples.mjs */ "./apps/portal/store/Examples.mjs");
/* harmony import */ var _List_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./List.mjs */ "./apps/portal/view/examples/List.mjs");
/* harmony import */ var _TabContainerController_mjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./TabContainerController.mjs */ "./apps/portal/view/examples/TabContainerController.mjs");





/**
 * @class Portal.view.examples.TabContainer
 * @extends Neo.tab.Container
 */
class TabContainer extends _src_tab_Container_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        /**
         * @member {String} className='Portal.view.examples.TabContainer'
         * @protected
         */
        className: 'Portal.view.examples.TabContainer',
        /**
         * @member {Number|null} activeIndex=null
         */
        activeIndex: null,
        /**
         * @member {String[]} baseCls=['portal-examples-tab-container','neo-tab-container']
         */
        baseCls: ['portal-examples-tab-container', 'neo-tab-container'],
        /**
         * @member {Neo.controller.Component} controller=TabContainerController
         */
        controller: _TabContainerController_mjs__WEBPACK_IMPORTED_MODULE_3__["default"],
        /**
         * @member {Object} headerToolbarDefaults
         */
        headerToolbarDefaults: {
            cls: ['portal-examples-tab-header-toolbar']
        },
        /**
         * @member {Object} itemDefaults
         */
        itemDefaults: {
            module: _List_mjs__WEBPACK_IMPORTED_MODULE_2__["default"]
        },
        /**
         * @member {Object[]} items
         */
        items: [{
            reference      : 'examples-devmode-list',
            store          : {module: _store_Examples_mjs__WEBPACK_IMPORTED_MODULE_1__["default"], url: '../../apps/portal/resources/data/examples_devmode.json'},
            tabButtonConfig: {
                iconCls: 'fa fa-chess-knight',
                route  : '/examples/devmode',
                text   : 'DevMode'
            }
        }, {
            environment    : 'dist/development',
            reference      : 'examples-dist-dev-list',
            store          : {module: _store_Examples_mjs__WEBPACK_IMPORTED_MODULE_1__["default"], url: '../../apps/portal/resources/data/examples_dist_dev.json'},
            tabButtonConfig: {
                iconCls: 'fa fa-chess-queen',
                route  : '/examples/dist_dev',
                text   : 'dist/dev'
            }
        }, {
            environment    : 'dist/production',
            reference      : 'examples-dist-prod-list',
            store          : {module: _store_Examples_mjs__WEBPACK_IMPORTED_MODULE_1__["default"], url: '../../apps/portal/resources/data/examples_dist_prod.json'},
            tabButtonConfig: {
                iconCls: 'fa fa-chess-king',
                route  : '/examples/dist_prod',
                text   : 'dist/prod'
            }
        }],
        /**
         * @member {Boolean} sortable=true
         */
        sortable: true,
        /**
         * @member {String} tabBarPosition='left'
         */
        tabBarPosition: 'left',
    }
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Neo.setupClass(TabContainer));


/***/ }),

/***/ "./apps/portal/view/examples/TabContainerController.mjs":
/*!**************************************************************!*\
  !*** ./apps/portal/view/examples/TabContainerController.mjs ***!
  \**************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _src_controller_Component_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../src/controller/Component.mjs */ "./src/controller/Component.mjs");


/**
 * @class Portal.view.examples.TabContainerController
 * @extends Neo.controller.Component
 */
class TabContainerController extends _src_controller_Component_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        /**
         * @member {String} className='Portal.view.examples.TabContainerController'
         * @protected
         */
        className: 'Portal.view.examples.TabContainerController',
        /**
         * @member {Object} routes
         */
        routes: {
            '/examples'         : 'onExamplesRoute',
            '/examples/{itemId}': 'onExamplesRoute'
        }
    }

    /**
     * @param {Object} params
     * @param {Object} value
     * @param {Object} oldValue
     */
    onExamplesRoute(params, value, oldValue) {
        let me     = this,
            itemId = params?.itemId || 'dist_prod',
            store  = me.getReference(`examples-${itemId.replace('_', '-')}-list`).store;

        if (store?.getCount() < 1) {
            store.load()
        }

        me.component.activeIndex = itemId === 'dist_prod' ? 2 : itemId === 'dist_dev' ? 1 : 0
    }
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Neo.setupClass(TabContainerController));


/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2h1bmtzL2FwcC92ZW5kb3JzLWFwcHNfcG9ydGFsX3ZpZXdfZXhhbXBsZXNfVGFiQ29udGFpbmVyX21qcy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUFnRDs7QUFFaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsMkRBQUs7QUFDM0I7QUFDQTtBQUNBLG9CQUFvQixRQUFRO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLFVBQVU7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7O0FBRUEsaUVBQWUsdUJBQXVCLEVBQUM7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDdkRJO0FBQ087O0FBRWxEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLDJEQUFLO0FBQzVCO0FBQ0E7QUFDQSxvQkFBb0IsUUFBUTtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixRQUFRO0FBQzVCO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixnQkFBZ0I7QUFDcEM7QUFDQSxlQUFlLDBEQUFPO0FBQ3RCO0FBQ0E7O0FBRUEsaUVBQWUsd0JBQXdCLEVBQUM7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDekJhO0FBQ0E7O0FBRXJEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLDBEQUFRO0FBQzNCO0FBQ0E7QUFDQSxnQkFBZ0IsUUFBUTtBQUN4QjtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsR0FBRzs7QUFFL0I7QUFDQTtBQUNBLG9CQUFvQixRQUFRO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FB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LCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uZW8ubWpzLy4vYXBwcy9wb3J0YWwvbW9kZWwvRXhhbXBsZS5tanMiLCJ3ZWJwYWNrOi8vbmVvLm1qcy8uL2FwcHMvcG9ydGFsL3N0b3JlL0V4YW1wbGVzLm1qcyIsIndlYnBhY2s6Ly9uZW8ubWpzLy4vYXBwcy9wb3J0YWwvdmlldy9leGFtcGxlcy9MaXN0Lm1qcyIsIndlYnBhY2s6Ly9uZW8ubWpzLy4vYXBwcy9wb3J0YWwvdmlldy9leGFtcGxlcy9UYWJDb250YWluZXIubWpzIiwid2VicGFjazovL25lby5tanMvLi9hcHBzL3BvcnRhbC92aWV3L2V4YW1wbGVzL1RhYkNvbnRhaW5lckNvbnRyb2xsZXIubWpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBNb2RlbCBmcm9tICcuLi8uLi8uLi9zcmMvZGF0YS9Nb2RlbC5tanMnO1xuXG4vKipcbiAqIEBjbGFzcyBQb3J0YWwubW9kZWwuRXhhbXBsZVxuICogQGV4dGVuZHMgTmVvLmRhdGEuTW9kZWxcbiAqL1xuY2xhc3MgRXhhbXBsZSBleHRlbmRzIE1vZGVsIHtcbiAgICBzdGF0aWMgY29uZmlnID0ge1xuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfSBjbGFzc05hbWU9J1BvcnRhbC5tb2RlbC5FeGFtcGxlJ1xuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICBjbGFzc05hbWU6ICdQb3J0YWwubW9kZWwuRXhhbXBsZScsXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtPYmplY3RbXX0gZmllbGRzXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIGZpZWxkczogW3tcbiAgICAgICAgICAgIG5hbWU6ICdiYWNrZ3JvdW5kQ29sb3InLFxuICAgICAgICAgICAgdHlwZTogJ1N0cmluZydcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgbmFtZSAgICAgICAgOiAnYnJvd3NlcnMnLFxuICAgICAgICAgICAgdHlwZSAgICAgICAgOiAnQXJyYXknLFxuICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiBbJ0Nocm9tZScsICdFZGdlJywgJ0ZpcmVmb3gnLCAnU2FmYXJpJ11cbiAgICAgICAgfSwge1xuICAgICAgICAgICAgbmFtZSAgICAgICAgOiAnZW52aXJvbm1lbnRzJyxcbiAgICAgICAgICAgIHR5cGUgICAgICAgIDogJ0FycmF5JyxcbiAgICAgICAgICAgIGRlZmF1bHRWYWx1ZTogWydEZXNrdG9wJ11cbiAgICAgICAgfSwge1xuICAgICAgICAgICAgbmFtZSAgICAgICAgOiAnaGlkZGVuJyxcbiAgICAgICAgICAgIHR5cGUgICAgICAgIDogJ0Jvb2xlYW4nLFxuICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiBmYWxzZVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBuYW1lOiAnaWQnLFxuICAgICAgICAgICAgdHlwZTogJ0ludGVnZXInXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIG5hbWU6ICdpbWFnZScsXG4gICAgICAgICAgICB0eXBlOiAnU3RyaW5nJ1xuICAgICAgICB9LCB7XG4gICAgICAgICAgICBuYW1lOiAnbmFtZScsXG4gICAgICAgICAgICB0eXBlOiAnU3RyaW5nJ1xuICAgICAgICB9LCB7XG4gICAgICAgICAgICBuYW1lICAgICAgICA6ICdzaGFyZWRXb3JrZXJzJyxcbiAgICAgICAgICAgIHR5cGUgICAgICAgIDogJ0Jvb2xlYW4nLFxuICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiBmYWxzZVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBuYW1lOiAnc291cmNlVXJsJyxcbiAgICAgICAgICAgIHR5cGU6ICdTdHJpbmcnXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIG5hbWU6ICd1cmwnLFxuICAgICAgICAgICAgdHlwZTogJ1N0cmluZydcbiAgICAgICAgfV1cbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IE5lby5zZXR1cENsYXNzKEV4YW1wbGUpO1xuIiwiaW1wb3J0IEV4YW1wbGUgZnJvbSAnLi4vbW9kZWwvRXhhbXBsZS5tanMnO1xuaW1wb3J0IFN0b3JlICAgZnJvbSAnLi4vLi4vLi4vc3JjL2RhdGEvU3RvcmUubWpzJztcblxuLyoqXG4gKiBAY2xhc3MgUG9ydGFsLnN0b3JlLkV4YW1wbGVzXG4gKiBAZXh0ZW5kcyBOZW8uZGF0YS5TdG9yZVxuICovXG5jbGFzcyBFeGFtcGxlcyBleHRlbmRzIFN0b3JlIHtcbiAgICBzdGF0aWMgY29uZmlnID0ge1xuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfSBjbGFzc05hbWU9J1BvcnRhbC5zdG9yZS5FeGFtcGxlcydcbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKi9cbiAgICAgICAgY2xhc3NOYW1lOiAnUG9ydGFsLnN0b3JlLkV4YW1wbGVzJyxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge1N0cmluZ30ga2V5UHJvcGVydHk9J2lkJ1xuICAgICAgICAgKi9cbiAgICAgICAga2V5UHJvcGVydHk6ICdpZCcsXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtOZW8uZGF0YS5Nb2RlbH0gbW9kZWw9RXhhbXBsZVxuICAgICAgICAgKi9cbiAgICAgICAgbW9kZWw6IEV4YW1wbGVcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IE5lby5zZXR1cENsYXNzKEV4YW1wbGVzKTtcbiIsImltcG9ydCBCYXNlTGlzdCBmcm9tICcuLi8uLi8uLi8uLi9zcmMvbGlzdC9CYXNlLm1qcyc7XG5pbXBvcnQgVkRvbVV0aWwgZnJvbSAnLi4vLi4vLi4vLi4vc3JjL3V0aWwvVkRvbS5tanMnO1xuXG4vKipcbiAqIEBjbGFzcyBQb3J0YWwudmlldy5leGFtcGxlcy5MaXN0XG4gKiBAZXh0ZW5kcyBOZW8ubGlzdC5CYXNlXG4gKi9cbmNsYXNzIExpc3QgZXh0ZW5kcyBCYXNlTGlzdCB7XG4gICAgLyoqXG4gICAgICogQSByZWdleCB0byBlbmZvcmNlIGEgbWF4TGVuZ3RoICh3b3JkIGJyZWFrKVxuICAgICAqIEBtZW1iZXIge1JlZ0V4cH0gbmFtZVJlZ0V4XG4gICAgICogQHByb3RlY3RlZFxuICAgICAqIEBzdGF0aWNcbiAgICAgKi9cbiAgICBzdGF0aWMgbmFtZVJlZ0V4ID0gL14oLns2NX1bXlxcc10qKS4qL1xuXG4gICAgc3RhdGljIGNvbmZpZyA9IHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge1N0cmluZ30gY2xhc3NOYW1lPSdQb3J0YWwudmlldy5leGFtcGxlcy5MaXN0J1xuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICBjbGFzc05hbWU6ICdQb3J0YWwudmlldy5leGFtcGxlcy5MaXN0JyxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge1N0cmluZ1tdfSBiYXNlQ2xzPVsncG9ydGFsLWV4YW1wbGVzLWxpc3QnLCduZW8tbGlzdCddXG4gICAgICAgICAqL1xuICAgICAgICBiYXNlQ2xzOiBbJ3BvcnRhbC1leGFtcGxlcy1saXN0JywgJ25lby1saXN0J10sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtTdHJpbmd9IGJhc2VVcmw9J2h0dHBzOi8vbmVvbWpzLmNvbS8nXG4gICAgICAgICAqL1xuICAgICAgICBiYXNlVXJsOiAnaHR0cHM6Ly9uZW9tanMuY29tLycsXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgZW52IG9mIHRoZSBleGFtcGxlIGxpbmtzLlxuICAgICAgICAgKiBWYWxpZCB2YWx1ZXMgYXJlICdkZXZlbG9wbWVudCcsICdkaXN0L2RldmVsb3BtZW50JywgJ2Rpc3QvcHJvZHVjdGlvbidcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfSBlbnZpcm9ubWVudD0nZGV2ZWxvcG1lbnQnXG4gICAgICAgICAqL1xuICAgICAgICBlbnZpcm9ubWVudDogJ2RldmVsb3BtZW50JyxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNwZWNpZnkgaG93IG1hbnkgZXhhbXBsZSBpdGVtIGltYWdlcyB0byBwcmVsb2FkIHdoZW4gaW50ZXJzZWN0aW5nXG4gICAgICAgICAqIEBtZW1iZXIge051bWJlcn0gcHJlbG9hZEltYWdlcz01XG4gICAgICAgICAqL1xuICAgICAgICBwcmVsb2FkSW1hZ2VzOiA1LFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfSBzb3VyY2VCYXNlVXJsPSdodHRwczovL2dpdGh1Yi5jb20vbmVvbWpzL25lby90cmVlL2Rldi8nXG4gICAgICAgICAqL1xuICAgICAgICBzb3VyY2VCYXNlVXJsOiAnaHR0cHM6Ly9naXRodWIuY29tL25lb21qcy9uZW8vdHJlZS9kZXYvJyxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge0Jvb2xlYW59IHVzZVdyYXBwZXJOb2RlPXRydWVcbiAgICAgICAgICovXG4gICAgICAgIHVzZVdyYXBwZXJOb2RlOiB0cnVlLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7T2JqZWN0fSBfdmRvbVxuICAgICAgICAgKi9cbiAgICAgICAgX3Zkb206XG4gICAgICAgIHtjbjogW1xuICAgICAgICAgICAge3RhZzogJ3VsJywgY246IFtdfVxuICAgICAgICBdfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBtZW1iZXIge1N0cmluZ30gaW1hZ2VCYXNlUGF0aFxuICAgICAqL1xuICAgIGdldCBpbWFnZUJhc2VQYXRoKCkge1xuICAgICAgICBsZXQgYmFzZVBhdGg7XG5cbiAgICAgICAgaWYgKE5lby5jb25maWcuaXNHaXRIdWJQYWdlcykge1xuICAgICAgICAgICAgYmFzZVBhdGggPSAnLi4vLi4vLi4vLi4vcmVzb3VyY2VzX3B1Yi93ZWJzaXRlL2V4YW1wbGVzJztcblxuICAgICAgICAgICAgaWYgKE5lby5jb25maWcuZW52aXJvbm1lbnQgIT09ICdkZXZlbG9wbWVudCcpIHtcbiAgICAgICAgICAgICAgICBiYXNlUGF0aCA9ICcuLi8uLi8nICsgYmFzZVBhdGhcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGJhc2VQYXRoID0gJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9uZW9tanMvcGFnZXMvbWFpbi9yZXNvdXJjZXNfcHViL3dlYnNpdGUvZXhhbXBsZXMnXG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gYmFzZVBhdGhcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gY29uZmlnXG4gICAgICovXG4gICAgY29uc3RydWN0KGNvbmZpZykge1xuICAgICAgICBzdXBlci5jb25zdHJ1Y3QoY29uZmlnKTtcblxuICAgICAgICBsZXQgbWUgPSB0aGlzO1xuXG4gICAgICAgIG1lLmFkZERvbUxpc3RlbmVycyh7XG4gICAgICAgICAgICBpbnRlcnNlY3Q6IG1lLm9uSW50ZXJzZWN0LFxuICAgICAgICAgICAgc2NvcGUgICAgOiBtZVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRyaWdnZXJlZCBhZnRlciB0aGUgbW91bnRlZCBjb25maWcgZ290IGNoYW5nZWRcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IHZhbHVlXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBvbGRWYWx1ZVxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICBhZnRlclNldE1vdW50ZWQodmFsdWUsIG9sZFZhbHVlKSB7XG4gICAgICAgIHN1cGVyLmFmdGVyU2V0TW91bnRlZCh2YWx1ZSwgb2xkVmFsdWUpO1xuICAgICAgICB2YWx1ZSAmJiB0aGlzLnJlZ2lzdGVySW50ZXJzZWN0aW9uT2JzZXJ2ZXIoKVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSByZWNvcmRcbiAgICAgKi9cbiAgICBjcmVhdGVJdGVtQ29udGVudChyZWNvcmQpIHtcbiAgICAgICAgbGV0IG1lID0gdGhpcztcblxuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAge2NsczogWydjb250ZW50JywgJ25lby1yZWxhdGl2ZSddLCBkYXRhOiB7cmVjb3JkSWQ6IHJlY29yZC5pZH0sIHJlbW92ZURvbTogbWUuaXNIaWRkZW5JdGVtKHJlY29yZCksIGNuOiBbXG4gICAgICAgICAgICAgICAge2NsczogWyduZW8tbXVsdGktd2luZG93J10sIGRhdGE6IHtuZW9Ub29sdGlwOiAnTXVsdGkgV2luZG93IERlbW8nfSwgcmVtb3ZlRG9tOiAhcmVjb3JkLnNoYXJlZFdvcmtlcnMsIGNuOiBbXG4gICAgICAgICAgICAgICAgICAgIHtjbHM6IFsnZmFyJywgJ2ZhLXdpbmRvdy1yZXN0b3JlJ119XG4gICAgICAgICAgICAgICAgXX0sXG4gICAgICAgICAgICAgICAge2NsczogWyduZW8tZnVsbC1zaXplJywgJ3ByZXZpZXctaW1hZ2UnXSwgZmxhZzogYGltYWdlLSR7cmVjb3JkLmlkfWB9LFxuICAgICAgICAgICAgICAgIHtjbHM6IFsnbmVvLWFic29sdXRlJywgJ25lby1pdGVtLWJvdHRvbS1wb3NpdGlvbiddLCBjbjogW1xuICAgICAgICAgICAgICAgICAgICB7Li4ubWUuY3JlYXRlTGluayhyZWNvcmQpfSxcbiAgICAgICAgICAgICAgICAgICAge2NsczogWyduZW8tdG9wLTIwJ10sIGNuOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICB7Li4ubWUuY3JlYXRlU291cmNlTGluayhyZWNvcmQpfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHtjbHM6IFsnbmVvLWlubmVyLWNvbnRlbnQnXSwgY246IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7Y2xzOiBbJ25lby1pbm5lci1kZXRhaWxzJ10sIGh0bWw6IHJlY29yZC5icm93c2Vycy5qb2luKCcsICcpfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7Y2xzOiBbJ25lby1pbm5lci1kZXRhaWxzJ10sIGh0bWw6IHJlY29yZC5lbnZpcm9ubWVudHMuam9pbignLCAnKX1cbiAgICAgICAgICAgICAgICAgICAgICAgIF19XG4gICAgICAgICAgICAgICAgICAgIF19XG4gICAgICAgICAgICAgICAgXX1cbiAgICAgICAgICAgIF19XG4gICAgICAgIF1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSByZWNvcmRcbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fVxuICAgICAqL1xuICAgIGNyZWF0ZUxpbmsocmVjb3JkKSB7XG4gICAgICAgIGxldCBleHRlcm5hbExpbmsgPSByZWNvcmQudXJsLnN0YXJ0c1dpdGgoJ2h0dHAnKSxcblxuICAgICAgICB2ZG9tID0ge1xuICAgICAgICAgICAgdGFnIDogJ2EnLFxuICAgICAgICAgICAgY2xzIDogWyduZW8tdGl0bGUnXSxcbiAgICAgICAgICAgIGNuICA6IFt7aHRtbDogcmVjb3JkLm5hbWUucmVwbGFjZShMaXN0Lm5hbWVSZWdFeCwgXCIkMVwiKX1dLFxuICAgICAgICAgICAgaHJlZjogcmVjb3JkLnVybFxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIFdlIGNhbiB1c2UgYSBzaG9ydGVyIHN5bnRheCBmb3IgcG9pbnRpbmcgZXhhbXBsZXMgdG8gbmVvbWpzLmNvbSwgYnV0IG5vdCBhbGwgZXhhbXBsZXMgaGF2ZSB0byBiZSB0aGVyZS5cbiAgICAgICAgaWYgKCFleHRlcm5hbExpbmspIHtcbiAgICAgICAgICAgIHZkb20uaHJlZiA9IHRoaXMuYmFzZVVybCArIHJlY29yZC51cmxcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIERvIG5vdCBvcGVuIG11bHRpLXdpbmRvdyBleGFtcGxlcyBpbnNpZGUgYSBuZXcgYnJvd3NlciB3aW5kb3csIGluIGNhc2UgdGhlIGVudmlyb25tZW50IGlzIHRoZSBzYW1lLlxuICAgICAgICAvLyBFLmcuIG9wZW5pbmcgdGhlIG11bHRpLXdpbmRvdyBjb3ZpZCBhcHAgJiB0aGUgcG9ydGFsIGFwcCBpbnNpZGUgdGhlIHNhbWUgYXBwIHdvcmtlciBpcyBwcm9ibGVtYXRpYy5cbiAgICAgICAgaWYgKCFyZWNvcmQuc2hhcmVkV29ya2VycyB8fCB0aGlzLmVudmlyb25tZW50ICE9PSBOZW8uY29uZmlnLmVudmlyb25tZW50IHx8IGV4dGVybmFsTGluaykge1xuICAgICAgICAgICAgdmRvbS50YXJnZXQgPSAnX2JsYW5rJ1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHZkb21cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSByZWNvcmRcbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fVxuICAgICAqL1xuICAgIGNyZWF0ZVNvdXJjZUxpbmsocmVjb3JkKSB7XG4gICAgICAgIGxldCB2ZG9tID0ge1xuICAgICAgICAgICAgdGFnICAgOiAnYScsXG4gICAgICAgICAgICBjbHMgICA6IFsnZmFiIGZhLWdpdGh1YicsICduZW8tZ2l0aHViLWltYWdlJ10sXG4gICAgICAgICAgICBocmVmICA6IHJlY29yZC5zb3VyY2VVcmwsXG4gICAgICAgICAgICB0YXJnZXQ6ICdfYmxhbmsnXG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gV2UgY2FuIHVzZSBhIHNob3J0ZXIgc3ludGF4IGZvciBwb2ludGluZyBleGFtcGxlcyB0byBuZW9tanMvbmVvIHJlcG8sIGJ1dCBub3QgYWxsIGV4YW1wbGVzIGhhdmUgdG8gYmUgdGhlcmUuXG4gICAgICAgIGlmICghcmVjb3JkLnNvdXJjZVVybC5zdGFydHNXaXRoKCdodHRwJykpIHtcbiAgICAgICAgICAgIHZkb20uaHJlZiA9IHRoaXMuc291cmNlQmFzZVVybCArIHJlY29yZC5zb3VyY2VVcmxcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB2ZG9tXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHJldHVybnMge09iamVjdH1cbiAgICAgKi9cbiAgICBnZXRWZG9tUm9vdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudmRvbS5jblswXVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9XG4gICAgICovXG4gICAgZ2V0Vm5vZGVSb290KCkge1xuICAgICAgICByZXR1cm4gdGhpcy52bm9kZS5jaGlsZE5vZGVzWzBdXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IHJlY29yZFxuICAgICAqIEByZXR1cm5zIHtCb29sZWFufVxuICAgICAqL1xuICAgIGlzSGlkZGVuSXRlbShyZWNvcmQpIHtcbiAgICAgICAgaWYgKHJlY29yZC5oaWRkZW4pIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlXG4gICAgICAgIH1cblxuICAgICAgICAvLyBXZSBvbmx5IHdhbnQgdG8gc2hvdyB0aGUgcG9ydGFsIGFwcCBmb3IgdGhlIG5vbi1jdXJyZW50IGVudmlyb25tZW50LlxuICAgICAgICAvLyA9PiBBIGxpbmsgdG8gaXRzZWxmIGZlZWxzIHBvaW50bGVzc1xuICAgICAgICByZXR1cm4gcmVjb3JkLnNvdXJjZVVybCA9PT0gJ2FwcHMvcG9ydGFsJyAmJiB0aGlzLmVudmlyb25tZW50ID09PSBOZW8uY29uZmlnLmVudmlyb25tZW50XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGRhdGFcbiAgICAgKi9cbiAgICBvbkludGVyc2VjdChkYXRhKSB7XG4gICAgICAgIGxldCBtZSAgICAgICAgICAgICAgICAgICAgID0gdGhpcyxcbiAgICAgICAgICAgIHtpbWFnZUJhc2VQYXRoLCBzdG9yZX0gPSBtZSxcbiAgICAgICAgICAgIHJlY29yZCAgICAgICAgICAgICAgICAgPSBzdG9yZS5nZXQocGFyc2VJbnQoZGF0YS5kYXRhLnJlY29yZElkKSksXG4gICAgICAgICAgICBpICAgICAgICAgICAgICAgICAgICAgID0gc3RvcmUuaW5kZXhPZihyZWNvcmQpLFxuICAgICAgICAgICAgbGVuICAgICAgICAgICAgICAgICAgICA9IE1hdGgubWluKGkgKyBtZS5wcmVsb2FkSW1hZ2VzLCBzdG9yZS5nZXRDb3VudCgpKSxcbiAgICAgICAgICAgIG5lZWRzVXBkYXRlICAgICAgICAgICAgPSBmYWxzZSxcbiAgICAgICAgICAgIG5vZGU7XG5cbiAgICAgICAgZm9yICg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgbm9kZSA9IFZEb21VdGlsLmdldEJ5RmxhZyhtZS52ZG9tLCBgaW1hZ2UtJHtyZWNvcmQuaWR9YCk7XG5cbiAgICAgICAgICAgIGlmICghbm9kZS5zdHlsZSkge1xuICAgICAgICAgICAgICAgIG5lZWRzVXBkYXRlID0gdHJ1ZTtcblxuICAgICAgICAgICAgICAgIG5vZGUuc3R5bGUgPSB7XG4gICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmRJbWFnZTogW1xuICAgICAgICAgICAgICAgICAgICAgICAgYHVybCgnJHtpbWFnZUJhc2VQYXRofS8ke3JlY29yZC5pbWFnZX0nKSxgLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2xpbmVhci1ncmFkaWVudCgnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICd2YXIoLS1wb3J0YWwtZXhhbXBsZXMtbGlzdC1ncmFkaWVudC1zdGFydCksJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAndmFyKC0tcG9ydGFsLWV4YW1wbGVzLWxpc3QtZ3JhZGllbnQtZW5kKScsXG4gICAgICAgICAgICAgICAgICAgICAgICAnKSdcbiAgICAgICAgICAgICAgICAgICAgXS5qb2luKCcnKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIG5lZWRzVXBkYXRlICYmIG1lLnVwZGF0ZSgpXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICpcbiAgICAgKi9cbiAgICBhc3luYyByZWdpc3RlckludGVyc2VjdGlvbk9ic2VydmVyKCkge1xuICAgICAgICBsZXQgbWUgICA9IHRoaXMsXG4gICAgICAgICAgICBvcHRzID0ge2lkOiBtZS5pZCwgb2JzZXJ2ZTogWycuY29udGVudCddLCB3aW5kb3dJZDogbWUud2luZG93SWR9LFxuICAgICAgICAgICAgaSAgICA9IDAsXG4gICAgICAgICAgICBsZW4gID0gbWUuaW50ZXJzZWN0aW9uT2JzZXJ2ZXJSZWNvbm5lY3RzLFxuICAgICAgICAgICAgZGF0YTtcblxuICAgICAgICBhd2FpdCBtZS50aW1lb3V0KDE1MCk7XG5cbiAgICAgICAgZGF0YSA9IGF3YWl0IE5lby5tYWluLmFkZG9uLkludGVyc2VjdGlvbk9ic2VydmVyLnJlZ2lzdGVyKHtcbiAgICAgICAgICAgIC4uLm9wdHMsXG4gICAgICAgICAgICBjYWxsYmFjazogJ2lzVmlzaWJsZScsXG4gICAgICAgICAgICByb290ICAgIDogYCMke21lLnBhcmVudElkfWBcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKGRhdGEuY291bnRUYXJnZXRzIDwgMSkge1xuICAgICAgICAgICAgZm9yICg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgICAgIGF3YWl0IG1lLnRpbWVvdXQoMTAwKTtcblxuICAgICAgICAgICAgICAgIGRhdGEgPSBhd2FpdCBOZW8ubWFpbi5hZGRvbi5JbnRlcnNlY3Rpb25PYnNlcnZlci5vYnNlcnZlKG9wdHMpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGRhdGEuY291bnRUYXJnZXRzID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgTmVvLnNldHVwQ2xhc3MoTGlzdCk7XG4iLCJpbXBvcnQgQ29udGFpbmVyICAgICAgICAgICAgICBmcm9tICcuLi8uLi8uLi8uLi9zcmMvdGFiL0NvbnRhaW5lci5tanMnO1xuaW1wb3J0IEV4YW1wbGVTdG9yZSAgICAgICAgICAgZnJvbSAnLi4vLi4vc3RvcmUvRXhhbXBsZXMubWpzJztcbmltcG9ydCBMaXN0ICAgICAgICAgICAgICAgICAgIGZyb20gJy4vTGlzdC5tanMnO1xuaW1wb3J0IFRhYkNvbnRhaW5lckNvbnRyb2xsZXIgZnJvbSAnLi9UYWJDb250YWluZXJDb250cm9sbGVyLm1qcyc7XG5cbi8qKlxuICogQGNsYXNzIFBvcnRhbC52aWV3LmV4YW1wbGVzLlRhYkNvbnRhaW5lclxuICogQGV4dGVuZHMgTmVvLnRhYi5Db250YWluZXJcbiAqL1xuY2xhc3MgVGFiQ29udGFpbmVyIGV4dGVuZHMgQ29udGFpbmVyIHtcbiAgICBzdGF0aWMgY29uZmlnID0ge1xuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfSBjbGFzc05hbWU9J1BvcnRhbC52aWV3LmV4YW1wbGVzLlRhYkNvbnRhaW5lcidcbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKi9cbiAgICAgICAgY2xhc3NOYW1lOiAnUG9ydGFsLnZpZXcuZXhhbXBsZXMuVGFiQ29udGFpbmVyJyxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge051bWJlcnxudWxsfSBhY3RpdmVJbmRleD1udWxsXG4gICAgICAgICAqL1xuICAgICAgICBhY3RpdmVJbmRleDogbnVsbCxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge1N0cmluZ1tdfSBiYXNlQ2xzPVsncG9ydGFsLWV4YW1wbGVzLXRhYi1jb250YWluZXInLCduZW8tdGFiLWNvbnRhaW5lciddXG4gICAgICAgICAqL1xuICAgICAgICBiYXNlQ2xzOiBbJ3BvcnRhbC1leGFtcGxlcy10YWItY29udGFpbmVyJywgJ25lby10YWItY29udGFpbmVyJ10sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtOZW8uY29udHJvbGxlci5Db21wb25lbnR9IGNvbnRyb2xsZXI9VGFiQ29udGFpbmVyQ29udHJvbGxlclxuICAgICAgICAgKi9cbiAgICAgICAgY29udHJvbGxlcjogVGFiQ29udGFpbmVyQ29udHJvbGxlcixcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge09iamVjdH0gaGVhZGVyVG9vbGJhckRlZmF1bHRzXG4gICAgICAgICAqL1xuICAgICAgICBoZWFkZXJUb29sYmFyRGVmYXVsdHM6IHtcbiAgICAgICAgICAgIGNsczogWydwb3J0YWwtZXhhbXBsZXMtdGFiLWhlYWRlci10b29sYmFyJ11cbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge09iamVjdH0gaXRlbURlZmF1bHRzXG4gICAgICAgICAqL1xuICAgICAgICBpdGVtRGVmYXVsdHM6IHtcbiAgICAgICAgICAgIG1vZHVsZTogTGlzdFxuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7T2JqZWN0W119IGl0ZW1zXG4gICAgICAgICAqL1xuICAgICAgICBpdGVtczogW3tcbiAgICAgICAgICAgIHJlZmVyZW5jZSAgICAgIDogJ2V4YW1wbGVzLWRldm1vZGUtbGlzdCcsXG4gICAgICAgICAgICBzdG9yZSAgICAgICAgICA6IHttb2R1bGU6IEV4YW1wbGVTdG9yZSwgdXJsOiAnLi4vLi4vYXBwcy9wb3J0YWwvcmVzb3VyY2VzL2RhdGEvZXhhbXBsZXNfZGV2bW9kZS5qc29uJ30sXG4gICAgICAgICAgICB0YWJCdXR0b25Db25maWc6IHtcbiAgICAgICAgICAgICAgICBpY29uQ2xzOiAnZmEgZmEtY2hlc3Mta25pZ2h0JyxcbiAgICAgICAgICAgICAgICByb3V0ZSAgOiAnL2V4YW1wbGVzL2Rldm1vZGUnLFxuICAgICAgICAgICAgICAgIHRleHQgICA6ICdEZXZNb2RlJ1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBlbnZpcm9ubWVudCAgICA6ICdkaXN0L2RldmVsb3BtZW50JyxcbiAgICAgICAgICAgIHJlZmVyZW5jZSAgICAgIDogJ2V4YW1wbGVzLWRpc3QtZGV2LWxpc3QnLFxuICAgICAgICAgICAgc3RvcmUgICAgICAgICAgOiB7bW9kdWxlOiBFeGFtcGxlU3RvcmUsIHVybDogJy4uLy4uL2FwcHMvcG9ydGFsL3Jlc291cmNlcy9kYXRhL2V4YW1wbGVzX2Rpc3RfZGV2Lmpzb24nfSxcbiAgICAgICAgICAgIHRhYkJ1dHRvbkNvbmZpZzoge1xuICAgICAgICAgICAgICAgIGljb25DbHM6ICdmYSBmYS1jaGVzcy1xdWVlbicsXG4gICAgICAgICAgICAgICAgcm91dGUgIDogJy9leGFtcGxlcy9kaXN0X2RldicsXG4gICAgICAgICAgICAgICAgdGV4dCAgIDogJ2Rpc3QvZGV2J1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBlbnZpcm9ubWVudCAgICA6ICdkaXN0L3Byb2R1Y3Rpb24nLFxuICAgICAgICAgICAgcmVmZXJlbmNlICAgICAgOiAnZXhhbXBsZXMtZGlzdC1wcm9kLWxpc3QnLFxuICAgICAgICAgICAgc3RvcmUgICAgICAgICAgOiB7bW9kdWxlOiBFeGFtcGxlU3RvcmUsIHVybDogJy4uLy4uL2FwcHMvcG9ydGFsL3Jlc291cmNlcy9kYXRhL2V4YW1wbGVzX2Rpc3RfcHJvZC5qc29uJ30sXG4gICAgICAgICAgICB0YWJCdXR0b25Db25maWc6IHtcbiAgICAgICAgICAgICAgICBpY29uQ2xzOiAnZmEgZmEtY2hlc3Mta2luZycsXG4gICAgICAgICAgICAgICAgcm91dGUgIDogJy9leGFtcGxlcy9kaXN0X3Byb2QnLFxuICAgICAgICAgICAgICAgIHRleHQgICA6ICdkaXN0L3Byb2QnXG4gICAgICAgICAgICB9XG4gICAgICAgIH1dLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7Qm9vbGVhbn0gc29ydGFibGU9dHJ1ZVxuICAgICAgICAgKi9cbiAgICAgICAgc29ydGFibGU6IHRydWUsXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtTdHJpbmd9IHRhYkJhclBvc2l0aW9uPSdsZWZ0J1xuICAgICAgICAgKi9cbiAgICAgICAgdGFiQmFyUG9zaXRpb246ICdsZWZ0JyxcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IE5lby5zZXR1cENsYXNzKFRhYkNvbnRhaW5lcik7XG4iLCJpbXBvcnQgQ29tcG9uZW50IGZyb20gJy4uLy4uLy4uLy4uL3NyYy9jb250cm9sbGVyL0NvbXBvbmVudC5tanMnO1xuXG4vKipcbiAqIEBjbGFzcyBQb3J0YWwudmlldy5leGFtcGxlcy5UYWJDb250YWluZXJDb250cm9sbGVyXG4gKiBAZXh0ZW5kcyBOZW8uY29udHJvbGxlci5Db21wb25lbnRcbiAqL1xuY2xhc3MgVGFiQ29udGFpbmVyQ29udHJvbGxlciBleHRlbmRzIENvbXBvbmVudCB7XG4gICAgc3RhdGljIGNvbmZpZyA9IHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge1N0cmluZ30gY2xhc3NOYW1lPSdQb3J0YWwudmlldy5leGFtcGxlcy5UYWJDb250YWluZXJDb250cm9sbGVyJ1xuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICBjbGFzc05hbWU6ICdQb3J0YWwudmlldy5leGFtcGxlcy5UYWJDb250YWluZXJDb250cm9sbGVyJyxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge09iamVjdH0gcm91dGVzXG4gICAgICAgICAqL1xuICAgICAgICByb3V0ZXM6IHtcbiAgICAgICAgICAgICcvZXhhbXBsZXMnICAgICAgICAgOiAnb25FeGFtcGxlc1JvdXRlJyxcbiAgICAgICAgICAgICcvZXhhbXBsZXMve2l0ZW1JZH0nOiAnb25FeGFtcGxlc1JvdXRlJ1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IHBhcmFtc1xuICAgICAqIEBwYXJhbSB7T2JqZWN0fSB2YWx1ZVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvbGRWYWx1ZVxuICAgICAqL1xuICAgIG9uRXhhbXBsZXNSb3V0ZShwYXJhbXMsIHZhbHVlLCBvbGRWYWx1ZSkge1xuICAgICAgICBsZXQgbWUgICAgID0gdGhpcyxcbiAgICAgICAgICAgIGl0ZW1JZCA9IHBhcmFtcz8uaXRlbUlkIHx8ICdkaXN0X3Byb2QnLFxuICAgICAgICAgICAgc3RvcmUgID0gbWUuZ2V0UmVmZXJlbmNlKGBleGFtcGxlcy0ke2l0ZW1JZC5yZXBsYWNlKCdfJywgJy0nKX0tbGlzdGApLnN0b3JlO1xuXG4gICAgICAgIGlmIChzdG9yZT8uZ2V0Q291bnQoKSA8IDEpIHtcbiAgICAgICAgICAgIHN0b3JlLmxvYWQoKVxuICAgICAgICB9XG5cbiAgICAgICAgbWUuY29tcG9uZW50LmFjdGl2ZUluZGV4ID0gaXRlbUlkID09PSAnZGlzdF9wcm9kJyA/IDIgOiBpdGVtSWQgPT09ICdkaXN0X2RldicgPyAxIDogMFxuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgTmVvLnNldHVwQ2xhc3MoVGFiQ29udGFpbmVyQ29udHJvbGxlcik7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=