"use strict";
(self["webpackChunkneo_mjs"] = self["webpackChunkneo_mjs"] || []).push([["examples_component_multiWindowCoronaGallery_app_mjs"],{

/***/ "./examples/component/multiWindowCoronaGallery/Viewport.mjs":
/*!******************************************************************!*\
  !*** ./examples/component/multiWindowCoronaGallery/Viewport.mjs ***!
  \******************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _coronaGallery_Viewport_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../coronaGallery/Viewport.mjs */ "./examples/component/coronaGallery/Viewport.mjs");
/* harmony import */ var _ViewportController_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ViewportController.mjs */ "./examples/component/multiWindowCoronaGallery/ViewportController.mjs");



/**
 * @class Neo.examples.component.multiWindowCoronaGallery.Viewport
 * @extends Neo.examples.component.coronaGallery.Viewport
 */
class Viewport extends _coronaGallery_Viewport_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        /**
         * @member {String} className='Neo.examples.component.multiWindowCoronaGallery.Viewport'
         * @protected
         */
        className: 'Neo.examples.component.multiWindowCoronaGallery.Viewport',
        /**
         * @member {String[]} cls=['multi-window-helix-viewport']
         */
        cls: ['multi-window-helix-viewport'],
        /**
         * @member {Neo.controller.Component} controller=ViewportController
         */
        controller: _ViewportController_mjs__WEBPACK_IMPORTED_MODULE_1__["default"]
    }

    /**
     * @param {Object} config
     */
    construct(config) {
        super.construct(config);

        this.getItem('controls-panel').headers = [{
            dock     : 'top',
            reference: 'header-toolbar',

            items: [{
                ntype: 'label',
                cls  : ['neo-panel-header-text', 'neo-label'],
                text : 'Gallery Controls'
            }, '->', {
                handler: 'onMaximiseButtonClick',
                iconCls: 'far fa-window-maximize'
            }]
        }]
    }
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Neo.setupClass(Viewport));


/***/ }),

/***/ "./examples/component/multiWindowCoronaGallery/ViewportController.mjs":
/*!****************************************************************************!*\
  !*** ./examples/component/multiWindowCoronaGallery/ViewportController.mjs ***!
  \****************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _coronaGallery_ViewportController_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../coronaGallery/ViewportController.mjs */ "./examples/component/coronaGallery/ViewportController.mjs");


/**
 * @class Neo.examples.component.multiWindowCoronaGallery.ViewportController
 * @extends Neo.examples.component.coronaGallery.ViewportController
 */
class ViewportController extends _coronaGallery_ViewportController_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        /**
         * @member {String} className='Neo.examples.component.multiWindowCoronaGallery.ViewportController'
         * @protected
         */
        className: 'Neo.examples.component.multiWindowCoronaGallery.ViewportController'
    }

    /**
     * @member {String[]} connectedApps=[]
     */
    connectedApps = []

    /**
     *
     */
    async createPopupWindow() {
        let me                         = this,
            {windowId}                 = me,
            {config, windowConfigs}    = Neo,
            {environment}              = config,
            firstWindowId              = parseInt(Object.keys(windowConfigs)[0]),
            {basePath}                 = windowConfigs[firstWindowId],
            widget                     = me.getReference('controls-panel'),
            winData                    = await Neo.Main.getWindowData({windowId}),
            rect                       = await me.component.getDomRect(widget.id),
            {height, left, top, width} = rect;

        if (environment !== 'development') {
            basePath = `${basePath + environment}/`
        }

        height -= 62; // popup header in Chrome
        left   += (width + winData.screenLeft);
        top    += (winData.outerHeight - winData.innerHeight + winData.screenTop);

        /*
         * For this demo, the url './childapp/' would be sufficient.
         * However, we also want to open it from within apps/portal.
         *
         * We match the basePath to the firstWindowId,
         * assuming the first connected window is the (main) one which we want to be in charge.
         */
        await Neo.Main.windowOpen({
            url           : basePath + 'examples/component/multiWindowCoronaGallery/childapp/',
            windowFeatures: `height=${height},left=${left},top=${top},width=${width}`,
            windowId      : firstWindowId,
            windowName    : 'GalleryControls'
        })
    }

    /**
     * @param {Object} data
     * @param {String} data.appName
     * @param {Number} data.windowId
     */
    async onAppConnect(data) {
        let me        = this,
            {appName} = data;

        if (appName === 'GalleryControls') {
            let controlsPanel = me.getReference('controls-panel'),
                {mainView}    = Neo.apps[appName];

            me.connectedApps.push(appName);

            controlsPanel.parent.remove(controlsPanel, false);

            this.getReference('header-toolbar').hidden = true;

            mainView.add(controlsPanel)
        }
    }

    /**
     * @param {Object} data
     * @param {String} data.appName
     * @param {Number} data.windowId
     */
    async onAppDisconnect(data) {
        let me                  = this,
            {appName, windowId} = data;

        if (appName === 'GalleryControls') {
            let controlsPanel = me.getReference('controls-panel');

            controlsPanel.parent.remove(controlsPanel, false);

            me.getReference('header-toolbar').hidden = false;

            me.component.add(controlsPanel)
        }
        // Close popup windows when closing or reloading the main window
        else if (appName === 'Neo.examples.component.multiWindowCoronaGallery') {console.log('close', me.connectedApps);
            Neo.Main.windowClose({names: me.connectedApps, windowId})
        }
    }
    /**
     *
     */
    onConstructed() {
        super.onConstructed();

        let me = this;

        Neo.currentWorker.on({
            connect   : me.onAppConnect,
            disconnect: me.onAppDisconnect,
            scope     : me
        })
    }

    /**
     * @param {Object} data
     */
    async onMaximiseButtonClick(data) {
        await this.createPopupWindow()
    }
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Neo.setupClass(ViewportController));


/***/ }),

/***/ "./examples/component/multiWindowCoronaGallery/app.mjs":
/*!*************************************************************!*\
  !*** ./examples/component/multiWindowCoronaGallery/app.mjs ***!
  \*************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   onStart: () => (/* binding */ onStart)
/* harmony export */ });
/* harmony import */ var _Viewport_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Viewport.mjs */ "./examples/component/multiWindowCoronaGallery/Viewport.mjs");


const onStart = () => Neo.app({
    mainView: _Viewport_mjs__WEBPACK_IMPORTED_MODULE_0__["default"],
    name    : 'Neo.examples.component.multiWindowCoronaGallery'
});


/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2h1bmtzL2FwcC9leGFtcGxlc19jb21wb25lbnRfbXVsdGlXaW5kb3dDb3JvbmFHYWxsZXJ5X2FwcF9tanMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQStEO0FBQ0w7O0FBRTFEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLG1FQUFZO0FBQ25DO0FBQ0E7QUFDQSxvQkFBb0IsUUFBUTtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixVQUFVO0FBQzlCO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQiwwQkFBMEI7QUFDOUM7QUFDQSxvQkFBb0IsK0RBQWtCO0FBQ3RDOztBQUVBO0FBQ0EsZUFBZSxRQUFRO0FBQ3ZCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7QUFDQTs7QUFFQSxpRUFBZSx3QkFBd0IsRUFBQzs7Ozs7Ozs7Ozs7Ozs7OztBQzlDeUI7O0FBRWpFO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDLDZFQUFVO0FBQzNDO0FBQ0E7QUFDQSxvQkFBb0IsUUFBUTtBQUM1QjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGdCQUFnQixVQUFVO0FBQzFCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsMEJBQTBCO0FBQ3ZDLGFBQWEsMEJBQTBCO0FBQ3ZDLGFBQWEsMEJBQTBCO0FBQ3ZDO0FBQ0EsYUFBYSwwQkFBMEI7QUFDdkM7QUFDQSx1RUFBdUUsU0FBUztBQUNoRjtBQUNBLGFBQWEsMEJBQTBCOztBQUV2QztBQUNBLDBCQUEwQix1QkFBdUI7QUFDakQ7O0FBRUEsc0JBQXNCO0FBQ3RCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0NBQXNDLE9BQU8sUUFBUSxLQUFLLE9BQU8sSUFBSSxTQUFTLE1BQU07QUFDcEY7QUFDQTtBQUNBLFNBQVM7QUFDVDs7QUFFQTtBQUNBLGVBQWUsUUFBUTtBQUN2QixlQUFlLFFBQVE7QUFDdkIsZUFBZSxRQUFRO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBLGFBQWEsU0FBUzs7QUFFdEI7QUFDQTtBQUNBLGlCQUFpQixhQUFhOztBQUU5Qjs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxlQUFlLFFBQVE7QUFDdkIsZUFBZSxRQUFRO0FBQ3ZCLGVBQWUsUUFBUTtBQUN2QjtBQUNBO0FBQ0E7QUFDQSxhQUFhLG1CQUFtQjs7QUFFaEM7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxpRkFBaUY7QUFDakYsa0NBQWtDLGtDQUFrQztBQUNwRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDs7QUFFQTtBQUNBLGVBQWUsUUFBUTtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLGlFQUFlLGtDQUFrQyxFQUFDOzs7Ozs7Ozs7Ozs7Ozs7O0FDL0haOztBQUUvQjtBQUNQLGNBQWMscURBQVE7QUFDdEI7QUFDQSxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmVvLm1qcy8uL2V4YW1wbGVzL2NvbXBvbmVudC9tdWx0aVdpbmRvd0Nvcm9uYUdhbGxlcnkvVmlld3BvcnQubWpzIiwid2VicGFjazovL25lby5tanMvLi9leGFtcGxlcy9jb21wb25lbnQvbXVsdGlXaW5kb3dDb3JvbmFHYWxsZXJ5L1ZpZXdwb3J0Q29udHJvbGxlci5tanMiLCJ3ZWJwYWNrOi8vbmVvLm1qcy8uL2V4YW1wbGVzL2NvbXBvbmVudC9tdWx0aVdpbmRvd0Nvcm9uYUdhbGxlcnkvYXBwLm1qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQmFzZVZpZXdwb3J0ICAgICAgIGZyb20gJy4uL2Nvcm9uYUdhbGxlcnkvVmlld3BvcnQubWpzJztcbmltcG9ydCBWaWV3cG9ydENvbnRyb2xsZXIgZnJvbSAnLi9WaWV3cG9ydENvbnRyb2xsZXIubWpzJztcblxuLyoqXG4gKiBAY2xhc3MgTmVvLmV4YW1wbGVzLmNvbXBvbmVudC5tdWx0aVdpbmRvd0Nvcm9uYUdhbGxlcnkuVmlld3BvcnRcbiAqIEBleHRlbmRzIE5lby5leGFtcGxlcy5jb21wb25lbnQuY29yb25hR2FsbGVyeS5WaWV3cG9ydFxuICovXG5jbGFzcyBWaWV3cG9ydCBleHRlbmRzIEJhc2VWaWV3cG9ydCB7XG4gICAgc3RhdGljIGNvbmZpZyA9IHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge1N0cmluZ30gY2xhc3NOYW1lPSdOZW8uZXhhbXBsZXMuY29tcG9uZW50Lm11bHRpV2luZG93Q29yb25hR2FsbGVyeS5WaWV3cG9ydCdcbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKi9cbiAgICAgICAgY2xhc3NOYW1lOiAnTmVvLmV4YW1wbGVzLmNvbXBvbmVudC5tdWx0aVdpbmRvd0Nvcm9uYUdhbGxlcnkuVmlld3BvcnQnLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nW119IGNscz1bJ211bHRpLXdpbmRvdy1oZWxpeC12aWV3cG9ydCddXG4gICAgICAgICAqL1xuICAgICAgICBjbHM6IFsnbXVsdGktd2luZG93LWhlbGl4LXZpZXdwb3J0J10sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtOZW8uY29udHJvbGxlci5Db21wb25lbnR9IGNvbnRyb2xsZXI9Vmlld3BvcnRDb250cm9sbGVyXG4gICAgICAgICAqL1xuICAgICAgICBjb250cm9sbGVyOiBWaWV3cG9ydENvbnRyb2xsZXJcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gY29uZmlnXG4gICAgICovXG4gICAgY29uc3RydWN0KGNvbmZpZykge1xuICAgICAgICBzdXBlci5jb25zdHJ1Y3QoY29uZmlnKTtcblxuICAgICAgICB0aGlzLmdldEl0ZW0oJ2NvbnRyb2xzLXBhbmVsJykuaGVhZGVycyA9IFt7XG4gICAgICAgICAgICBkb2NrICAgICA6ICd0b3AnLFxuICAgICAgICAgICAgcmVmZXJlbmNlOiAnaGVhZGVyLXRvb2xiYXInLFxuXG4gICAgICAgICAgICBpdGVtczogW3tcbiAgICAgICAgICAgICAgICBudHlwZTogJ2xhYmVsJyxcbiAgICAgICAgICAgICAgICBjbHMgIDogWyduZW8tcGFuZWwtaGVhZGVyLXRleHQnLCAnbmVvLWxhYmVsJ10sXG4gICAgICAgICAgICAgICAgdGV4dCA6ICdHYWxsZXJ5IENvbnRyb2xzJ1xuICAgICAgICAgICAgfSwgJy0+Jywge1xuICAgICAgICAgICAgICAgIGhhbmRsZXI6ICdvbk1heGltaXNlQnV0dG9uQ2xpY2snLFxuICAgICAgICAgICAgICAgIGljb25DbHM6ICdmYXIgZmEtd2luZG93LW1heGltaXplJ1xuICAgICAgICAgICAgfV1cbiAgICAgICAgfV1cbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IE5lby5zZXR1cENsYXNzKFZpZXdwb3J0KTtcbiIsImltcG9ydCBDb250cm9sbGVyIGZyb20gJy4uL2Nvcm9uYUdhbGxlcnkvVmlld3BvcnRDb250cm9sbGVyLm1qcyc7XG5cbi8qKlxuICogQGNsYXNzIE5lby5leGFtcGxlcy5jb21wb25lbnQubXVsdGlXaW5kb3dDb3JvbmFHYWxsZXJ5LlZpZXdwb3J0Q29udHJvbGxlclxuICogQGV4dGVuZHMgTmVvLmV4YW1wbGVzLmNvbXBvbmVudC5jb3JvbmFHYWxsZXJ5LlZpZXdwb3J0Q29udHJvbGxlclxuICovXG5jbGFzcyBWaWV3cG9ydENvbnRyb2xsZXIgZXh0ZW5kcyBDb250cm9sbGVyIHtcbiAgICBzdGF0aWMgY29uZmlnID0ge1xuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfSBjbGFzc05hbWU9J05lby5leGFtcGxlcy5jb21wb25lbnQubXVsdGlXaW5kb3dDb3JvbmFHYWxsZXJ5LlZpZXdwb3J0Q29udHJvbGxlcidcbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKi9cbiAgICAgICAgY2xhc3NOYW1lOiAnTmVvLmV4YW1wbGVzLmNvbXBvbmVudC5tdWx0aVdpbmRvd0Nvcm9uYUdhbGxlcnkuVmlld3BvcnRDb250cm9sbGVyJ1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBtZW1iZXIge1N0cmluZ1tdfSBjb25uZWN0ZWRBcHBzPVtdXG4gICAgICovXG4gICAgY29ubmVjdGVkQXBwcyA9IFtdXG5cbiAgICAvKipcbiAgICAgKlxuICAgICAqL1xuICAgIGFzeW5jIGNyZWF0ZVBvcHVwV2luZG93KCkge1xuICAgICAgICBsZXQgbWUgICAgICAgICAgICAgICAgICAgICAgICAgPSB0aGlzLFxuICAgICAgICAgICAge3dpbmRvd0lkfSAgICAgICAgICAgICAgICAgPSBtZSxcbiAgICAgICAgICAgIHtjb25maWcsIHdpbmRvd0NvbmZpZ3N9ICAgID0gTmVvLFxuICAgICAgICAgICAge2Vudmlyb25tZW50fSAgICAgICAgICAgICAgPSBjb25maWcsXG4gICAgICAgICAgICBmaXJzdFdpbmRvd0lkICAgICAgICAgICAgICA9IHBhcnNlSW50KE9iamVjdC5rZXlzKHdpbmRvd0NvbmZpZ3MpWzBdKSxcbiAgICAgICAgICAgIHtiYXNlUGF0aH0gICAgICAgICAgICAgICAgID0gd2luZG93Q29uZmlnc1tmaXJzdFdpbmRvd0lkXSxcbiAgICAgICAgICAgIHdpZGdldCAgICAgICAgICAgICAgICAgICAgID0gbWUuZ2V0UmVmZXJlbmNlKCdjb250cm9scy1wYW5lbCcpLFxuICAgICAgICAgICAgd2luRGF0YSAgICAgICAgICAgICAgICAgICAgPSBhd2FpdCBOZW8uTWFpbi5nZXRXaW5kb3dEYXRhKHt3aW5kb3dJZH0pLFxuICAgICAgICAgICAgcmVjdCAgICAgICAgICAgICAgICAgICAgICAgPSBhd2FpdCBtZS5jb21wb25lbnQuZ2V0RG9tUmVjdCh3aWRnZXQuaWQpLFxuICAgICAgICAgICAge2hlaWdodCwgbGVmdCwgdG9wLCB3aWR0aH0gPSByZWN0O1xuXG4gICAgICAgIGlmIChlbnZpcm9ubWVudCAhPT0gJ2RldmVsb3BtZW50Jykge1xuICAgICAgICAgICAgYmFzZVBhdGggPSBgJHtiYXNlUGF0aCArIGVudmlyb25tZW50fS9gXG4gICAgICAgIH1cblxuICAgICAgICBoZWlnaHQgLT0gNjI7IC8vIHBvcHVwIGhlYWRlciBpbiBDaHJvbWVcbiAgICAgICAgbGVmdCAgICs9ICh3aWR0aCArIHdpbkRhdGEuc2NyZWVuTGVmdCk7XG4gICAgICAgIHRvcCAgICArPSAod2luRGF0YS5vdXRlckhlaWdodCAtIHdpbkRhdGEuaW5uZXJIZWlnaHQgKyB3aW5EYXRhLnNjcmVlblRvcCk7XG5cbiAgICAgICAgLypcbiAgICAgICAgICogRm9yIHRoaXMgZGVtbywgdGhlIHVybCAnLi9jaGlsZGFwcC8nIHdvdWxkIGJlIHN1ZmZpY2llbnQuXG4gICAgICAgICAqIEhvd2V2ZXIsIHdlIGFsc28gd2FudCB0byBvcGVuIGl0IGZyb20gd2l0aGluIGFwcHMvcG9ydGFsLlxuICAgICAgICAgKlxuICAgICAgICAgKiBXZSBtYXRjaCB0aGUgYmFzZVBhdGggdG8gdGhlIGZpcnN0V2luZG93SWQsXG4gICAgICAgICAqIGFzc3VtaW5nIHRoZSBmaXJzdCBjb25uZWN0ZWQgd2luZG93IGlzIHRoZSAobWFpbikgb25lIHdoaWNoIHdlIHdhbnQgdG8gYmUgaW4gY2hhcmdlLlxuICAgICAgICAgKi9cbiAgICAgICAgYXdhaXQgTmVvLk1haW4ud2luZG93T3Blbih7XG4gICAgICAgICAgICB1cmwgICAgICAgICAgIDogYmFzZVBhdGggKyAnZXhhbXBsZXMvY29tcG9uZW50L211bHRpV2luZG93Q29yb25hR2FsbGVyeS9jaGlsZGFwcC8nLFxuICAgICAgICAgICAgd2luZG93RmVhdHVyZXM6IGBoZWlnaHQ9JHtoZWlnaHR9LGxlZnQ9JHtsZWZ0fSx0b3A9JHt0b3B9LHdpZHRoPSR7d2lkdGh9YCxcbiAgICAgICAgICAgIHdpbmRvd0lkICAgICAgOiBmaXJzdFdpbmRvd0lkLFxuICAgICAgICAgICAgd2luZG93TmFtZSAgICA6ICdHYWxsZXJ5Q29udHJvbHMnXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGRhdGFcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gZGF0YS5hcHBOYW1lXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IGRhdGEud2luZG93SWRcbiAgICAgKi9cbiAgICBhc3luYyBvbkFwcENvbm5lY3QoZGF0YSkge1xuICAgICAgICBsZXQgbWUgICAgICAgID0gdGhpcyxcbiAgICAgICAgICAgIHthcHBOYW1lfSA9IGRhdGE7XG5cbiAgICAgICAgaWYgKGFwcE5hbWUgPT09ICdHYWxsZXJ5Q29udHJvbHMnKSB7XG4gICAgICAgICAgICBsZXQgY29udHJvbHNQYW5lbCA9IG1lLmdldFJlZmVyZW5jZSgnY29udHJvbHMtcGFuZWwnKSxcbiAgICAgICAgICAgICAgICB7bWFpblZpZXd9ICAgID0gTmVvLmFwcHNbYXBwTmFtZV07XG5cbiAgICAgICAgICAgIG1lLmNvbm5lY3RlZEFwcHMucHVzaChhcHBOYW1lKTtcblxuICAgICAgICAgICAgY29udHJvbHNQYW5lbC5wYXJlbnQucmVtb3ZlKGNvbnRyb2xzUGFuZWwsIGZhbHNlKTtcblxuICAgICAgICAgICAgdGhpcy5nZXRSZWZlcmVuY2UoJ2hlYWRlci10b29sYmFyJykuaGlkZGVuID0gdHJ1ZTtcblxuICAgICAgICAgICAgbWFpblZpZXcuYWRkKGNvbnRyb2xzUGFuZWwpXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBkYXRhLmFwcE5hbWVcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gZGF0YS53aW5kb3dJZFxuICAgICAqL1xuICAgIGFzeW5jIG9uQXBwRGlzY29ubmVjdChkYXRhKSB7XG4gICAgICAgIGxldCBtZSAgICAgICAgICAgICAgICAgID0gdGhpcyxcbiAgICAgICAgICAgIHthcHBOYW1lLCB3aW5kb3dJZH0gPSBkYXRhO1xuXG4gICAgICAgIGlmIChhcHBOYW1lID09PSAnR2FsbGVyeUNvbnRyb2xzJykge1xuICAgICAgICAgICAgbGV0IGNvbnRyb2xzUGFuZWwgPSBtZS5nZXRSZWZlcmVuY2UoJ2NvbnRyb2xzLXBhbmVsJyk7XG5cbiAgICAgICAgICAgIGNvbnRyb2xzUGFuZWwucGFyZW50LnJlbW92ZShjb250cm9sc1BhbmVsLCBmYWxzZSk7XG5cbiAgICAgICAgICAgIG1lLmdldFJlZmVyZW5jZSgnaGVhZGVyLXRvb2xiYXInKS5oaWRkZW4gPSBmYWxzZTtcblxuICAgICAgICAgICAgbWUuY29tcG9uZW50LmFkZChjb250cm9sc1BhbmVsKVxuICAgICAgICB9XG4gICAgICAgIC8vIENsb3NlIHBvcHVwIHdpbmRvd3Mgd2hlbiBjbG9zaW5nIG9yIHJlbG9hZGluZyB0aGUgbWFpbiB3aW5kb3dcbiAgICAgICAgZWxzZSBpZiAoYXBwTmFtZSA9PT0gJ05lby5leGFtcGxlcy5jb21wb25lbnQubXVsdGlXaW5kb3dDb3JvbmFHYWxsZXJ5Jykge2NvbnNvbGUubG9nKCdjbG9zZScsIG1lLmNvbm5lY3RlZEFwcHMpO1xuICAgICAgICAgICAgTmVvLk1haW4ud2luZG93Q2xvc2Uoe25hbWVzOiBtZS5jb25uZWN0ZWRBcHBzLCB3aW5kb3dJZH0pXG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICpcbiAgICAgKi9cbiAgICBvbkNvbnN0cnVjdGVkKCkge1xuICAgICAgICBzdXBlci5vbkNvbnN0cnVjdGVkKCk7XG5cbiAgICAgICAgbGV0IG1lID0gdGhpcztcblxuICAgICAgICBOZW8uY3VycmVudFdvcmtlci5vbih7XG4gICAgICAgICAgICBjb25uZWN0ICAgOiBtZS5vbkFwcENvbm5lY3QsXG4gICAgICAgICAgICBkaXNjb25uZWN0OiBtZS5vbkFwcERpc2Nvbm5lY3QsXG4gICAgICAgICAgICBzY29wZSAgICAgOiBtZVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBkYXRhXG4gICAgICovXG4gICAgYXN5bmMgb25NYXhpbWlzZUJ1dHRvbkNsaWNrKGRhdGEpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5jcmVhdGVQb3B1cFdpbmRvdygpXG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBOZW8uc2V0dXBDbGFzcyhWaWV3cG9ydENvbnRyb2xsZXIpO1xuIiwiaW1wb3J0IFZpZXdwb3J0IGZyb20gJy4vVmlld3BvcnQubWpzJztcblxuZXhwb3J0IGNvbnN0IG9uU3RhcnQgPSAoKSA9PiBOZW8uYXBwKHtcbiAgICBtYWluVmlldzogVmlld3BvcnQsXG4gICAgbmFtZSAgICA6ICdOZW8uZXhhbXBsZXMuY29tcG9uZW50Lm11bHRpV2luZG93Q29yb25hR2FsbGVyeSdcbn0pO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9