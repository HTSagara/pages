"use strict";
(self["webpackChunkneo_mjs"] = self["webpackChunkneo_mjs"] || []).push([["vendors-examples_fieldWithPrefix_app_mjs"],{

/***/ "./examples/fieldWithPrefix/MainContainer.mjs":
/*!****************************************************!*\
  !*** ./examples/fieldWithPrefix/MainContainer.mjs ***!
  \****************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _src_form_field_ComboBox_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../src/form/field/ComboBox.mjs */ "./src/form/field/ComboBox.mjs");
/* harmony import */ var _ConfigurationViewport_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ConfigurationViewport.mjs */ "./examples/ConfigurationViewport.mjs");
/* harmony import */ var _src_plugin_PrefixField_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../src/plugin/PrefixField.mjs */ "./src/plugin/PrefixField.mjs");
/* harmony import */ var _src_form_field_Text_mjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../src/form/field/Text.mjs */ "./src/form/field/Text.mjs");





/**
 * @class Neo.examples.fieldWithPrefix.MainContainer
 * @extends Neo.examples.ConfigurationViewport
 */
class MainContainer extends _ConfigurationViewport_mjs__WEBPACK_IMPORTED_MODULE_1__["default"] {
    static config = {
        className           : 'Neo.examples.fieldWithPrefix.MainContainer',
        autoMount           : true,
        configItemLabelWidth: 100,
        configItemWidth     : 230,
        layout              : {ntype: 'hbox', align: 'stretch'},
        cls                 : ['examples-container-accordion']
    }

    onPluginConfigChange(config, opts) {
        const textfield = this.exampleComponent.items[0],
              plugin    = textfield.getPlugin({flag: 'prefix'});

        if (config === 'accept') {
            plugin.accept = opts.record.value;
        } else {
            plugin[config] = opts.value;
            textfield.value = '';
        }
    }

    createConfigurationComponents() {
        let me        = this,
            textfield = me.exampleComponent.items[0],
            plugin    = textfield.plugins[0];

        return [{
            module   : _src_form_field_Text_mjs__WEBPACK_IMPORTED_MODULE_3__["default"],
            clearable: true,
            labelText: 'pattern',
            listeners: {change: me.onPluginConfigChange.bind(me, 'pattern')},
            value    : plugin.pattern,
            style    : {marginTop: '10px'}
        }, {
            module   : _src_form_field_Text_mjs__WEBPACK_IMPORTED_MODULE_3__["default"],
            clearable: true,
            labelText: 'slots',
            listeners: {change: me.onPluginConfigChange.bind(me, 'slots')},
            value    : '_',
            style    : {marginTop: '10px'}
        }, {
            module: _src_form_field_ComboBox_mjs__WEBPACK_IMPORTED_MODULE_0__["default"],
            store : {
                model: {fields: [{name: 'id'}, {name: 'name'}, {name: 'value'}]},
                data : [
                    {id: '0', name: 'empty=/\\d/', value: null},
                    {id: '1', name: '[0-9]', value: '[0-9]'},
                    {id: '2', name: '[A-H]', value: '[A-H]'},
                    {id: '3', name: '/\\w/', value: /\w/},
                    {id: '4', name: '/\\d/', value: /\d/},
                    {id: '5', name: '[0-9a-f]', value: '[0-9a-f]'}
                ]
            },

            value       : '4',
            displayField: 'name',
            valueField  : 'value',

            clearable: true,
            labelText: 'accept',
            listeners: {change: me.onPluginConfigChange.bind(me, 'accept')},
            style    : {marginTop: '10px'}
        }];
    }

    /**
     * @returns {*}
     */
    createExampleComponent() {
        return Neo.ntype({
            ntype : 'container',
            width : 350,
            cls   : ['example-fieldWithPrefix'],
            layout: {ntype: 'vbox', align: 'stretch'},
            items : [{
                module   : _src_form_field_Text_mjs__WEBPACK_IMPORTED_MODULE_3__["default"],
                labelText: 'Phone Number',
                plugins  : [
                    {
                        module : _src_plugin_PrefixField_mjs__WEBPACK_IMPORTED_MODULE_2__["default"],
                        flag   : 'prefix',
                        pattern: '+1 (___) ___-___-____',
                        slots  : '_'
                    }
                ]
            }, {
                module   : _src_form_field_Text_mjs__WEBPACK_IMPORTED_MODULE_3__["default"],
                labelText: '[0-9] Date',
                plugins  : [
                    {
                        module : _src_plugin_PrefixField_mjs__WEBPACK_IMPORTED_MODULE_2__["default"],
                        flag   : 'prefix',
                        pattern: 'dd/mm/yyyy hh:mm',
                        slots  : 'dmyh'
                    }
                ]
            }, {
                module   : _src_form_field_Text_mjs__WEBPACK_IMPORTED_MODULE_3__["default"],
                labelText: '[A-H] MAC Adress',
                plugins  : [
                    {
                        module : _src_plugin_PrefixField_mjs__WEBPACK_IMPORTED_MODULE_2__["default"],
                        flag   : 'prefix',
                        pattern: 'XX:XX:XX:XX:XX:XX',
                        slots  : 'X',
                        accept : '[A-H]'
                    }
                ]
            }, {
                module   : _src_form_field_Text_mjs__WEBPACK_IMPORTED_MODULE_3__["default"],
                labelText: '/\\w/ Alphanumeric',
                plugins  : [
                    {
                        module : _src_plugin_PrefixField_mjs__WEBPACK_IMPORTED_MODULE_2__["default"],
                        flag   : 'prefix',
                        pattern: '__-__-__-____',
                        slots  : '_',
                        accept : /\w/
                    }
                ]
            }, {
                module   : _src_form_field_Text_mjs__WEBPACK_IMPORTED_MODULE_3__["default"],
                labelText: '/\\d/ Credit Card',
                plugins  : [
                    {
                        module : _src_plugin_PrefixField_mjs__WEBPACK_IMPORTED_MODULE_2__["default"],
                        flag   : 'prefix',
                        pattern: '.... .... .... ....',
                        slots  : '.',
                        accept : /\d/
                    }
                ]
            }]
        })
    }
}

Neo.setupClass(MainContainer);

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (MainContainer);


/***/ }),

/***/ "./examples/fieldWithPrefix/app.mjs":
/*!******************************************!*\
  !*** ./examples/fieldWithPrefix/app.mjs ***!
  \******************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   onStart: () => (/* binding */ onStart)
/* harmony export */ });
/* harmony import */ var _MainContainer_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./MainContainer.mjs */ "./examples/fieldWithPrefix/MainContainer.mjs");


const onStart = () => Neo.app({
    mainView: _MainContainer_mjs__WEBPACK_IMPORTED_MODULE_0__["default"],
    name    : 'Neo.examples.fieldWithPrefix'
});


/***/ }),

/***/ "./src/plugin/Base.mjs":
/*!*****************************!*\
  !*** ./src/plugin/Base.mjs ***!
  \*****************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _core_Base_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../core/Base.mjs */ "./src/core/Base.mjs");


/**
 * Plugins are intended to get put into the plugins config of component.Base
 * to enhance them or add additional features
 * @class Neo.plugin.Base
 * @extends Neo.core.Base
 */
class Base extends _core_Base_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        /**
         * @member {String} className='Neo.plugin.Base'
         * @protected
         */
        className: 'Neo.plugin.Base',
        /**
         * @member {String} ntype='plugin'
         * @protected
         */
        ntype: 'plugin',
        /**
         * @member {Neo.component.Base} owner=null
         * @protected
         */
        owner: null
    }

    /**
     * @param {Object} config
     */
    construct(config) {
        super.construct(config);

        let me = this;

        if (me.owner.mounted) {
            me.onOwnerMounted();
        } else {
            me.owner.on('mounted', me.onOwnerMounted, me);
        }
    }

    /**
     * Override this method to apply changes to the owner Component when it does get mounted
     */
    onOwnerMounted() {

    }
}

Neo.setupClass(Base);

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Base);


/***/ }),

/***/ "./src/plugin/PrefixField.mjs":
/*!************************************!*\
  !*** ./src/plugin/PrefixField.mjs ***!
  \************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _Base_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Base.mjs */ "./src/plugin/Base.mjs");


/**
 * @class Neo.plugin.PrefixField
 * @extends Neo.plugin.Base
 *
 * @example
 *
 *     {
 *         module   : TextField,
 *         labelText: 'Credit Card',
 *         plugins  : [{
 *             module : PrefixPlugin, // import PrefixPlugin from '../../src/plugin/PrefixField.mjs';
 *             flag   : 'prefix',     // textField.getPlugins({flag: 'prefix'})
 *             pattern: 'dd/mm/yyyy',
 *             slots  : 'dmy',        // characters allowed to replace
 *             accept : /\d/          // either '[A-Z]' or regex or undefined
 *         }]
 *     }
 */
class PrefixField extends _Base_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        /**
         * @member {String} className='Neo.plugin.PrefixField'
         * @protected
         */
        className: 'Neo.plugin.PrefixField',
        /**
         * @member {String} ntype='plugin-prefixfield'
         * @protected
         */
        ntype: 'plugin-prefixfield',

        /**
         * Custom cls added to the inputEl
         * @member {String} inputCls='neo-prefixfield-input'
         */
        inputCls: 'neo-prefixfield-input',
        /**
         * Custom cls added to the inputEl
         * @member {String} inputCls='neo-prefixfield-input'
         */
        labelCls: 'neo-prefixfield-label',
        /**
         * Custom cls to add to the owner component
         * @member {String} ownerCls='neo-prefixfield'
         */
        ownerCls: 'neo-prefixfield',

        /**
         * regex to calculate if entered value is acceptable
         * Preset to numbers only
         *
         * @member {regex|null} accept
         */
        accept_: null,
        /**
         * @member {String} pattern=null
         */
        pattern_: null,
        /**
         * Only add a String. A Set will be automatically created
         * @member {String|Set|null} slots=null
         */
        slots_: null
    }

    /**
     * First accepted place to enter a value
     * @member {Number} first
     * @protected
     */
    first = null;
    /**
     * Array of numbers, which shows the previous entry point
     * @member {Array[]} prev
     * @protected
     */
    prev = null;
    /**
     * Position of the cursor inside input element
     * @member {Object} selection
     * @protected
     */
    selection = null;

    /**
     * State if selection should be updated
     * @member {Boolean} ignoreSelection
     * @protected
     */
    ignoreSelection = false;
    /**
     * State if last entry was the back button
     * @member {Boolean} back
     * @protected
     */
    back = false;

    /**
     * @param {Object} config
     */
    construct(config) {
        let me = this;

        super.construct(config);

        me.addListeners();
        me.addCss();
    }

    /**
     * Add a custom cls to the owner component
     */
    addCss() {
        const me      = this,
              owner   = me.owner,
              inputEl = owner.getInputEl(),
              labelEl = owner.getLabelEl();

        owner    .addCls(me.ownerCls);
        inputEl.cls.push(me.inputCls);
        labelEl.cls.push(me.labelCls);
    }

    /**
     * Add listeners
     * @protected
     */
    addListeners() {
        let me    = this,
            owner = me.owner,
            listenerId;

        owner.addDomListeners([
            {keydown        : me.onFieldKeyDown        , scope: me},
            {focusin        : me.onFieldFocus          , scope: me},
            {focusout       : me.onFieldBlur           , scope: me},
            {selectionchange: me.onFieldSelectionChange, scope: me}
        ]);

        listenerId = me.owner.on('mounted', () => {
            Neo.currentWorker.insertThemeFiles(owner.appName, owner.windowId, me.__proto__);

            owner.un('mounted', listenerId);
            listenerId = null;
        })
    }


    /**
     * After setting accept format output
     * @param {String} value
     * @param {String} oldValue
     * @protected
     */
    afterSetAccept(value, oldValue) {
        if (this.owner.value) this.format();
    }

    /**
     * After setting pattern recalc other values and set placeholder
     * @param {Set} value
     * @param {Set} oldValue
     * @protected
     */
    afterSetPattern(value, oldValue) {
        this.owner.placeholderText = value;
        this.recalcFirstAndPref();
    }

    /**
     * After setting slots recalc other values
     * @param {Set} value
     * @param {Set} oldValue
     * @protected
     */
    afterSetSlots(value, oldValue) {
        this.recalcFirstAndPref();
    }

    /**
     * Before the new value for slots will be set we create a Set from the string
     * @param {String} value
     * @return {Set}
     * @protected
     */
    beforeSetSlots(value) {
        return new Set(value || "_");
    }

    /**
     * Remove unwanted entries and limit length
     * @param {String} input
     * @returns {any[]}
     * @protected
     */
    clean(input) {
        const me     = this,
              accept = new RegExp(this.accept || "\\d", "g");

        input = input.match(accept) || [];
        input = Array.from(me.pattern, c =>
            input[0] === c || me.slots.has(c) ? input.shift() || c : c
        );

        return input.slice(0, me.pattern.length);
    }

    /**
     * Calculate position and output correct String to Field
     * @protected
     */
    format() {
        const me        = this,
              el        = me.owner,
              selection = me.selection,
              prev      = me.prev,
              clean     = me.clean.bind(me);
        let value = el.value || '';

        const [i, j] = [selection.start, selection.end].map(i => {
            i = me.clean(value.slice(0, i)).findIndex(c => me.slots.has(c));
            return i < 0 ? prev[prev.length - 1] : me.back ? prev[i - 1] || me.first : i;
        });

        el.value = clean(value).join``;
        this.ignoreSelection = true;

        Neo.main.DomAccess.selectNode({id: el.getInputElId(), start: i, end: j});
        this.ignoreSelection = false;

        this.back = false;
    }

    /**
     * Event
     * @param {Object} data
     * @returns {false|string}
     * @protected
     */
    onFieldBlur(data) {
        const pattern = this.pattern,
              el      = this.owner;

        return el.value === pattern && (el.value = "");
    }

    /**
     * Event
     * @param {Object} data
     * @protected
     */
    onFieldFocus(data) {
        this.format();
    }

    /**
     * Event
     * @param {Object} data
     * @protected
     */
    onFieldKeyDown(data) {
        this.back = (data.key === "Backspace");
    }

    /**
     * Event
     * @param {Object} data
     * @protected
     */
    onFieldSelectionChange(data) {
        let sel  = this.selection,
            dSel = data.selection;

        // Do not run, if ignore state or same start and end data
        if (this.ignoreSelection || (dSel.start === sel.start && dSel.end === sel.end)) {
            return;
        }

        this.selection = dSel;
        this.format();
    }

    /**
     * Calc values for first and prev
     * @protected
     */
    recalcFirstAndPref() {
        const me      = this,
              pattern = me.pattern,
              slots   = me.slots;

        me.prev = (j => Array.from(pattern, (c, i) => slots.has(c) ? j = i + 1 : j))(0);
        me.first = [...pattern].findIndex(c => slots.has(c));

        me.selection = {start: me.first, end: me.first};

        if (me.owner.value) me.format();
    }
}

Neo.setupClass(PrefixField);

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (PrefixField);


/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2h1bmtzL2FwcC92ZW5kb3JzLWV4YW1wbGVzX2ZpZWxkV2l0aFByZWZpeF9hcHBfbWpzLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQXNFO0FBQ0w7QUFDSTtBQUNIOztBQUVsRTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixrRUFBcUI7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixnQ0FBZ0M7QUFDL0Q7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsK0NBQStDLGVBQWU7O0FBRTlEO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSx1QkFBdUIsZ0VBQVM7QUFDaEM7QUFDQTtBQUNBLHdCQUF3QixvREFBb0Q7QUFDNUU7QUFDQSx3QkFBd0I7QUFDeEIsU0FBUztBQUNULHVCQUF1QixnRUFBUztBQUNoQztBQUNBO0FBQ0Esd0JBQXdCLGtEQUFrRDtBQUMxRTtBQUNBLHdCQUF3QjtBQUN4QixTQUFTO0FBQ1Qsb0JBQW9CLG9FQUFRO0FBQzVCO0FBQ0Esd0JBQXdCLFVBQVUsV0FBVyxHQUFHLGFBQWEsR0FBRyxjQUFjLEVBQUU7QUFDaEY7QUFDQSxxQkFBcUIsMENBQTBDO0FBQy9ELHFCQUFxQix1Q0FBdUM7QUFDNUQscUJBQXFCLHVDQUF1QztBQUM1RCxxQkFBcUIsb0NBQW9DO0FBQ3pELHFCQUFxQixvQ0FBb0M7QUFDekQscUJBQXFCO0FBQ3JCO0FBQ0EsYUFBYTs7QUFFYjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLHdCQUF3QixtREFBbUQ7QUFDM0Usd0JBQXdCO0FBQ3hCLFNBQVM7QUFDVDs7QUFFQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsZ0NBQWdDO0FBQ3JEO0FBQ0EsMkJBQTJCLGdFQUFTO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyxtRUFBWTtBQUM3QztBQUNBO0FBQ0E7QUFD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by5tanMvLi9leGFtcGxlcy9maWVsZFdpdGhQcmVmaXgvTWFpbkNvbnRhaW5lci5tanMiLCJ3ZWJwYWNrOi8vbmVvLm1qcy8uL2V4YW1wbGVzL2ZpZWxkV2l0aFByZWZpeC9hcHAubWpzIiwid2VicGFjazovL25lby5tanMvLi9zcmMvcGx1Z2luL0Jhc2UubWpzIiwid2VicGFjazovL25lby5tanMvLi9zcmMvcGx1Z2luL1ByZWZpeEZpZWxkLm1qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQ29tYm9Cb3ggICAgICAgICAgICAgIGZyb20gJy4uLy4uL3NyYy9mb3JtL2ZpZWxkL0NvbWJvQm94Lm1qcyc7XG5pbXBvcnQgQ29uZmlndXJhdGlvblZpZXdwb3J0IGZyb20gJy4uL0NvbmZpZ3VyYXRpb25WaWV3cG9ydC5tanMnO1xuaW1wb3J0IFByZWZpeFBsdWdpbiAgICAgICAgICBmcm9tICcuLi8uLi9zcmMvcGx1Z2luL1ByZWZpeEZpZWxkLm1qcyc7XG5pbXBvcnQgVGV4dEZpZWxkICAgICAgICAgICAgIGZyb20gJy4uLy4uL3NyYy9mb3JtL2ZpZWxkL1RleHQubWpzJztcblxuLyoqXG4gKiBAY2xhc3MgTmVvLmV4YW1wbGVzLmZpZWxkV2l0aFByZWZpeC5NYWluQ29udGFpbmVyXG4gKiBAZXh0ZW5kcyBOZW8uZXhhbXBsZXMuQ29uZmlndXJhdGlvblZpZXdwb3J0XG4gKi9cbmNsYXNzIE1haW5Db250YWluZXIgZXh0ZW5kcyBDb25maWd1cmF0aW9uVmlld3BvcnQge1xuICAgIHN0YXRpYyBjb25maWcgPSB7XG4gICAgICAgIGNsYXNzTmFtZSAgICAgICAgICAgOiAnTmVvLmV4YW1wbGVzLmZpZWxkV2l0aFByZWZpeC5NYWluQ29udGFpbmVyJyxcbiAgICAgICAgYXV0b01vdW50ICAgICAgICAgICA6IHRydWUsXG4gICAgICAgIGNvbmZpZ0l0ZW1MYWJlbFdpZHRoOiAxMDAsXG4gICAgICAgIGNvbmZpZ0l0ZW1XaWR0aCAgICAgOiAyMzAsXG4gICAgICAgIGxheW91dCAgICAgICAgICAgICAgOiB7bnR5cGU6ICdoYm94JywgYWxpZ246ICdzdHJldGNoJ30sXG4gICAgICAgIGNscyAgICAgICAgICAgICAgICAgOiBbJ2V4YW1wbGVzLWNvbnRhaW5lci1hY2NvcmRpb24nXVxuICAgIH1cblxuICAgIG9uUGx1Z2luQ29uZmlnQ2hhbmdlKGNvbmZpZywgb3B0cykge1xuICAgICAgICBjb25zdCB0ZXh0ZmllbGQgPSB0aGlzLmV4YW1wbGVDb21wb25lbnQuaXRlbXNbMF0sXG4gICAgICAgICAgICAgIHBsdWdpbiAgICA9IHRleHRmaWVsZC5nZXRQbHVnaW4oe2ZsYWc6ICdwcmVmaXgnfSk7XG5cbiAgICAgICAgaWYgKGNvbmZpZyA9PT0gJ2FjY2VwdCcpIHtcbiAgICAgICAgICAgIHBsdWdpbi5hY2NlcHQgPSBvcHRzLnJlY29yZC52YWx1ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHBsdWdpbltjb25maWddID0gb3B0cy52YWx1ZTtcbiAgICAgICAgICAgIHRleHRmaWVsZC52YWx1ZSA9ICcnO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY3JlYXRlQ29uZmlndXJhdGlvbkNvbXBvbmVudHMoKSB7XG4gICAgICAgIGxldCBtZSAgICAgICAgPSB0aGlzLFxuICAgICAgICAgICAgdGV4dGZpZWxkID0gbWUuZXhhbXBsZUNvbXBvbmVudC5pdGVtc1swXSxcbiAgICAgICAgICAgIHBsdWdpbiAgICA9IHRleHRmaWVsZC5wbHVnaW5zWzBdO1xuXG4gICAgICAgIHJldHVybiBbe1xuICAgICAgICAgICAgbW9kdWxlICAgOiBUZXh0RmllbGQsXG4gICAgICAgICAgICBjbGVhcmFibGU6IHRydWUsXG4gICAgICAgICAgICBsYWJlbFRleHQ6ICdwYXR0ZXJuJyxcbiAgICAgICAgICAgIGxpc3RlbmVyczoge2NoYW5nZTogbWUub25QbHVnaW5Db25maWdDaGFuZ2UuYmluZChtZSwgJ3BhdHRlcm4nKX0sXG4gICAgICAgICAgICB2YWx1ZSAgICA6IHBsdWdpbi5wYXR0ZXJuLFxuICAgICAgICAgICAgc3R5bGUgICAgOiB7bWFyZ2luVG9wOiAnMTBweCd9XG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIG1vZHVsZSAgIDogVGV4dEZpZWxkLFxuICAgICAgICAgICAgY2xlYXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgbGFiZWxUZXh0OiAnc2xvdHMnLFxuICAgICAgICAgICAgbGlzdGVuZXJzOiB7Y2hhbmdlOiBtZS5vblBsdWdpbkNvbmZpZ0NoYW5nZS5iaW5kKG1lLCAnc2xvdHMnKX0sXG4gICAgICAgICAgICB2YWx1ZSAgICA6ICdfJyxcbiAgICAgICAgICAgIHN0eWxlICAgIDoge21hcmdpblRvcDogJzEwcHgnfVxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBtb2R1bGU6IENvbWJvQm94LFxuICAgICAgICAgICAgc3RvcmUgOiB7XG4gICAgICAgICAgICAgICAgbW9kZWw6IHtmaWVsZHM6IFt7bmFtZTogJ2lkJ30sIHtuYW1lOiAnbmFtZSd9LCB7bmFtZTogJ3ZhbHVlJ31dfSxcbiAgICAgICAgICAgICAgICBkYXRhIDogW1xuICAgICAgICAgICAgICAgICAgICB7aWQ6ICcwJywgbmFtZTogJ2VtcHR5PS9cXFxcZC8nLCB2YWx1ZTogbnVsbH0sXG4gICAgICAgICAgICAgICAgICAgIHtpZDogJzEnLCBuYW1lOiAnWzAtOV0nLCB2YWx1ZTogJ1swLTldJ30sXG4gICAgICAgICAgICAgICAgICAgIHtpZDogJzInLCBuYW1lOiAnW0EtSF0nLCB2YWx1ZTogJ1tBLUhdJ30sXG4gICAgICAgICAgICAgICAgICAgIHtpZDogJzMnLCBuYW1lOiAnL1xcXFx3LycsIHZhbHVlOiAvXFx3L30sXG4gICAgICAgICAgICAgICAgICAgIHtpZDogJzQnLCBuYW1lOiAnL1xcXFxkLycsIHZhbHVlOiAvXFxkL30sXG4gICAgICAgICAgICAgICAgICAgIHtpZDogJzUnLCBuYW1lOiAnWzAtOWEtZl0nLCB2YWx1ZTogJ1swLTlhLWZdJ31cbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICB2YWx1ZSAgICAgICA6ICc0JyxcbiAgICAgICAgICAgIGRpc3BsYXlGaWVsZDogJ25hbWUnLFxuICAgICAgICAgICAgdmFsdWVGaWVsZCAgOiAndmFsdWUnLFxuXG4gICAgICAgICAgICBjbGVhcmFibGU6IHRydWUsXG4gICAgICAgICAgICBsYWJlbFRleHQ6ICdhY2NlcHQnLFxuICAgICAgICAgICAgbGlzdGVuZXJzOiB7Y2hhbmdlOiBtZS5vblBsdWdpbkNvbmZpZ0NoYW5nZS5iaW5kKG1lLCAnYWNjZXB0Jyl9LFxuICAgICAgICAgICAgc3R5bGUgICAgOiB7bWFyZ2luVG9wOiAnMTBweCd9XG4gICAgICAgIH1dO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEByZXR1cm5zIHsqfVxuICAgICAqL1xuICAgIGNyZWF0ZUV4YW1wbGVDb21wb25lbnQoKSB7XG4gICAgICAgIHJldHVybiBOZW8ubnR5cGUoe1xuICAgICAgICAgICAgbnR5cGUgOiAnY29udGFpbmVyJyxcbiAgICAgICAgICAgIHdpZHRoIDogMzUwLFxuICAgICAgICAgICAgY2xzICAgOiBbJ2V4YW1wbGUtZmllbGRXaXRoUHJlZml4J10sXG4gICAgICAgICAgICBsYXlvdXQ6IHtudHlwZTogJ3Zib3gnLCBhbGlnbjogJ3N0cmV0Y2gnfSxcbiAgICAgICAgICAgIGl0ZW1zIDogW3tcbiAgICAgICAgICAgICAgICBtb2R1bGUgICA6IFRleHRGaWVsZCxcbiAgICAgICAgICAgICAgICBsYWJlbFRleHQ6ICdQaG9uZSBOdW1iZXInLFxuICAgICAgICAgICAgICAgIHBsdWdpbnMgIDogW1xuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtb2R1bGUgOiBQcmVmaXhQbHVnaW4sXG4gICAgICAgICAgICAgICAgICAgICAgICBmbGFnICAgOiAncHJlZml4JyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhdHRlcm46ICcrMSAoX19fKSBfX18tX19fLV9fX18nLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2xvdHMgIDogJ18nXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgbW9kdWxlICAgOiBUZXh0RmllbGQsXG4gICAgICAgICAgICAgICAgbGFiZWxUZXh0OiAnWzAtOV0gRGF0ZScsXG4gICAgICAgICAgICAgICAgcGx1Z2lucyAgOiBbXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZHVsZSA6IFByZWZpeFBsdWdpbixcbiAgICAgICAgICAgICAgICAgICAgICAgIGZsYWcgICA6ICdwcmVmaXgnLFxuICAgICAgICAgICAgICAgICAgICAgICAgcGF0dGVybjogJ2RkL21tL3l5eXkgaGg6bW0nLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2xvdHMgIDogJ2RteWgnXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgbW9kdWxlICAgOiBUZXh0RmllbGQsXG4gICAgICAgICAgICAgICAgbGFiZWxUZXh0OiAnW0EtSF0gTUFDIEFkcmVzcycsXG4gICAgICAgICAgICAgICAgcGx1Z2lucyAgOiBbXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZHVsZSA6IFByZWZpeFBsdWdpbixcbiAgICAgICAgICAgICAgICAgICAgICAgIGZsYWcgICA6ICdwcmVmaXgnLFxuICAgICAgICAgICAgICAgICAgICAgICAgcGF0dGVybjogJ1hYOlhYOlhYOlhYOlhYOlhYJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNsb3RzICA6ICdYJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY2VwdCA6ICdbQS1IXSdcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICBtb2R1bGUgICA6IFRleHRGaWVsZCxcbiAgICAgICAgICAgICAgICBsYWJlbFRleHQ6ICcvXFxcXHcvIEFscGhhbnVtZXJpYycsXG4gICAgICAgICAgICAgICAgcGx1Z2lucyAgOiBbXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZHVsZSA6IFByZWZpeFBsdWdpbixcbiAgICAgICAgICAgICAgICAgICAgICAgIGZsYWcgICA6ICdwcmVmaXgnLFxuICAgICAgICAgICAgICAgICAgICAgICAgcGF0dGVybjogJ19fLV9fLV9fLV9fX18nLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2xvdHMgIDogJ18nLFxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjZXB0IDogL1xcdy9cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICBtb2R1bGUgICA6IFRleHRGaWVsZCxcbiAgICAgICAgICAgICAgICBsYWJlbFRleHQ6ICcvXFxcXGQvIENyZWRpdCBDYXJkJyxcbiAgICAgICAgICAgICAgICBwbHVnaW5zICA6IFtcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgbW9kdWxlIDogUHJlZml4UGx1Z2luLFxuICAgICAgICAgICAgICAgICAgICAgICAgZmxhZyAgIDogJ3ByZWZpeCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXR0ZXJuOiAnLi4uLiAuLi4uIC4uLi4gLi4uLicsXG4gICAgICAgICAgICAgICAgICAgICAgICBzbG90cyAgOiAnLicsXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NlcHQgOiAvXFxkL1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgfV1cbiAgICAgICAgfSlcbiAgICB9XG59XG5cbk5lby5zZXR1cENsYXNzKE1haW5Db250YWluZXIpO1xuXG5leHBvcnQgZGVmYXVsdCBNYWluQ29udGFpbmVyO1xuIiwiaW1wb3J0IE1haW5Db250YWluZXIgZnJvbSAnLi9NYWluQ29udGFpbmVyLm1qcyc7XG5cbmV4cG9ydCBjb25zdCBvblN0YXJ0ID0gKCkgPT4gTmVvLmFwcCh7XG4gICAgbWFpblZpZXc6IE1haW5Db250YWluZXIsXG4gICAgbmFtZSAgICA6ICdOZW8uZXhhbXBsZXMuZmllbGRXaXRoUHJlZml4J1xufSk7XG4iLCJpbXBvcnQgQ29yZUJhc2UgZnJvbSAnLi4vY29yZS9CYXNlLm1qcyc7XG5cbi8qKlxuICogUGx1Z2lucyBhcmUgaW50ZW5kZWQgdG8gZ2V0IHB1dCBpbnRvIHRoZSBwbHVnaW5zIGNvbmZpZyBvZiBjb21wb25lbnQuQmFzZVxuICogdG8gZW5oYW5jZSB0aGVtIG9yIGFkZCBhZGRpdGlvbmFsIGZlYXR1cmVzXG4gKiBAY2xhc3MgTmVvLnBsdWdpbi5CYXNlXG4gKiBAZXh0ZW5kcyBOZW8uY29yZS5CYXNlXG4gKi9cbmNsYXNzIEJhc2UgZXh0ZW5kcyBDb3JlQmFzZSB7XG4gICAgc3RhdGljIGNvbmZpZyA9IHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge1N0cmluZ30gY2xhc3NOYW1lPSdOZW8ucGx1Z2luLkJhc2UnXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIGNsYXNzTmFtZTogJ05lby5wbHVnaW4uQmFzZScsXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtTdHJpbmd9IG50eXBlPSdwbHVnaW4nXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIG50eXBlOiAncGx1Z2luJyxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge05lby5jb21wb25lbnQuQmFzZX0gb3duZXI9bnVsbFxuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICBvd25lcjogbnVsbFxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWdcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3QoY29uZmlnKSB7XG4gICAgICAgIHN1cGVyLmNvbnN0cnVjdChjb25maWcpO1xuXG4gICAgICAgIGxldCBtZSA9IHRoaXM7XG5cbiAgICAgICAgaWYgKG1lLm93bmVyLm1vdW50ZWQpIHtcbiAgICAgICAgICAgIG1lLm9uT3duZXJNb3VudGVkKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBtZS5vd25lci5vbignbW91bnRlZCcsIG1lLm9uT3duZXJNb3VudGVkLCBtZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBPdmVycmlkZSB0aGlzIG1ldGhvZCB0byBhcHBseSBjaGFuZ2VzIHRvIHRoZSBvd25lciBDb21wb25lbnQgd2hlbiBpdCBkb2VzIGdldCBtb3VudGVkXG4gICAgICovXG4gICAgb25Pd25lck1vdW50ZWQoKSB7XG5cbiAgICB9XG59XG5cbk5lby5zZXR1cENsYXNzKEJhc2UpO1xuXG5leHBvcnQgZGVmYXVsdCBCYXNlO1xuIiwiaW1wb3J0IEJhc2UgZnJvbSAnLi9CYXNlLm1qcyc7XG5cbi8qKlxuICogQGNsYXNzIE5lby5wbHVnaW4uUHJlZml4RmllbGRcbiAqIEBleHRlbmRzIE5lby5wbHVnaW4uQmFzZVxuICpcbiAqIEBleGFtcGxlXG4gKlxuICogICAgIHtcbiAqICAgICAgICAgbW9kdWxlICAgOiBUZXh0RmllbGQsXG4gKiAgICAgICAgIGxhYmVsVGV4dDogJ0NyZWRpdCBDYXJkJyxcbiAqICAgICAgICAgcGx1Z2lucyAgOiBbe1xuICogICAgICAgICAgICAgbW9kdWxlIDogUHJlZml4UGx1Z2luLCAvLyBpbXBvcnQgUHJlZml4UGx1Z2luIGZyb20gJy4uLy4uL3NyYy9wbHVnaW4vUHJlZml4RmllbGQubWpzJztcbiAqICAgICAgICAgICAgIGZsYWcgICA6ICdwcmVmaXgnLCAgICAgLy8gdGV4dEZpZWxkLmdldFBsdWdpbnMoe2ZsYWc6ICdwcmVmaXgnfSlcbiAqICAgICAgICAgICAgIHBhdHRlcm46ICdkZC9tbS95eXl5JyxcbiAqICAgICAgICAgICAgIHNsb3RzICA6ICdkbXknLCAgICAgICAgLy8gY2hhcmFjdGVycyBhbGxvd2VkIHRvIHJlcGxhY2VcbiAqICAgICAgICAgICAgIGFjY2VwdCA6IC9cXGQvICAgICAgICAgIC8vIGVpdGhlciAnW0EtWl0nIG9yIHJlZ2V4IG9yIHVuZGVmaW5lZFxuICogICAgICAgICB9XVxuICogICAgIH1cbiAqL1xuY2xhc3MgUHJlZml4RmllbGQgZXh0ZW5kcyBCYXNlIHtcbiAgICBzdGF0aWMgY29uZmlnID0ge1xuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfSBjbGFzc05hbWU9J05lby5wbHVnaW4uUHJlZml4RmllbGQnXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIGNsYXNzTmFtZTogJ05lby5wbHVnaW4uUHJlZml4RmllbGQnLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfSBudHlwZT0ncGx1Z2luLXByZWZpeGZpZWxkJ1xuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICBudHlwZTogJ3BsdWdpbi1wcmVmaXhmaWVsZCcsXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEN1c3RvbSBjbHMgYWRkZWQgdG8gdGhlIGlucHV0RWxcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfSBpbnB1dENscz0nbmVvLXByZWZpeGZpZWxkLWlucHV0J1xuICAgICAgICAgKi9cbiAgICAgICAgaW5wdXRDbHM6ICduZW8tcHJlZml4ZmllbGQtaW5wdXQnLFxuICAgICAgICAvKipcbiAgICAgICAgICogQ3VzdG9tIGNscyBhZGRlZCB0byB0aGUgaW5wdXRFbFxuICAgICAgICAgKiBAbWVtYmVyIHtTdHJpbmd9IGlucHV0Q2xzPSduZW8tcHJlZml4ZmllbGQtaW5wdXQnXG4gICAgICAgICAqL1xuICAgICAgICBsYWJlbENsczogJ25lby1wcmVmaXhmaWVsZC1sYWJlbCcsXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDdXN0b20gY2xzIHRvIGFkZCB0byB0aGUgb3duZXIgY29tcG9uZW50XG4gICAgICAgICAqIEBtZW1iZXIge1N0cmluZ30gb3duZXJDbHM9J25lby1wcmVmaXhmaWVsZCdcbiAgICAgICAgICovXG4gICAgICAgIG93bmVyQ2xzOiAnbmVvLXByZWZpeGZpZWxkJyxcblxuICAgICAgICAvKipcbiAgICAgICAgICogcmVnZXggdG8gY2FsY3VsYXRlIGlmIGVudGVyZWQgdmFsdWUgaXMgYWNjZXB0YWJsZVxuICAgICAgICAgKiBQcmVzZXQgdG8gbnVtYmVycyBvbmx5XG4gICAgICAgICAqXG4gICAgICAgICAqIEBtZW1iZXIge3JlZ2V4fG51bGx9IGFjY2VwdFxuICAgICAgICAgKi9cbiAgICAgICAgYWNjZXB0XzogbnVsbCxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge1N0cmluZ30gcGF0dGVybj1udWxsXG4gICAgICAgICAqL1xuICAgICAgICBwYXR0ZXJuXzogbnVsbCxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIE9ubHkgYWRkIGEgU3RyaW5nLiBBIFNldCB3aWxsIGJlIGF1dG9tYXRpY2FsbHkgY3JlYXRlZFxuICAgICAgICAgKiBAbWVtYmVyIHtTdHJpbmd8U2V0fG51bGx9IHNsb3RzPW51bGxcbiAgICAgICAgICovXG4gICAgICAgIHNsb3RzXzogbnVsbFxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZpcnN0IGFjY2VwdGVkIHBsYWNlIHRvIGVudGVyIGEgdmFsdWVcbiAgICAgKiBAbWVtYmVyIHtOdW1iZXJ9IGZpcnN0XG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIGZpcnN0ID0gbnVsbDtcbiAgICAvKipcbiAgICAgKiBBcnJheSBvZiBudW1iZXJzLCB3aGljaCBzaG93cyB0aGUgcHJldmlvdXMgZW50cnkgcG9pbnRcbiAgICAgKiBAbWVtYmVyIHtBcnJheVtdfSBwcmV2XG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIHByZXYgPSBudWxsO1xuICAgIC8qKlxuICAgICAqIFBvc2l0aW9uIG9mIHRoZSBjdXJzb3IgaW5zaWRlIGlucHV0IGVsZW1lbnRcbiAgICAgKiBAbWVtYmVyIHtPYmplY3R9IHNlbGVjdGlvblxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICBzZWxlY3Rpb24gPSBudWxsO1xuXG4gICAgLyoqXG4gICAgICogU3RhdGUgaWYgc2VsZWN0aW9uIHNob3VsZCBiZSB1cGRhdGVkXG4gICAgICogQG1lbWJlciB7Qm9vbGVhbn0gaWdub3JlU2VsZWN0aW9uXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIGlnbm9yZVNlbGVjdGlvbiA9IGZhbHNlO1xuICAgIC8qKlxuICAgICAqIFN0YXRlIGlmIGxhc3QgZW50cnkgd2FzIHRoZSBiYWNrIGJ1dHRvblxuICAgICAqIEBtZW1iZXIge0Jvb2xlYW59IGJhY2tcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICovXG4gICAgYmFjayA9IGZhbHNlO1xuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGNvbmZpZ1xuICAgICAqL1xuICAgIGNvbnN0cnVjdChjb25maWcpIHtcbiAgICAgICAgbGV0IG1lID0gdGhpcztcblxuICAgICAgICBzdXBlci5jb25zdHJ1Y3QoY29uZmlnKTtcblxuICAgICAgICBtZS5hZGRMaXN0ZW5lcnMoKTtcbiAgICAgICAgbWUuYWRkQ3NzKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkIGEgY3VzdG9tIGNscyB0byB0aGUgb3duZXIgY29tcG9uZW50XG4gICAgICovXG4gICAgYWRkQ3NzKCkge1xuICAgICAgICBjb25zdCBtZSAgICAgID0gdGhpcyxcbiAgICAgICAgICAgICAgb3duZXIgICA9IG1lLm93bmVyLFxuICAgICAgICAgICAgICBpbnB1dEVsID0gb3duZXIuZ2V0SW5wdXRFbCgpLFxuICAgICAgICAgICAgICBsYWJlbEVsID0gb3duZXIuZ2V0TGFiZWxFbCgpO1xuXG4gICAgICAgIG93bmVyICAgIC5hZGRDbHMobWUub3duZXJDbHMpO1xuICAgICAgICBpbnB1dEVsLmNscy5wdXNoKG1lLmlucHV0Q2xzKTtcbiAgICAgICAgbGFiZWxFbC5jbHMucHVzaChtZS5sYWJlbENscyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkIGxpc3RlbmVyc1xuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICBhZGRMaXN0ZW5lcnMoKSB7XG4gICAgICAgIGxldCBtZSAgICA9IHRoaXMsXG4gICAgICAgICAgICBvd25lciA9IG1lLm93bmVyLFxuICAgICAgICAgICAgbGlzdGVuZXJJZDtcblxuICAgICAgICBvd25lci5hZGREb21MaXN0ZW5lcnMoW1xuICAgICAgICAgICAge2tleWRvd24gICAgICAgIDogbWUub25GaWVsZEtleURvd24gICAgICAgICwgc2NvcGU6IG1lfSxcbiAgICAgICAgICAgIHtmb2N1c2luICAgICAgICA6IG1lLm9uRmllbGRGb2N1cyAgICAgICAgICAsIHNjb3BlOiBtZX0sXG4gICAgICAgICAgICB7Zm9jdXNvdXQgICAgICAgOiBtZS5vbkZpZWxkQmx1ciAgICAgICAgICAgLCBzY29wZTogbWV9LFxuICAgICAgICAgICAge3NlbGVjdGlvbmNoYW5nZTogbWUub25GaWVsZFNlbGVjdGlvbkNoYW5nZSwgc2NvcGU6IG1lfVxuICAgICAgICBdKTtcblxuICAgICAgICBsaXN0ZW5lcklkID0gbWUub3duZXIub24oJ21vdW50ZWQnLCAoKSA9PiB7XG4gICAgICAgICAgICBOZW8uY3VycmVudFdvcmtlci5pbnNlcnRUaGVtZUZpbGVzKG93bmVyLmFwcE5hbWUsIG93bmVyLndpbmRvd0lkLCBtZS5fX3Byb3RvX18pO1xuXG4gICAgICAgICAgICBvd25lci51bignbW91bnRlZCcsIGxpc3RlbmVySWQpO1xuICAgICAgICAgICAgbGlzdGVuZXJJZCA9IG51bGw7XG4gICAgICAgIH0pXG4gICAgfVxuXG5cbiAgICAvKipcbiAgICAgKiBBZnRlciBzZXR0aW5nIGFjY2VwdCBmb3JtYXQgb3V0cHV0XG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHZhbHVlXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IG9sZFZhbHVlXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIGFmdGVyU2V0QWNjZXB0KHZhbHVlLCBvbGRWYWx1ZSkge1xuICAgICAgICBpZiAodGhpcy5vd25lci52YWx1ZSkgdGhpcy5mb3JtYXQoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZnRlciBzZXR0aW5nIHBhdHRlcm4gcmVjYWxjIG90aGVyIHZhbHVlcyBhbmQgc2V0IHBsYWNlaG9sZGVyXG4gICAgICogQHBhcmFtIHtTZXR9IHZhbHVlXG4gICAgICogQHBhcmFtIHtTZXR9IG9sZFZhbHVlXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIGFmdGVyU2V0UGF0dGVybih2YWx1ZSwgb2xkVmFsdWUpIHtcbiAgICAgICAgdGhpcy5vd25lci5wbGFjZWhvbGRlclRleHQgPSB2YWx1ZTtcbiAgICAgICAgdGhpcy5yZWNhbGNGaXJzdEFuZFByZWYoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZnRlciBzZXR0aW5nIHNsb3RzIHJlY2FsYyBvdGhlciB2YWx1ZXNcbiAgICAgKiBAcGFyYW0ge1NldH0gdmFsdWVcbiAgICAgKiBAcGFyYW0ge1NldH0gb2xkVmFsdWVcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICovXG4gICAgYWZ0ZXJTZXRTbG90cyh2YWx1ZSwgb2xkVmFsdWUpIHtcbiAgICAgICAgdGhpcy5yZWNhbGNGaXJzdEFuZFByZWYoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCZWZvcmUgdGhlIG5ldyB2YWx1ZSBmb3Igc2xvdHMgd2lsbCBiZSBzZXQgd2UgY3JlYXRlIGEgU2V0IGZyb20gdGhlIHN0cmluZ1xuICAgICAqIEBwYXJhbSB7U3RyaW5nfSB2YWx1ZVxuICAgICAqIEByZXR1cm4ge1NldH1cbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICovXG4gICAgYmVmb3JlU2V0U2xvdHModmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBTZXQodmFsdWUgfHwgXCJfXCIpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlbW92ZSB1bndhbnRlZCBlbnRyaWVzIGFuZCBsaW1pdCBsZW5ndGhcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gaW5wdXRcbiAgICAgKiBAcmV0dXJucyB7YW55W119XG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIGNsZWFuKGlucHV0KSB7XG4gICAgICAgIGNvbnN0IG1lICAgICA9IHRoaXMsXG4gICAgICAgICAgICAgIGFjY2VwdCA9IG5ldyBSZWdFeHAodGhpcy5hY2NlcHQgfHwgXCJcXFxcZFwiLCBcImdcIik7XG5cbiAgICAgICAgaW5wdXQgPSBpbnB1dC5tYXRjaChhY2NlcHQpIHx8IFtdO1xuICAgICAgICBpbnB1dCA9IEFycmF5LmZyb20obWUucGF0dGVybiwgYyA9PlxuICAgICAgICAgICAgaW5wdXRbMF0gPT09IGMgfHwgbWUuc2xvdHMuaGFzKGMpID8gaW5wdXQuc2hpZnQoKSB8fCBjIDogY1xuICAgICAgICApO1xuXG4gICAgICAgIHJldHVybiBpbnB1dC5zbGljZSgwLCBtZS5wYXR0ZXJuLmxlbmd0aCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2FsY3VsYXRlIHBvc2l0aW9uIGFuZCBvdXRwdXQgY29ycmVjdCBTdHJpbmcgdG8gRmllbGRcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICovXG4gICAgZm9ybWF0KCkge1xuICAgICAgICBjb25zdCBtZSAgICAgICAgPSB0aGlzLFxuICAgICAgICAgICAgICBlbCAgICAgICAgPSBtZS5vd25lcixcbiAgICAgICAgICAgICAgc2VsZWN0aW9uID0gbWUuc2VsZWN0aW9uLFxuICAgICAgICAgICAgICBwcmV2ICAgICAgPSBtZS5wcmV2LFxuICAgICAgICAgICAgICBjbGVhbiAgICAgPSBtZS5jbGVhbi5iaW5kKG1lKTtcbiAgICAgICAgbGV0IHZhbHVlID0gZWwudmFsdWUgfHwgJyc7XG5cbiAgICAgICAgY29uc3QgW2ksIGpdID0gW3NlbGVjdGlvbi5zdGFydCwgc2VsZWN0aW9uLmVuZF0ubWFwKGkgPT4ge1xuICAgICAgICAgICAgaSA9IG1lLmNsZWFuKHZhbHVlLnNsaWNlKDAsIGkpKS5maW5kSW5kZXgoYyA9PiBtZS5zbG90cy5oYXMoYykpO1xuICAgICAgICAgICAgcmV0dXJuIGkgPCAwID8gcHJldltwcmV2Lmxlbmd0aCAtIDFdIDogbWUuYmFjayA/IHByZXZbaSAtIDFdIHx8IG1lLmZpcnN0IDogaTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgZWwudmFsdWUgPSBjbGVhbih2YWx1ZSkuam9pbmBgO1xuICAgICAgICB0aGlzLmlnbm9yZVNlbGVjdGlvbiA9IHRydWU7XG5cbiAgICAgICAgTmVvLm1haW4uRG9tQWNjZXNzLnNlbGVjdE5vZGUoe2lkOiBlbC5nZXRJbnB1dEVsSWQoKSwgc3RhcnQ6IGksIGVuZDogan0pO1xuICAgICAgICB0aGlzLmlnbm9yZVNlbGVjdGlvbiA9IGZhbHNlO1xuXG4gICAgICAgIHRoaXMuYmFjayA9IGZhbHNlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV2ZW50XG4gICAgICogQHBhcmFtIHtPYmplY3R9IGRhdGFcbiAgICAgKiBAcmV0dXJucyB7ZmFsc2V8c3RyaW5nfVxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICBvbkZpZWxkQmx1cihkYXRhKSB7XG4gICAgICAgIGNvbnN0IHBhdHRlcm4gPSB0aGlzLnBhdHRlcm4sXG4gICAgICAgICAgICAgIGVsICAgICAgPSB0aGlzLm93bmVyO1xuXG4gICAgICAgIHJldHVybiBlbC52YWx1ZSA9PT0gcGF0dGVybiAmJiAoZWwudmFsdWUgPSBcIlwiKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFdmVudFxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBkYXRhXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIG9uRmllbGRGb2N1cyhkYXRhKSB7XG4gICAgICAgIHRoaXMuZm9ybWF0KCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXZlbnRcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YVxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICBvbkZpZWxkS2V5RG93bihkYXRhKSB7XG4gICAgICAgIHRoaXMuYmFjayA9IChkYXRhLmtleSA9PT0gXCJCYWNrc3BhY2VcIik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXZlbnRcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YVxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICBvbkZpZWxkU2VsZWN0aW9uQ2hhbmdlKGRhdGEpIHtcbiAgICAgICAgbGV0IHNlbCAgPSB0aGlzLnNlbGVjdGlvbixcbiAgICAgICAgICAgIGRTZWwgPSBkYXRhLnNlbGVjdGlvbjtcblxuICAgICAgICAvLyBEbyBub3QgcnVuLCBpZiBpZ25vcmUgc3RhdGUgb3Igc2FtZSBzdGFydCBhbmQgZW5kIGRhdGFcbiAgICAgICAgaWYgKHRoaXMuaWdub3JlU2VsZWN0aW9uIHx8IChkU2VsLnN0YXJ0ID09PSBzZWwuc3RhcnQgJiYgZFNlbC5lbmQgPT09IHNlbC5lbmQpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnNlbGVjdGlvbiA9IGRTZWw7XG4gICAgICAgIHRoaXMuZm9ybWF0KCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2FsYyB2YWx1ZXMgZm9yIGZpcnN0IGFuZCBwcmV2XG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIHJlY2FsY0ZpcnN0QW5kUHJlZigpIHtcbiAgICAgICAgY29uc3QgbWUgICAgICA9IHRoaXMsXG4gICAgICAgICAgICAgIHBhdHRlcm4gPSBtZS5wYXR0ZXJuLFxuICAgICAgICAgICAgICBzbG90cyAgID0gbWUuc2xvdHM7XG5cbiAgICAgICAgbWUucHJldiA9IChqID0+IEFycmF5LmZyb20ocGF0dGVybiwgKGMsIGkpID0+IHNsb3RzLmhhcyhjKSA/IGogPSBpICsgMSA6IGopKSgwKTtcbiAgICAgICAgbWUuZmlyc3QgPSBbLi4ucGF0dGVybl0uZmluZEluZGV4KGMgPT4gc2xvdHMuaGFzKGMpKTtcblxuICAgICAgICBtZS5zZWxlY3Rpb24gPSB7c3RhcnQ6IG1lLmZpcnN0LCBlbmQ6IG1lLmZpcnN0fTtcblxuICAgICAgICBpZiAobWUub3duZXIudmFsdWUpIG1lLmZvcm1hdCgpO1xuICAgIH1cbn1cblxuTmVvLnNldHVwQ2xhc3MoUHJlZml4RmllbGQpO1xuXG5leHBvcnQgZGVmYXVsdCBQcmVmaXhGaWVsZDtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==