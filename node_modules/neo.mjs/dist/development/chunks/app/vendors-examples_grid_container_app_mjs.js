"use strict";
(self["webpackChunkneo_mjs"] = self["webpackChunkneo_mjs"] || []).push([["vendors-examples_grid_container_app_mjs"],{

/***/ "./examples/grid/container/MainContainer.mjs":
/*!***************************************************!*\
  !*** ./examples/grid/container/MainContainer.mjs ***!
  \***************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _src_selection_grid_CellColumnModel_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../src/selection/grid/CellColumnModel.mjs */ "./src/selection/grid/CellColumnModel.mjs");
/* harmony import */ var _src_selection_grid_CellColumnRowModel_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../src/selection/grid/CellColumnRowModel.mjs */ "./src/selection/grid/CellColumnRowModel.mjs");
/* harmony import */ var _src_selection_grid_CellModel_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../src/selection/grid/CellModel.mjs */ "./src/selection/grid/CellModel.mjs");
/* harmony import */ var _src_selection_grid_CellRowModel_mjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../src/selection/grid/CellRowModel.mjs */ "./src/selection/grid/CellRowModel.mjs");
/* harmony import */ var _ConfigurationViewport_mjs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../ConfigurationViewport.mjs */ "./examples/ConfigurationViewport.mjs");
/* harmony import */ var _src_selection_grid_ColumnModel_mjs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../src/selection/grid/ColumnModel.mjs */ "./src/selection/grid/ColumnModel.mjs");
/* harmony import */ var _src_grid_Container_mjs__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../src/grid/Container.mjs */ "./src/grid/Container.mjs");
/* harmony import */ var _MainStore_mjs__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./MainStore.mjs */ "./examples/grid/container/MainStore.mjs");
/* harmony import */ var _src_form_field_Number_mjs__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../src/form/field/Number.mjs */ "./src/form/field/Number.mjs");
/* harmony import */ var _src_form_field_Radio_mjs__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../src/form/field/Radio.mjs */ "./src/form/field/Radio.mjs");
/* harmony import */ var _src_selection_grid_RowModel_mjs__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../src/selection/grid/RowModel.mjs */ "./src/selection/grid/RowModel.mjs");












/**
 * @class Neo.examples.grid.container.MainContainer
 * @extends Neo.examples.ConfigurationViewport
 */
class MainContainer extends _ConfigurationViewport_mjs__WEBPACK_IMPORTED_MODULE_4__["default"] {
    static config = {
        className           : 'Neo.examples.grid.container.MainContainer',
        autoMount           : true,
        configItemLabelWidth: 130,
        configPanelFlex     : 1.5,
        exampleComponentFlex: 3,
        layout              : {ntype: 'hbox', align: 'stretch'}
    }

    createConfigurationComponents() {
        let me = this;

        const selectionModelRadioDefaults = {
            module        : _src_form_field_Radio_mjs__WEBPACK_IMPORTED_MODULE_9__["default"],
            hideValueLabel: false,
            labelText     : '',
            name          : 'selectionModel',
            width         : 350
        };

        return [{
            module   : _src_form_field_Number_mjs__WEBPACK_IMPORTED_MODULE_8__["default"],
            labelText: 'height',
            listeners: {change: me.onConfigChange.bind(me, 'height')},
            maxValue : 800,
            minValue : 225,
            stepSize : 5,
            value    : me.exampleComponent.height
        }, {
            ...selectionModelRadioDefaults,
            checked       : me.exampleComponent.selectionModel.ntype === 'selection-grid-cellmodel',
            labelText     : 'selectionModel',
            listeners     : {change: me.onRadioChange.bind(me, 'selectionModel', _src_selection_grid_CellModel_mjs__WEBPACK_IMPORTED_MODULE_2__["default"])},
            style         : {marginTop: '10px'},
            valueLabelText: 'Cell'
        }, {
            ...selectionModelRadioDefaults,
            checked       : me.exampleComponent.selectionModel.ntype === 'selection-grid-columnmodel',
            listeners     : {change: me.onRadioChange.bind(me, 'selectionModel', _src_selection_grid_ColumnModel_mjs__WEBPACK_IMPORTED_MODULE_5__["default"])},
            valueLabelText: 'Column'
        }, {
            ...selectionModelRadioDefaults,
            checked       : me.exampleComponent.selectionModel.ntype === 'selection-grid-rowmodel',
            listeners     : {change: me.onRadioChange.bind(me, 'selectionModel', _src_selection_grid_RowModel_mjs__WEBPACK_IMPORTED_MODULE_10__["default"])},
            valueLabelText: 'Row'
        }, {
            ...selectionModelRadioDefaults,
            checked       : me.exampleComponent.selectionModel.ntype === 'selection-grid-cellcolumnmodel',
            listeners     : {change: me.onRadioChange.bind(me, 'selectionModel', _src_selection_grid_CellColumnModel_mjs__WEBPACK_IMPORTED_MODULE_0__["default"])},
            valueLabelText: 'Cell & Column'
        }, {
            ...selectionModelRadioDefaults,
            checked       : me.exampleComponent.selectionModel.ntype === 'selection-grid-cellrowmodel',
            listeners     : {change: me.onRadioChange.bind(me, 'selectionModel', _src_selection_grid_CellRowModel_mjs__WEBPACK_IMPORTED_MODULE_3__["default"])},
            valueLabelText: 'Cell & Row'
        }, {
            ...selectionModelRadioDefaults,
            checked       : me.exampleComponent.selectionModel.ntype === 'selection-grid-cellcolumnrowmodel',
            listeners     : {change: me.onRadioChange.bind(me, 'selectionModel', _src_selection_grid_CellColumnRowModel_mjs__WEBPACK_IMPORTED_MODULE_1__["default"])},
            valueLabelText: 'Cell & Column & Row'
        }];
    }

    createExampleComponent() {
        return Neo.create(_src_grid_Container_mjs__WEBPACK_IMPORTED_MODULE_6__["default"], {
            selectionModel: _src_selection_grid_CellModel_mjs__WEBPACK_IMPORTED_MODULE_2__["default"],
            store         : _MainStore_mjs__WEBPACK_IMPORTED_MODULE_7__["default"],

            columnDefaults: {
                width: 200
            },

            columns: [
                {field: 'firstname', text: 'Firstname'},
                {field: 'lastname',  text: 'Lastname'},
                {field: 'githubId',  text: 'Github Id'},
                {field: 'country',   text: 'Country'}
            ]
        });
    }
}

Neo.applyClassConfig(MainContainer);

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (MainContainer);


/***/ }),

/***/ "./examples/grid/container/MainModel.mjs":
/*!***********************************************!*\
  !*** ./examples/grid/container/MainModel.mjs ***!
  \***********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _src_data_Model_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../src/data/Model.mjs */ "./src/data/Model.mjs");


/**
 * @class Neo.examples.grid.container.MainModel
 * @extends Neo.data.Model
 */
class MainModel extends _src_data_Model_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        className: 'Neo.examples.grid.container.MainModel',

        fields: [{
            name: 'country',
            type: 'String'
        }, {
            name: 'firstname',
            type: 'String'
        }, {
            name: 'githubId',
            type: 'String'
        }, {
            name: 'lastname',
            type: 'String'
        }]
    }
}

Neo.applyClassConfig(MainModel);

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (MainModel);


/***/ }),

/***/ "./examples/grid/container/MainStore.mjs":
/*!***********************************************!*\
  !*** ./examples/grid/container/MainStore.mjs ***!
  \***********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _src_data_Store_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../src/data/Store.mjs */ "./src/data/Store.mjs");
/* harmony import */ var _MainModel_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./MainModel.mjs */ "./examples/grid/container/MainModel.mjs");



/**
 * @class Neo.examples.grid.container.MainStore
 * @extends Neo.data.Store
 */
class MainStore extends _src_data_Store_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        className  : 'Neo.examples.grid.container.MainStore',
        keyProperty: 'githubId',
        model      : _MainModel_mjs__WEBPACK_IMPORTED_MODULE_1__["default"],

        data: [{
            country  : 'Germany',
            firstname: 'Tobias',
            githubId : 'tobiu',
            lastname : 'Uhlig'
        },
        {
            country  : 'USA',
            firstname: 'Rich',
            githubId : 'rwaters',
            lastname : 'Waters'
        },
        {
            country  : 'Germany',
            firstname: 'Nils',
            githubId : 'mrsunshine',
            lastname : 'Dehl'
        },
        {
            country  : 'USA',
            firstname: 'Gerard',
            githubId : 'camtnbikerrwc',
            lastname : 'Horan'
        },
        {
            country  : 'Slovakia',
            firstname: 'Jozef',
            githubId : 'jsakalos',
            lastname : 'Sakalos'
        },
        {
            country  : 'Germany',
            firstname: 'Bastian',
            githubId : 'bhaustein',
            lastname : 'Haustein'
        }]
    }
}

Neo.applyClassConfig(MainStore);

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (MainStore);


/***/ }),

/***/ "./examples/grid/container/app.mjs":
/*!*****************************************!*\
  !*** ./examples/grid/container/app.mjs ***!
  \*****************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   onStart: () => (/* binding */ onStart)
/* harmony export */ });
/* harmony import */ var _MainContainer_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./MainContainer.mjs */ "./examples/grid/container/MainContainer.mjs");


const onStart = () => Neo.app({
    mainView: _MainContainer_mjs__WEBPACK_IMPORTED_MODULE_0__["default"],
    name    : 'Neo.examples.grid.container'
});


/***/ }),

/***/ "./src/form/field/Radio.mjs":
/*!**********************************!*\
  !*** ./src/form/field/Radio.mjs ***!
  \**********************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _CheckBox_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./CheckBox.mjs */ "./src/form/field/CheckBox.mjs");
/* harmony import */ var _manager_Component_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../manager/Component.mjs */ "./src/manager/Component.mjs");



/**
 * @class Neo.form.field.Radio
 * @extends Neo.form.field.CheckBox
 */
class Radio extends _CheckBox_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        /**
         * @member {String} className='Neo.form.field.Radio'
         * @protected
         */
        className: 'Neo.form.field.Radio',
        /**
         * @member {String} ntype='radiofield'
         * @protected
         */
        ntype: 'radiofield',
        /**
         * @member {String[]} baseCls=['neo-radiofield','neo-checkboxfield']
         */
        baseCls: ['neo-radiofield', 'neo-checkboxfield'],
        /**
         * @member {String[]} iconCls=['far','fa-circle']
         */
        iconCls: ['far', 'fa-circle'],
        /**
         * @member {String} inputType='radio'
         */
        inputType: 'radio'
    }

    /**
     * Triggered after the checked config got changed
     * @param {Boolean} value
     * @param {Boolean} oldValue
     * @protected
     */
    afterSetChecked(value, oldValue) {
        super.afterSetChecked(value, oldValue);

        // update radios with the same name to be unchecked
        value && this.uncheckGroupItems()
    }

    /**
     * @returns {String|null}
     */
    getValue() {
        return this.checked ? this.value : undefined
    }

    /**
     * Radios do not fire a change event for "uncheck", so we need to iterate over other radios with the same name.
     */
    uncheckGroupItems() {
        let me = this,
            radios;

        // discuss: we could limit this to radios inside the same form, IF a top level form is used
        radios = _manager_Component_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].find({
            ntype: 'radiofield',
            name : me.name
        });

        radios.forEach(item => {
            if (item.id !== me.id && item._checked) {
                item.checked = false;
            }
        })
    }
}

Neo.applyClassConfig(Radio);

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Radio);


/***/ }),

/***/ "./src/selection/grid/CellColumnModel.mjs":
/*!************************************************!*\
  !*** ./src/selection/grid/CellColumnModel.mjs ***!
  \************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _CellModel_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./CellModel.mjs */ "./src/selection/grid/CellModel.mjs");
/* harmony import */ var _ColumnModel_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ColumnModel.mjs */ "./src/selection/grid/ColumnModel.mjs");
/* harmony import */ var _util_VDom_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../util/VDom.mjs */ "./src/util/VDom.mjs");




/**
 * @class Neo.selection.grid.CellColumnModel
 * @extends Neo.selection.grid.CellModel
 */
class CellColumnModel extends _CellModel_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        /**
         * @member {String} className='Neo.selection.grid.CellColumnModel'
         * @protected
         */
        className: 'Neo.selection.grid.CellColumnModel',
        /**
         * @member {String} ntype='selection-grid-cellcolumnmodel'
         * @protected
         */
        ntype: 'selection-grid-cellcolumnmodel',
        /**
         * @member {String} cls='neo-selection-cellcolumnmodel'
         * @protected
         */
        cls: 'neo-selection-cellcolumnmodel',
        /**
         * @member {String} selectedColumnCellCls='selected-column-cell'
         * @protected
         */
        selectedColumnCellCls: 'selected-column-cell',
        /**
         * @member {Array|null} selectedColumnCellIds=null
         * @protected
         */
        selectedColumnCellIds: null
    }

    /**
     * @param {Object} config
     */
    construct(config) {
        super.construct(config);

        this.selectedColumnCellIds = [];
    }

    /**
     * @param {Boolean} [silent] true to prevent a vdom update
     */
    deselectAllCells(silent) {
        let me      = this,
            cellIds = [...me.selectedColumnCellIds],
            view    = me.view;

        cellIds.forEach(cellId => {
            me.deselect(cellId, true, me.selectedColumnCellIds, me.selectedColumnCellCls);
        });

        !silent && view.update();
    }

    /**
     * @param {Object} data
     */
    onCellClick(data) {
        let me = this,
            id = _ColumnModel_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].getCellId(data.path),
            columnNodeIds, index, tbodyNode;

        if (id) {
            index         = _ColumnModel_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].getColumnIndex(id, me.view.items[0].items);
            tbodyNode     = _util_VDom_mjs__WEBPACK_IMPORTED_MODULE_2__["default"].findVdomChild(me.view.vdom, {cls: 'neo-grid-view'}).vdom;
            columnNodeIds = _util_VDom_mjs__WEBPACK_IMPORTED_MODULE_2__["default"].getColumnNodesIds(tbodyNode, index);

            me.deselectAllCells(true);
            me.select(columnNodeIds, me.selectedColumnCellIds, me.selectedColumnCellCls);
        }

        super.onCellClick(data);
    }

    /**
     * @param {Object} data
     * @param {Number} step
     */
    onNavKeyColumn(data, step) {
        let me            = this,
            idArray       = _ColumnModel_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].getCellId(data.path).split('__'),
            currentColumn = idArray[2],
            view          = me.view,
            fields        = view.columns.map(c => c.field),
            newIndex      = (fields.indexOf(currentColumn) + step) % fields.length,
            columnNodeIds, tbodyNode;

        while (newIndex < 0) {
            newIndex += fields.length;
        }

        tbodyNode     = _util_VDom_mjs__WEBPACK_IMPORTED_MODULE_2__["default"].findVdomChild(me.view.vdom, {cls: 'neo-grid-view'}).vdom;
        columnNodeIds = _util_VDom_mjs__WEBPACK_IMPORTED_MODULE_2__["default"].getColumnNodesIds(tbodyNode, newIndex);

        me.deselectAllCells(true);
        me.select(columnNodeIds, me.selectedColumnCellIds, me.selectedColumnCellCls);

        super.onNavKeyColumn(data, step);
    }

    /**
     *
     */
    unregister() {
        this.deselectAllCells();
        super.unregister();
    }
}

Neo.applyClassConfig(CellColumnModel);

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (CellColumnModel);


/***/ }),

/***/ "./src/selection/grid/CellColumnRowModel.mjs":
/*!***************************************************!*\
  !*** ./src/selection/grid/CellColumnRowModel.mjs ***!
  \***************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _CellRowModel_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./CellRowModel.mjs */ "./src/selection/grid/CellRowModel.mjs");
/* harmony import */ var _ColumnModel_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ColumnModel.mjs */ "./src/selection/grid/ColumnModel.mjs");
/* harmony import */ var _util_VDom_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../util/VDom.mjs */ "./src/util/VDom.mjs");




/**
 * @class Neo.selection.grid.CellColumnRowModel
 * @extends Neo.selection.grid.CellRowModel
 */
class CellColumnRowModel extends _CellRowModel_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        /**
         * @member {String} className='Neo.selection.grid.CellColumnRowModel'
         * @protected
         */
        className: 'Neo.selection.grid.CellColumnRowModel',
        /**
         * @member {String} ntype='selection-grid-cellcolumnrowmodel'
         * @protected
         */
        ntype: 'selection-grid-cellcolumnrowmodel',
        /**
         * @member {String} cls='neo-selection-cellcolumnrowmodel'
         * @protected
         */
        cls: 'neo-selection-cellcolumnrowmodel',
        /**
         * @member {String} selectedColumnCellCls='selected-column-cell'
         * @protected
         */
        selectedColumnCellCls: 'selected-column-cell',
        /**
         * @member {Array|null} selectedColumnCellIds=null
         * @protected
         */
        selectedColumnCellIds: null
    }

    /**
     * @param {Object} config
     */
    construct(config) {
        super.construct(config);

        this.selectedColumnCellIds = [];
    }

    /**
     * @param {Boolean} [silent] true to prevent a vdom update
     */
    deselectAllCells(silent) {
        let me      = this,
            cellIds = [...me.selectedColumnCellIds],
            view    = me.view;

        cellIds.forEach(cellId => {
            me.deselect(cellId, true, me.selectedColumnCellIds, me.selectedColumnCellCls);
        });

        !silent && view.update();
    }

    /**
     * @param {Object} data
     */
    onCellClick(data) {
        let me   = this,
            id   = _ColumnModel_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].getCellId(data.path),
            columnNodeIds, index, tbodyNode;

        if (id) {
            index         = _ColumnModel_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].getColumnIndex(id, me.view.items[0].items);
            tbodyNode     = _util_VDom_mjs__WEBPACK_IMPORTED_MODULE_2__["default"].findVdomChild(me.view.vdom, {cls: 'neo-grid-view'}).vdom;
            columnNodeIds = _util_VDom_mjs__WEBPACK_IMPORTED_MODULE_2__["default"].getColumnNodesIds(tbodyNode, index);

            me.deselectAllCells(true);
            me.select(columnNodeIds, me.selectedColumnCellIds, me.selectedColumnCellCls);
        }

        super.onCellClick(data);
    }

    /**
     * @param {Object} data
     * @param {Number} step
     */
    onNavKeyColumn(data, step) {
        let me            = this,
            idArray       = _ColumnModel_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].getCellId(data.path).split('__'),
            currentColumn = idArray[2],
            view          = me.view,
            fields        = view.columns.map(c => c.field),
            newIndex      = (fields.indexOf(currentColumn) + step) % fields.length,
            columnNodeIds, tbodyNode;

        while (newIndex < 0) {
            newIndex += fields.length;
        }

        tbodyNode     = _util_VDom_mjs__WEBPACK_IMPORTED_MODULE_2__["default"].findVdomChild(me.view.vdom, {cls: 'neo-grid-view'}).vdom;
        columnNodeIds = _util_VDom_mjs__WEBPACK_IMPORTED_MODULE_2__["default"].getColumnNodesIds(tbodyNode, newIndex);

        me.deselectAllCells(true);
        me.select(columnNodeIds, me.selectedColumnCellIds, me.selectedColumnCellCls);

        super.onNavKeyColumn(data, step);
    }

    /**
     *
     */
    unregister() {
        this.deselectAllCells();
        super.unregister();
    }
}

Neo.applyClassConfig(CellColumnRowModel);

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (CellColumnRowModel);


/***/ }),

/***/ "./src/selection/grid/CellModel.mjs":
/*!******************************************!*\
  !*** ./src/selection/grid/CellModel.mjs ***!
  \******************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _Model_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Model.mjs */ "./src/selection/Model.mjs");


/**
 * @class Neo.selection.grid.CellModel
 * @extends Neo.selection.Model
 */
class CellModel extends _Model_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        /**
         * @member {String} className='Neo.selection.grid.CellModel'
         * @protected
         */
        className: 'Neo.selection.grid.CellModel',
        /**
         * @member {String} ntype='selection-grid-cellmodel'
         * @protected
         */
        ntype: 'selection-grid-cellmodel',
        /**
         * @member {String} cls='selection-cellmodel'
         * @protected
         */
        cls: 'neo-selection-cellmodel'
    }

    /**
     *
     */
    addDomListener() {
        let me   = this,
            view = me.view;

        view.addDomListeners({
            click   : me.onCellClick,
            delegate: '.neo-grid-cell',
            scope   : me
        });
    }

    /**
     * @param {Object} data
     */
    onCellClick(data) {
        let me   = this,
            path = data.path,
            i    = 0,
            len  = path.length,
            id;

        for (; i < len; i++) {
            if (path[i].cls.includes('neo-grid-cell')) {
                id = path[i].id;
                break;
            }
        }

        id && me.toggleSelection(id);
    }

    /**
     * @param {Object} data
     */
    onKeyDownDown(data) {
        this.onNavKeyRow(data, 1);
    }

    /**
     * @param {Object} data
     */
    onKeyDownLeft(data) {
        this.onNavKeyColumn(data, -1);
    }

    /**
     * @param {Object} data
     */
    onKeyDownRight(data) {
        this.onNavKeyColumn(data, 1);
    }

    /**
     * @param {Object} data
     */
    onKeyDownUp(data) {
        this.onNavKeyRow(data, -1);
    }

    /**
     * @param {Object} data
     * @param {Number} step
     */
    onNavKeyColumn(data, step) {
        let me            = this,
            view          = me.view,
            idArray       = data.path[0].id.split('__'),
            currentColumn = idArray[2],
            dataFields    = view.columns.map(c => c.field),
            newIndex      = (dataFields.indexOf(currentColumn) + step) % dataFields.length,
            id;

        while (newIndex < 0) {
            newIndex += dataFields.length;
        }

        idArray[2] = dataFields[newIndex];
        id = idArray.join('__');

        me.select(id);
        view.focus(id);
    }

    /**
     * @param {Object} data
     * @param {Number} step
     */
    onNavKeyRow(data, step) {
        let me       = this,
            view     = me.view,
            store    = view.store,
            idArray  = data.path[0].id.split('__'),
            recordId = idArray[1],
            newIndex = (store.indexOf(recordId) + step) % store.getCount(),
            id;

        while (newIndex < 0) {
            newIndex += store.getCount();
        }

        idArray[1] = store.getKeyAt(newIndex);
        id = idArray.join('__');

        me.select(id);
        view.focus(id);
    }

    /**
     * @param {Neo.component.Base} component
     */
    register(component) {
        super.register(component);

        let me   = this,
            id   = me.id,
            view = me.view;

        view.keys?._keys.push(
            {fn: 'onKeyDownDown'  ,key: 'Down'  ,scope: id},
            {fn: 'onKeyDownLeft'  ,key: 'Left'  ,scope: id},
            {fn: 'onKeyDownRight' ,key: 'Right' ,scope: id},
            {fn: 'onKeyDownUp'    ,key: 'Up'    ,scope: id}
        );
    }

    /**
     *
     */
    unregister() {
        let me   = this,
            id   = me.id,
            view = me.view;

        view.keys?.removeKeys([
            {fn: 'onKeyDownDown'  ,key: 'Down'  ,scope: id},
            {fn: 'onKeyDownLeft'  ,key: 'Left'  ,scope: id},
            {fn: 'onKeyDownRight' ,key: 'Right' ,scope: id},
            {fn: 'onKeyDownUp'    ,key: 'Up'    ,scope: id}
        ]);

        super.unregister();
    }
}

Neo.applyClassConfig(CellModel);

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (CellModel);


/***/ }),

/***/ "./src/selection/grid/CellRowModel.mjs":
/*!*********************************************!*\
  !*** ./src/selection/grid/CellRowModel.mjs ***!
  \*********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _CellModel_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./CellModel.mjs */ "./src/selection/grid/CellModel.mjs");
/* harmony import */ var _util_Array_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../util/Array.mjs */ "./src/util/Array.mjs");
/* harmony import */ var _RowModel_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./RowModel.mjs */ "./src/selection/grid/RowModel.mjs");
/* harmony import */ var _util_VDom_mjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../util/VDom.mjs */ "./src/util/VDom.mjs");





/**
 * @class Neo.selection.grid.CellRowModel
 * @extends Neo.selection.grid.CellModel
 */
class CellRowModel extends _CellModel_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        /**
         * @member {String} className='Neo.selection.grid.CellRowModel'
         * @protected
         */
        className: 'Neo.selection.grid.CellRowModel',
        /**
         * @member {String} ntype='selection-grid-cellrowmodel'
         * @protected
         */
        ntype: 'selection-grid-cellrowmodel',
        /**
         * @member {String} cls='neo-selection-cellrowmodel'
         * @protected
         */
        cls: 'neo-selection-cellrowmodel',
        /**
         * @member {Array|null} selectedRowIds=null
         * @protected
         */
        selectedRowIds: null
    }

    /**
     * @param {Object} config
     */
    construct(config) {
        super.construct(config);

        this.selectedRowIds = [];
    }

    /**
     * @param {Boolean} [silent] true to prevent a vdom update
     */
    deselectAllRows(silent) {
        let me     = this,
            rowIds = [...me.selectedRowIds],
            view   = me.view;

        rowIds.forEach(rowId => {
            me.deselectRow(rowId, true);
        });

        !silent && view.update();
    }

    /**
     * @param {String} rowId
     * @param {Boolean} [silent] true to prevent a vdom update
     */
    deselectRow(rowId, silent) {
        let me   = this,
            view = me.view,
            node = view.getVdomChild(rowId),
            cls;

        if (node) {
            cls = node.cls || [];
            _util_Array_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].remove(cls, me.selectedCls);
            node.cls = cls;
        }

        _util_Array_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].remove(me.selectedRowIds, rowId);

        !silent && view.update();
    }

    /**
     * @param {Object} data
     */
    onCellClick(data) {
        let me   = this,
            node = _RowModel_mjs__WEBPACK_IMPORTED_MODULE_2__["default"].getRowNode(data.path), // we could add a separate export for this method
            id   = node?.id;

        if (id) {
            me.deselectAllRows(true);
            me.selectRow(id);
        }

        super.onCellClick(data);
    }

    /**
     * @param {Object} data
     * @param {Number} step
     */
    onNavKeyRow(data, step) {
        super.onNavKeyRow(data, step);

        let me         = this,
            node       = _RowModel_mjs__WEBPACK_IMPORTED_MODULE_2__["default"].getRowNode(data.path),
            view       = me.view,
            store      = view.store,
            vdomNode   = _util_VDom_mjs__WEBPACK_IMPORTED_MODULE_3__["default"].findVdomChild(view.vdom, node.id),
            newIndex   = (vdomNode.index + step) % store.getCount(),
            parentNode = vdomNode.parentNode,
            id;

        while (newIndex < 0) {
            newIndex += store.getCount();
        }

        id = parentNode.cn[newIndex].id;

        if (id) {
            me.deselectAllRows(true);
            me.selectRow(id);
        }
    }

    /**
     * @param {String} id
     * @param {Boolean} [silent]
     */
    selectRow(id, silent) {
        let me       = this,
            view     = me.view,
            vdomNode = id && view.getVdomChild(id),
            cls;

        if (vdomNode) {
            cls = vdomNode.cls || [];
            _util_Array_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].add(cls, me.selectedCls);
            vdomNode.cls = cls;

            me.selectedRowIds.push(id);
        }

        !silent && view.update();
    }

    /**
     *
     */
    unregister() {
        this.deselectAllRows();
        super.unregister();
    }
}

Neo.applyClassConfig(CellRowModel);

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (CellRowModel);


/***/ }),

/***/ "./src/selection/grid/ColumnModel.mjs":
/*!********************************************!*\
  !*** ./src/selection/grid/ColumnModel.mjs ***!
  \********************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _Model_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Model.mjs */ "./src/selection/Model.mjs");
/* harmony import */ var _util_VDom_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../util/VDom.mjs */ "./src/util/VDom.mjs");



/**
 * @class Neo.selection.grid.ColumnModel
 * @extends Neo.selection.Model
 */
class ColumnModel extends _Model_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        /**
         * @member {String} className='Neo.selection.grid.ColumnModel'
         * @protected
         */
        className: 'Neo.selection.grid.ColumnModel',
        /**
         * @member {String} ntype='selection-grid-columnmodel'
         * @protected
         */
        ntype: 'selection-grid-columnmodel',
        /**
         * @member {String} cls='selection-columnmodel'
         * @protected
         */
        cls: 'neo-selection-columnmodel'
    }

    /**
     *
     */
    addDomListener() {
        let me   = this,
            view = me.view;

        view.addDomListeners({
            click   : me.onCellClick,
            delegate: '.neo-grid-cell',
            scope   : me
        });
    }

    /**
     * @param {Object} eventPath
     * @returns {String|null} cellId
     */
    static getCellId(eventPath) {
        let id   = null,
            i    = 0,
            len  = eventPath.length;

        for (; i < len; i++) {
            if (eventPath[i].cls.includes('neo-grid-cell')) {
                id = eventPath[i].id;
                break;
            }
        }

        return id;
    }

    /**
     * todo: move to grid.Container or view
     * @param {String} cellId
     * @param {Object[]} columns
     * @returns {Number} index
     */
    static getColumnIndex(cellId, columns) {
        let idArray       = cellId.split('__'),
            currentColumn = idArray[2],
            dataFields    = columns.map(c => c.field);

        return dataFields.indexOf(currentColumn);
    }

    /**
     * @param {Object} data
     */
    onCellClick(data) {
        let me = this,
            id = ColumnModel.getCellId(data.path),
            columnNodeIds, index, tbodyNode;

        if (id) {
            index         = ColumnModel.getColumnIndex(id, me.view.items[0].items);
            tbodyNode     = _util_VDom_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].findVdomChild(me.view.vdom, {cls: 'neo-grid-view'}).vdom;
            columnNodeIds = _util_VDom_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].getColumnNodesIds(tbodyNode, index);

            me.select(columnNodeIds);
        }
    }

    /**
     * @param {Object} data
     */
    onKeyDownLeft(data) {
        this.onNavKeyColumn(data, -1);
    }

    /**
     * @param {Object} data
     */
    onKeyDownRight(data) {
        this.onNavKeyColumn(data, 1);
    }

    /**
     * @param {Object} data
     * @param {Number} step
     */
    onNavKeyColumn(data, step) {
        let me            = this,
            idArray       = ColumnModel.getCellId(data.path).split('__'),
            currentColumn = idArray[2],
            view          = me.view,
            fields        = view.columns.map(c => c.field),
            newIndex      = (fields.indexOf(currentColumn) + step) % fields.length,
            columnNodeIds, id, tbodyNode;

        while (newIndex < 0) {
            newIndex += fields.length;
        }

        idArray[2] = fields[newIndex];
        id = idArray.join('__');

        tbodyNode     = _util_VDom_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].findVdomChild(me.view.vdom, {cls: 'neo-grid-view'}).vdom;
        columnNodeIds = _util_VDom_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].getColumnNodesIds(tbodyNode, newIndex);

        me.select(columnNodeIds);
        view.focus(id); // we have to focus one cell to ensure the keynav keeps working
    }

    /**
     * @param {Neo.component.Base} component
     */
    register(component) {
        super.register(component);

        let me   = this,
            id   = me.id,
            view = me.view;

        view.keys?._keys.push({
            fn   : 'onKeyDownLeft',
            key  : 'Left',
            scope: id
        }, {
            fn   : 'onKeyDownRight',
            key  : 'Right',
            scope: id
        });
    }


    /**
     *
     */
    unregister() {
        let me   = this,
            id   = me.id,
            view = me.view;

        view.keys?.removeKeys([{
            fn   : 'onKeyDownLeft',
            key  : 'Left',
            scope: id
        }, {
            fn   : 'onKeyDownRight',
            key  : 'Right',
            scope: id
        }]);

        super.unregister();
    }
}

Neo.applyClassConfig(ColumnModel);

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (ColumnModel);


/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2h1bmtzL2FwcC92ZW5kb3JzLWV4YW1wbGVzX2dyaWRfY29udGFpbmVyX2FwcF9tanMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQW9GO0FBQ0c7QUFDVDtBQUNHO0FBQ2I7QUFDWTtBQUNaO0FBQ2hCO0FBQ21CO0FBQ0Q7QUFDTzs7QUFFN0U7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsa0VBQXFCO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQjtBQUMvQjs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsNEJBQTRCLGlFQUFLO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSx1QkFBdUIsa0VBQVc7QUFDbEM7QUFDQSx3QkFBd0IsNkNBQTZDO0FBQ3JFO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QixvREFBb0QseUVBQVMsRUFBRTtBQUM1Riw2QkFBNkIsa0JBQWtCO0FBQy9DO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSw2QkFBNkIsb0RBQW9ELDJFQUFXLEVBQUU7QUFDOUY7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLDZCQUE2QixvREFBb0QseUVBQVEsRUFBRTtBQUMzRjtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsNkJBQTZCLG9EQUFvRCwrRUFBZSxFQUFFO0FBQ2xHO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSw2QkFBNkIsb0RBQW9ELDRFQUFZLEVBQUU7QUFDL0Y7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLDZCQUE2QixvREFBb0Qsa0ZBQWtCLEVBQUU7QUFDckc7QUFDQSxTQUFTO0FBQ1Q7O0FBRUE7QUFDQSwwQkFBMEIsK0RBQWE7QUFDdkMsNEJBQTRCLHlFQUFTO0FBQ3JDLDRCQUE0QixzREFBUzs7QUFFckM7QUFDQTtBQUNBLGFBQWE7O0FBRWI7QUFDQSxpQkFBaUIsc0NBQXNDO0FBQ3ZELGlCQUFpQixxQ0FBcUM7QUFD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QUFRO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLDRCQUE0QixvRUFBc0IsZ0JBQWdCLHFCQUFxQjtBQUN2Riw0QkFBNEIsd0VBQTBCOztBQUV0RDtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxlQUFlLFFBQVE7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxlQUFlLFFBQVE7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxlQUFlLFFBQVE7QUFDdkIsZUFBZSxRQUFRO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQSx3QkFBd0Isb0VBQXNCLGdCQUFnQixxQkFBcUI7QUFDbkYsd0JBQXdCLHdFQUEwQjs7QUFFbEQ7QUFDQSx3QkFBd0I7QUFDeEI7O0FBRUE7QUFDQSxlQUFlLG9CQUFvQjtBQUNuQztBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBO0FBQ0E7O0FBRUE7O0FBRUEsaUVBQWUsV0FBVyxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmVvLm1qcy8uL2V4YW1wbGVzL2dyaWQvY29udGFpbmVyL01haW5Db250YWluZXIubWpzIiwid2VicGFjazovL25lby5tanMvLi9leGFtcGxlcy9ncmlkL2NvbnRhaW5lci9NYWluTW9kZWwubWpzIiwid2VicGFjazovL25lby5tanMvLi9leGFtcGxlcy9ncmlkL2NvbnRhaW5lci9NYWluU3RvcmUubWpzIiwid2VicGFjazovL25lby5tanMvLi9leGFtcGxlcy9ncmlkL2NvbnRhaW5lci9hcHAubWpzIiwid2VicGFjazovL25lby5tanMvLi9zcmMvZm9ybS9maWVsZC9SYWRpby5tanMiLCJ3ZWJwYWNrOi8vbmVvLm1qcy8uL3NyYy9zZWxlY3Rpb24vZ3JpZC9DZWxsQ29sdW1uTW9kZWwubWpzIiwid2VicGFjazovL25lby5tanMvLi9zcmMvc2VsZWN0aW9uL2dyaWQvQ2VsbENvbHVtblJvd01vZGVsLm1qcyIsIndlYnBhY2s6Ly9uZW8ubWpzLy4vc3JjL3NlbGVjdGlvbi9ncmlkL0NlbGxNb2RlbC5tanMiLCJ3ZWJwYWNrOi8vbmVvLm1qcy8uL3NyYy9zZWxlY3Rpb24vZ3JpZC9DZWxsUm93TW9kZWwubWpzIiwid2VicGFjazovL25lby5tanMvLi9zcmMvc2VsZWN0aW9uL2dyaWQvQ29sdW1uTW9kZWwubWpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBDZWxsQ29sdW1uTW9kZWwgICAgICAgZnJvbSAnLi4vLi4vLi4vc3JjL3NlbGVjdGlvbi9ncmlkL0NlbGxDb2x1bW5Nb2RlbC5tanMnO1xuaW1wb3J0IENlbGxDb2x1bW5Sb3dNb2RlbCAgICBmcm9tICcuLi8uLi8uLi9zcmMvc2VsZWN0aW9uL2dyaWQvQ2VsbENvbHVtblJvd01vZGVsLm1qcyc7XG5pbXBvcnQgQ2VsbE1vZGVsICAgICAgICAgICAgIGZyb20gJy4uLy4uLy4uL3NyYy9zZWxlY3Rpb24vZ3JpZC9DZWxsTW9kZWwubWpzJztcbmltcG9ydCBDZWxsUm93TW9kZWwgICAgICAgICAgZnJvbSAnLi4vLi4vLi4vc3JjL3NlbGVjdGlvbi9ncmlkL0NlbGxSb3dNb2RlbC5tanMnO1xuaW1wb3J0IENvbmZpZ3VyYXRpb25WaWV3cG9ydCBmcm9tICcuLi8uLi9Db25maWd1cmF0aW9uVmlld3BvcnQubWpzJztcbmltcG9ydCBDb2x1bW5Nb2RlbCAgICAgICAgICAgZnJvbSAnLi4vLi4vLi4vc3JjL3NlbGVjdGlvbi9ncmlkL0NvbHVtbk1vZGVsLm1qcyc7XG5pbXBvcnQgR3JpZENvbnRhaW5lciAgICAgICAgIGZyb20gJy4uLy4uLy4uL3NyYy9ncmlkL0NvbnRhaW5lci5tanMnO1xuaW1wb3J0IE1haW5TdG9yZSAgICAgICAgICAgICBmcm9tICcuL01haW5TdG9yZS5tanMnO1xuaW1wb3J0IE51bWJlckZpZWxkICAgICAgICAgICBmcm9tICcuLi8uLi8uLi9zcmMvZm9ybS9maWVsZC9OdW1iZXIubWpzJztcbmltcG9ydCBSYWRpbyAgICAgICAgICAgICAgICAgZnJvbSAnLi4vLi4vLi4vc3JjL2Zvcm0vZmllbGQvUmFkaW8ubWpzJztcbmltcG9ydCBSb3dNb2RlbCAgICAgICAgICAgICAgZnJvbSAnLi4vLi4vLi4vc3JjL3NlbGVjdGlvbi9ncmlkL1Jvd01vZGVsLm1qcyc7XG5cbi8qKlxuICogQGNsYXNzIE5lby5leGFtcGxlcy5ncmlkLmNvbnRhaW5lci5NYWluQ29udGFpbmVyXG4gKiBAZXh0ZW5kcyBOZW8uZXhhbXBsZXMuQ29uZmlndXJhdGlvblZpZXdwb3J0XG4gKi9cbmNsYXNzIE1haW5Db250YWluZXIgZXh0ZW5kcyBDb25maWd1cmF0aW9uVmlld3BvcnQge1xuICAgIHN0YXRpYyBjb25maWcgPSB7XG4gICAgICAgIGNsYXNzTmFtZSAgICAgICAgICAgOiAnTmVvLmV4YW1wbGVzLmdyaWQuY29udGFpbmVyLk1haW5Db250YWluZXInLFxuICAgICAgICBhdXRvTW91bnQgICAgICAgICAgIDogdHJ1ZSxcbiAgICAgICAgY29uZmlnSXRlbUxhYmVsV2lkdGg6IDEzMCxcbiAgICAgICAgY29uZmlnUGFuZWxGbGV4ICAgICA6IDEuNSxcbiAgICAgICAgZXhhbXBsZUNvbXBvbmVudEZsZXg6IDMsXG4gICAgICAgIGxheW91dCAgICAgICAgICAgICAgOiB7bnR5cGU6ICdoYm94JywgYWxpZ246ICdzdHJldGNoJ31cbiAgICB9XG5cbiAgICBjcmVhdGVDb25maWd1cmF0aW9uQ29tcG9uZW50cygpIHtcbiAgICAgICAgbGV0IG1lID0gdGhpcztcblxuICAgICAgICBjb25zdCBzZWxlY3Rpb25Nb2RlbFJhZGlvRGVmYXVsdHMgPSB7XG4gICAgICAgICAgICBtb2R1bGUgICAgICAgIDogUmFkaW8sXG4gICAgICAgICAgICBoaWRlVmFsdWVMYWJlbDogZmFsc2UsXG4gICAgICAgICAgICBsYWJlbFRleHQgICAgIDogJycsXG4gICAgICAgICAgICBuYW1lICAgICAgICAgIDogJ3NlbGVjdGlvbk1vZGVsJyxcbiAgICAgICAgICAgIHdpZHRoICAgICAgICAgOiAzNTBcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gW3tcbiAgICAgICAgICAgIG1vZHVsZSAgIDogTnVtYmVyRmllbGQsXG4gICAgICAgICAgICBsYWJlbFRleHQ6ICdoZWlnaHQnLFxuICAgICAgICAgICAgbGlzdGVuZXJzOiB7Y2hhbmdlOiBtZS5vbkNvbmZpZ0NoYW5nZS5iaW5kKG1lLCAnaGVpZ2h0Jyl9LFxuICAgICAgICAgICAgbWF4VmFsdWUgOiA4MDAsXG4gICAgICAgICAgICBtaW5WYWx1ZSA6IDIyNSxcbiAgICAgICAgICAgIHN0ZXBTaXplIDogNSxcbiAgICAgICAgICAgIHZhbHVlICAgIDogbWUuZXhhbXBsZUNvbXBvbmVudC5oZWlnaHRcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgLi4uc2VsZWN0aW9uTW9kZWxSYWRpb0RlZmF1bHRzLFxuICAgICAgICAgICAgY2hlY2tlZCAgICAgICA6IG1lLmV4YW1wbGVDb21wb25lbnQuc2VsZWN0aW9uTW9kZWwubnR5cGUgPT09ICdzZWxlY3Rpb24tZ3JpZC1jZWxsbW9kZWwnLFxuICAgICAgICAgICAgbGFiZWxUZXh0ICAgICA6ICdzZWxlY3Rpb25Nb2RlbCcsXG4gICAgICAgICAgICBsaXN0ZW5lcnMgICAgIDoge2NoYW5nZTogbWUub25SYWRpb0NoYW5nZS5iaW5kKG1lLCAnc2VsZWN0aW9uTW9kZWwnLCBDZWxsTW9kZWwpfSxcbiAgICAgICAgICAgIHN0eWxlICAgICAgICAgOiB7bWFyZ2luVG9wOiAnMTBweCd9LFxuICAgICAgICAgICAgdmFsdWVMYWJlbFRleHQ6ICdDZWxsJ1xuICAgICAgICB9LCB7XG4gICAgICAgICAgICAuLi5zZWxlY3Rpb25Nb2RlbFJhZGlvRGVmYXVsdHMsXG4gICAgICAgICAgICBjaGVja2VkICAgICAgIDogbWUuZXhhbXBsZUNvbXBvbmVudC5zZWxlY3Rpb25Nb2RlbC5udHlwZSA9PT0gJ3NlbGVjdGlvbi1ncmlkLWNvbHVtbm1vZGVsJyxcbiAgICAgICAgICAgIGxpc3RlbmVycyAgICAgOiB7Y2hhbmdlOiBtZS5vblJhZGlvQ2hhbmdlLmJpbmQobWUsICdzZWxlY3Rpb25Nb2RlbCcsIENvbHVtbk1vZGVsKX0sXG4gICAgICAgICAgICB2YWx1ZUxhYmVsVGV4dDogJ0NvbHVtbidcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgLi4uc2VsZWN0aW9uTW9kZWxSYWRpb0RlZmF1bHRzLFxuICAgICAgICAgICAgY2hlY2tlZCAgICAgICA6IG1lLmV4YW1wbGVDb21wb25lbnQuc2VsZWN0aW9uTW9kZWwubnR5cGUgPT09ICdzZWxlY3Rpb24tZ3JpZC1yb3dtb2RlbCcsXG4gICAgICAgICAgICBsaXN0ZW5lcnMgICAgIDoge2NoYW5nZTogbWUub25SYWRpb0NoYW5nZS5iaW5kKG1lLCAnc2VsZWN0aW9uTW9kZWwnLCBSb3dNb2RlbCl9LFxuICAgICAgICAgICAgdmFsdWVMYWJlbFRleHQ6ICdSb3cnXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIC4uLnNlbGVjdGlvbk1vZGVsUmFkaW9EZWZhdWx0cyxcbiAgICAgICAgICAgIGNoZWNrZWQgICAgICAgOiBtZS5leGFtcGxlQ29tcG9uZW50LnNlbGVjdGlvbk1vZGVsLm50eXBlID09PSAnc2VsZWN0aW9uLWdyaWQtY2VsbGNvbHVtbm1vZGVsJyxcbiAgICAgICAgICAgIGxpc3RlbmVycyAgICAgOiB7Y2hhbmdlOiBtZS5vblJhZGlvQ2hhbmdlLmJpbmQobWUsICdzZWxlY3Rpb25Nb2RlbCcsIENlbGxDb2x1bW5Nb2RlbCl9LFxuICAgICAgICAgICAgdmFsdWVMYWJlbFRleHQ6ICdDZWxsICYgQ29sdW1uJ1xuICAgICAgICB9LCB7XG4gICAgICAgICAgICAuLi5zZWxlY3Rpb25Nb2RlbFJhZGlvRGVmYXVsdHMsXG4gICAgICAgICAgICBjaGVja2VkICAgICAgIDogbWUuZXhhbXBsZUNvbXBvbmVudC5zZWxlY3Rpb25Nb2RlbC5udHlwZSA9PT0gJ3NlbGVjdGlvbi1ncmlkLWNlbGxyb3dtb2RlbCcsXG4gICAgICAgICAgICBsaXN0ZW5lcnMgICAgIDoge2NoYW5nZTogbWUub25SYWRpb0NoYW5nZS5iaW5kKG1lLCAnc2VsZWN0aW9uTW9kZWwnLCBDZWxsUm93TW9kZWwpfSxcbiAgICAgICAgICAgIHZhbHVlTGFiZWxUZXh0OiAnQ2VsbCAmIFJvdydcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgLi4uc2VsZWN0aW9uTW9kZWxSYWRpb0RlZmF1bHRzLFxuICAgICAgICAgICAgY2hlY2tlZCAgICAgICA6IG1lLmV4YW1wbGVDb21wb25lbnQuc2VsZWN0aW9uTW9kZWwubnR5cGUgPT09ICdzZWxlY3Rpb24tZ3JpZC1jZWxsY29sdW1ucm93bW9kZWwnLFxuICAgICAgICAgICAgbGlzdGVuZXJzICAgICA6IHtjaGFuZ2U6IG1lLm9uUmFkaW9DaGFuZ2UuYmluZChtZSwgJ3NlbGVjdGlvbk1vZGVsJywgQ2VsbENvbHVtblJvd01vZGVsKX0sXG4gICAgICAgICAgICB2YWx1ZUxhYmVsVGV4dDogJ0NlbGwgJiBDb2x1bW4gJiBSb3cnXG4gICAgICAgIH1dO1xuICAgIH1cblxuICAgIGNyZWF0ZUV4YW1wbGVDb21wb25lbnQoKSB7XG4gICAgICAgIHJldHVybiBOZW8uY3JlYXRlKEdyaWRDb250YWluZXIsIHtcbiAgICAgICAgICAgIHNlbGVjdGlvbk1vZGVsOiBDZWxsTW9kZWwsXG4gICAgICAgICAgICBzdG9yZSAgICAgICAgIDogTWFpblN0b3JlLFxuXG4gICAgICAgICAgICBjb2x1bW5EZWZhdWx0czoge1xuICAgICAgICAgICAgICAgIHdpZHRoOiAyMDBcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIGNvbHVtbnM6IFtcbiAgICAgICAgICAgICAgICB7ZmllbGQ6ICdmaXJzdG5hbWUnLCB0ZXh0OiAnRmlyc3RuYW1lJ30sXG4gICAgICAgICAgICAgICAge2ZpZWxkOiAnbGFzdG5hbWUnLCAgdGV4dDogJ0xhc3RuYW1lJ30sXG4gICAgICAgICAgICAgICAge2ZpZWxkOiAnZ2l0aHViSWQnLCAgdGV4dDogJ0dpdGh1YiBJZCd9LFxuICAgICAgICAgICAgICAgIHtmaWVsZDogJ2NvdW50cnknLCAgIHRleHQ6ICdDb3VudHJ5J31cbiAgICAgICAgICAgIF1cbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG5OZW8uYXBwbHlDbGFzc0NvbmZpZyhNYWluQ29udGFpbmVyKTtcblxuZXhwb3J0IGRlZmF1bHQgTWFpbkNvbnRhaW5lcjtcbiIsImltcG9ydCBNb2RlbCAgZnJvbSAnLi4vLi4vLi4vc3JjL2RhdGEvTW9kZWwubWpzJztcblxuLyoqXG4gKiBAY2xhc3MgTmVvLmV4YW1wbGVzLmdyaWQuY29udGFpbmVyLk1haW5Nb2RlbFxuICogQGV4dGVuZHMgTmVvLmRhdGEuTW9kZWxcbiAqL1xuY2xhc3MgTWFpbk1vZGVsIGV4dGVuZHMgTW9kZWwge1xuICAgIHN0YXRpYyBjb25maWcgPSB7XG4gICAgICAgIGNsYXNzTmFtZTogJ05lby5leGFtcGxlcy5ncmlkLmNvbnRhaW5lci5NYWluTW9kZWwnLFxuXG4gICAgICAgIGZpZWxkczogW3tcbiAgICAgICAgICAgIG5hbWU6ICdjb3VudHJ5JyxcbiAgICAgICAgICAgIHR5cGU6ICdTdHJpbmcnXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIG5hbWU6ICdmaXJzdG5hbWUnLFxuICAgICAgICAgICAgdHlwZTogJ1N0cmluZydcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgbmFtZTogJ2dpdGh1YklkJyxcbiAgICAgICAgICAgIHR5cGU6ICdTdHJpbmcnXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIG5hbWU6ICdsYXN0bmFtZScsXG4gICAgICAgICAgICB0eXBlOiAnU3RyaW5nJ1xuICAgICAgICB9XVxuICAgIH1cbn1cblxuTmVvLmFwcGx5Q2xhc3NDb25maWcoTWFpbk1vZGVsKTtcblxuZXhwb3J0IGRlZmF1bHQgTWFpbk1vZGVsO1xuIiwiaW1wb3J0IFN0b3JlIGZyb20gJy4uLy4uLy4uL3NyYy9kYXRhL1N0b3JlLm1qcyc7XG5pbXBvcnQgTW9kZWwgZnJvbSAnLi9NYWluTW9kZWwubWpzJztcblxuLyoqXG4gKiBAY2xhc3MgTmVvLmV4YW1wbGVzLmdyaWQuY29udGFpbmVyLk1haW5TdG9yZVxuICogQGV4dGVuZHMgTmVvLmRhdGEuU3RvcmVcbiAqL1xuY2xhc3MgTWFpblN0b3JlIGV4dGVuZHMgU3RvcmUge1xuICAgIHN0YXRpYyBjb25maWcgPSB7XG4gICAgICAgIGNsYXNzTmFtZSAgOiAnTmVvLmV4YW1wbGVzLmdyaWQuY29udGFpbmVyLk1haW5TdG9yZScsXG4gICAgICAgIGtleVByb3BlcnR5OiAnZ2l0aHViSWQnLFxuICAgICAgICBtb2RlbCAgICAgIDogTW9kZWwsXG5cbiAgICAgICAgZGF0YTogW3tcbiAgICAgICAgICAgIGNvdW50cnkgIDogJ0dlcm1hbnknLFxuICAgICAgICAgICAgZmlyc3RuYW1lOiAnVG9iaWFzJyxcbiAgICAgICAgICAgIGdpdGh1YklkIDogJ3RvYml1JyxcbiAgICAgICAgICAgIGxhc3RuYW1lIDogJ1VobGlnJ1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBjb3VudHJ5ICA6ICdVU0EnLFxuICAgICAgICAgICAgZmlyc3RuYW1lOiAnUmljaCcsXG4gICAgICAgICAgICBnaXRodWJJZCA6ICdyd2F0ZXJzJyxcbiAgICAgICAgICAgIGxhc3RuYW1lIDogJ1dhdGVycydcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgY291bnRyeSAgOiAnR2VybWFueScsXG4gICAgICAgICAgICBmaXJzdG5hbWU6ICdOaWxzJyxcbiAgICAgICAgICAgIGdpdGh1YklkIDogJ21yc3Vuc2hpbmUnLFxuICAgICAgICAgICAgbGFzdG5hbWUgOiAnRGVobCdcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgICAgY291bnRyeSAgOiAnVVNBJyxcbiAgICAgICAgICAgIGZpcnN0bmFtZTogJ0dlcmFyZCcsXG4gICAgICAgICAgICBnaXRodWJJZCA6ICdjYW10bmJpa2VycndjJyxcbiAgICAgICAgICAgIGxhc3RuYW1lIDogJ0hvcmFuJ1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBjb3VudHJ5ICA6ICdTbG92YWtpYScsXG4gICAgICAgICAgICBmaXJzdG5hbWU6ICdKb3plZicsXG4gICAgICAgICAgICBnaXRodWJJZCA6ICdqc2FrYWxvcycsXG4gICAgICAgICAgICBsYXN0bmFtZSA6ICdTYWthbG9zJ1xuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgICBjb3VudHJ5ICA6ICdHZXJtYW55JyxcbiAgICAgICAgICAgIGZpcnN0bmFtZTogJ0Jhc3RpYW4nLFxuICAgICAgICAgICAgZ2l0aHViSWQgOiAnYmhhdXN0ZWluJyxcbiAgICAgICAgICAgIGxhc3RuYW1lIDogJ0hhdXN0ZWluJ1xuICAgICAgICB9XVxuICAgIH1cbn1cblxuTmVvLmFwcGx5Q2xhc3NDb25maWcoTWFpblN0b3JlKTtcblxuZXhwb3J0IGRlZmF1bHQgTWFpblN0b3JlO1xuIiwiaW1wb3J0IE1haW5Db250YWluZXIgZnJvbSAnLi9NYWluQ29udGFpbmVyLm1qcyc7XG5cbmV4cG9ydCBjb25zdCBvblN0YXJ0ID0gKCkgPT4gTmVvLmFwcCh7XG4gICAgbWFpblZpZXc6IE1haW5Db250YWluZXIsXG4gICAgbmFtZSAgICA6ICdOZW8uZXhhbXBsZXMuZ3JpZC5jb250YWluZXInXG59KTtcbiIsImltcG9ydCBDaGVja0JveCAgICAgICAgIGZyb20gJy4vQ2hlY2tCb3gubWpzJztcbmltcG9ydCBDb21wb25lbnRNYW5hZ2VyIGZyb20gJy4uLy4uL21hbmFnZXIvQ29tcG9uZW50Lm1qcyc7XG5cbi8qKlxuICogQGNsYXNzIE5lby5mb3JtLmZpZWxkLlJhZGlvXG4gKiBAZXh0ZW5kcyBOZW8uZm9ybS5maWVsZC5DaGVja0JveFxuICovXG5jbGFzcyBSYWRpbyBleHRlbmRzIENoZWNrQm94IHtcbiAgICBzdGF0aWMgY29uZmlnID0ge1xuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfSBjbGFzc05hbWU9J05lby5mb3JtLmZpZWxkLlJhZGlvJ1xuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICBjbGFzc05hbWU6ICdOZW8uZm9ybS5maWVsZC5SYWRpbycsXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtTdHJpbmd9IG50eXBlPSdyYWRpb2ZpZWxkJ1xuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICBudHlwZTogJ3JhZGlvZmllbGQnLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nW119IGJhc2VDbHM9WyduZW8tcmFkaW9maWVsZCcsJ25lby1jaGVja2JveGZpZWxkJ11cbiAgICAgICAgICovXG4gICAgICAgIGJhc2VDbHM6IFsnbmVvLXJhZGlvZmllbGQnLCAnbmVvLWNoZWNrYm94ZmllbGQnXSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge1N0cmluZ1tdfSBpY29uQ2xzPVsnZmFyJywnZmEtY2lyY2xlJ11cbiAgICAgICAgICovXG4gICAgICAgIGljb25DbHM6IFsnZmFyJywgJ2ZhLWNpcmNsZSddLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfSBpbnB1dFR5cGU9J3JhZGlvJ1xuICAgICAgICAgKi9cbiAgICAgICAgaW5wdXRUeXBlOiAncmFkaW8nXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVHJpZ2dlcmVkIGFmdGVyIHRoZSBjaGVja2VkIGNvbmZpZyBnb3QgY2hhbmdlZFxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gdmFsdWVcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IG9sZFZhbHVlXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIGFmdGVyU2V0Q2hlY2tlZCh2YWx1ZSwgb2xkVmFsdWUpIHtcbiAgICAgICAgc3VwZXIuYWZ0ZXJTZXRDaGVja2VkKHZhbHVlLCBvbGRWYWx1ZSk7XG5cbiAgICAgICAgLy8gdXBkYXRlIHJhZGlvcyB3aXRoIHRoZSBzYW1lIG5hbWUgdG8gYmUgdW5jaGVja2VkXG4gICAgICAgIHZhbHVlICYmIHRoaXMudW5jaGVja0dyb3VwSXRlbXMoKVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEByZXR1cm5zIHtTdHJpbmd8bnVsbH1cbiAgICAgKi9cbiAgICBnZXRWYWx1ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2hlY2tlZCA/IHRoaXMudmFsdWUgOiB1bmRlZmluZWRcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSYWRpb3MgZG8gbm90IGZpcmUgYSBjaGFuZ2UgZXZlbnQgZm9yIFwidW5jaGVja1wiLCBzbyB3ZSBuZWVkIHRvIGl0ZXJhdGUgb3ZlciBvdGhlciByYWRpb3Mgd2l0aCB0aGUgc2FtZSBuYW1lLlxuICAgICAqL1xuICAgIHVuY2hlY2tHcm91cEl0ZW1zKCkge1xuICAgICAgICBsZXQgbWUgPSB0aGlzLFxuICAgICAgICAgICAgcmFkaW9zO1xuXG4gICAgICAgIC8vIGRpc2N1c3M6IHdlIGNvdWxkIGxpbWl0IHRoaXMgdG8gcmFkaW9zIGluc2lkZSB0aGUgc2FtZSBmb3JtLCBJRiBhIHRvcCBsZXZlbCBmb3JtIGlzIHVzZWRcbiAgICAgICAgcmFkaW9zID0gQ29tcG9uZW50TWFuYWdlci5maW5kKHtcbiAgICAgICAgICAgIG50eXBlOiAncmFkaW9maWVsZCcsXG4gICAgICAgICAgICBuYW1lIDogbWUubmFtZVxuICAgICAgICB9KTtcblxuICAgICAgICByYWRpb3MuZm9yRWFjaChpdGVtID0+IHtcbiAgICAgICAgICAgIGlmIChpdGVtLmlkICE9PSBtZS5pZCAmJiBpdGVtLl9jaGVja2VkKSB7XG4gICAgICAgICAgICAgICAgaXRlbS5jaGVja2VkID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfVxufVxuXG5OZW8uYXBwbHlDbGFzc0NvbmZpZyhSYWRpbyk7XG5cbmV4cG9ydCBkZWZhdWx0IFJhZGlvO1xuIiwiaW1wb3J0IENlbGxNb2RlbCAgIGZyb20gJy4vQ2VsbE1vZGVsLm1qcyc7XG5pbXBvcnQgQ29sdW1uTW9kZWwgZnJvbSAnLi9Db2x1bW5Nb2RlbC5tanMnO1xuaW1wb3J0IFZEb21VdGlsICAgIGZyb20gJy4uLy4uL3V0aWwvVkRvbS5tanMnO1xuXG4vKipcbiAqIEBjbGFzcyBOZW8uc2VsZWN0aW9uLmdyaWQuQ2VsbENvbHVtbk1vZGVsXG4gKiBAZXh0ZW5kcyBOZW8uc2VsZWN0aW9uLmdyaWQuQ2VsbE1vZGVsXG4gKi9cbmNsYXNzIENlbGxDb2x1bW5Nb2RlbCBleHRlbmRzIENlbGxNb2RlbCB7XG4gICAgc3RhdGljIGNvbmZpZyA9IHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge1N0cmluZ30gY2xhc3NOYW1lPSdOZW8uc2VsZWN0aW9uLmdyaWQuQ2VsbENvbHVtbk1vZGVsJ1xuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICBjbGFzc05hbWU6ICdOZW8uc2VsZWN0aW9uLmdyaWQuQ2VsbENvbHVtbk1vZGVsJyxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge1N0cmluZ30gbnR5cGU9J3NlbGVjdGlvbi1ncmlkLWNlbGxjb2x1bW5tb2RlbCdcbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKi9cbiAgICAgICAgbnR5cGU6ICdzZWxlY3Rpb24tZ3JpZC1jZWxsY29sdW1ubW9kZWwnLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfSBjbHM9J25lby1zZWxlY3Rpb24tY2VsbGNvbHVtbm1vZGVsJ1xuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICBjbHM6ICduZW8tc2VsZWN0aW9uLWNlbGxjb2x1bW5tb2RlbCcsXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtTdHJpbmd9IHNlbGVjdGVkQ29sdW1uQ2VsbENscz0nc2VsZWN0ZWQtY29sdW1uLWNlbGwnXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIHNlbGVjdGVkQ29sdW1uQ2VsbENsczogJ3NlbGVjdGVkLWNvbHVtbi1jZWxsJyxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge0FycmF5fG51bGx9IHNlbGVjdGVkQ29sdW1uQ2VsbElkcz1udWxsXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIHNlbGVjdGVkQ29sdW1uQ2VsbElkczogbnVsbFxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWdcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3QoY29uZmlnKSB7XG4gICAgICAgIHN1cGVyLmNvbnN0cnVjdChjb25maWcpO1xuXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRDb2x1bW5DZWxsSWRzID0gW107XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbc2lsZW50XSB0cnVlIHRvIHByZXZlbnQgYSB2ZG9tIHVwZGF0ZVxuICAgICAqL1xuICAgIGRlc2VsZWN0QWxsQ2VsbHMoc2lsZW50KSB7XG4gICAgICAgIGxldCBtZSAgICAgID0gdGhpcyxcbiAgICAgICAgICAgIGNlbGxJZHMgPSBbLi4ubWUuc2VsZWN0ZWRDb2x1bW5DZWxsSWRzXSxcbiAgICAgICAgICAgIHZpZXcgICAgPSBtZS52aWV3O1xuXG4gICAgICAgIGNlbGxJZHMuZm9yRWFjaChjZWxsSWQgPT4ge1xuICAgICAgICAgICAgbWUuZGVzZWxlY3QoY2VsbElkLCB0cnVlLCBtZS5zZWxlY3RlZENvbHVtbkNlbGxJZHMsIG1lLnNlbGVjdGVkQ29sdW1uQ2VsbENscyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgICFzaWxlbnQgJiYgdmlldy51cGRhdGUoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YVxuICAgICAqL1xuICAgIG9uQ2VsbENsaWNrKGRhdGEpIHtcbiAgICAgICAgbGV0IG1lID0gdGhpcyxcbiAgICAgICAgICAgIGlkID0gQ29sdW1uTW9kZWwuZ2V0Q2VsbElkKGRhdGEucGF0aCksXG4gICAgICAgICAgICBjb2x1bW5Ob2RlSWRzLCBpbmRleCwgdGJvZHlOb2RlO1xuXG4gICAgICAgIGlmIChpZCkge1xuICAgICAgICAgICAgaW5kZXggICAgICAgICA9IENvbHVtbk1vZGVsLmdldENvbHVtbkluZGV4KGlkLCBtZS52aWV3Lml0ZW1zWzBdLml0ZW1zKTtcbiAgICAgICAgICAgIHRib2R5Tm9kZSAgICAgPSBWRG9tVXRpbC5maW5kVmRvbUNoaWxkKG1lLnZpZXcudmRvbSwge2NsczogJ25lby1ncmlkLXZpZXcnfSkudmRvbTtcbiAgICAgICAgICAgIGNvbHVtbk5vZGVJZHMgPSBWRG9tVXRpbC5nZXRDb2x1bW5Ob2Rlc0lkcyh0Ym9keU5vZGUsIGluZGV4KTtcblxuICAgICAgICAgICAgbWUuZGVzZWxlY3RBbGxDZWxscyh0cnVlKTtcbiAgICAgICAgICAgIG1lLnNlbGVjdChjb2x1bW5Ob2RlSWRzLCBtZS5zZWxlY3RlZENvbHVtbkNlbGxJZHMsIG1lLnNlbGVjdGVkQ29sdW1uQ2VsbENscyk7XG4gICAgICAgIH1cblxuICAgICAgICBzdXBlci5vbkNlbGxDbGljayhkYXRhKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBzdGVwXG4gICAgICovXG4gICAgb25OYXZLZXlDb2x1bW4oZGF0YSwgc3RlcCkge1xuICAgICAgICBsZXQgbWUgICAgICAgICAgICA9IHRoaXMsXG4gICAgICAgICAgICBpZEFycmF5ICAgICAgID0gQ29sdW1uTW9kZWwuZ2V0Q2VsbElkKGRhdGEucGF0aCkuc3BsaXQoJ19fJyksXG4gICAgICAgICAgICBjdXJyZW50Q29sdW1uID0gaWRBcnJheVsyXSxcbiAgICAgICAgICAgIHZpZXcgICAgICAgICAgPSBtZS52aWV3LFxuICAgICAgICAgICAgZmllbGRzICAgICAgICA9IHZpZXcuY29sdW1ucy5tYXAoYyA9PiBjLmZpZWxkKSxcbiAgICAgICAgICAgIG5ld0luZGV4ICAgICAgPSAoZmllbGRzLmluZGV4T2YoY3VycmVudENvbHVtbikgKyBzdGVwKSAlIGZpZWxkcy5sZW5ndGgsXG4gICAgICAgICAgICBjb2x1bW5Ob2RlSWRzLCB0Ym9keU5vZGU7XG5cbiAgICAgICAgd2hpbGUgKG5ld0luZGV4IDwgMCkge1xuICAgICAgICAgICAgbmV3SW5kZXggKz0gZmllbGRzLmxlbmd0aDtcbiAgICAgICAgfVxuXG4gICAgICAgIHRib2R5Tm9kZSAgICAgPSBWRG9tVXRpbC5maW5kVmRvbUNoaWxkKG1lLnZpZXcudmRvbSwge2NsczogJ25lby1ncmlkLXZpZXcnfSkudmRvbTtcbiAgICAgICAgY29sdW1uTm9kZUlkcyA9IFZEb21VdGlsLmdldENvbHVtbk5vZGVzSWRzKHRib2R5Tm9kZSwgbmV3SW5kZXgpO1xuXG4gICAgICAgIG1lLmRlc2VsZWN0QWxsQ2VsbHModHJ1ZSk7XG4gICAgICAgIG1lLnNlbGVjdChjb2x1bW5Ob2RlSWRzLCBtZS5zZWxlY3RlZENvbHVtbkNlbGxJZHMsIG1lLnNlbGVjdGVkQ29sdW1uQ2VsbENscyk7XG5cbiAgICAgICAgc3VwZXIub25OYXZLZXlDb2x1bW4oZGF0YSwgc3RlcCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICpcbiAgICAgKi9cbiAgICB1bnJlZ2lzdGVyKCkge1xuICAgICAgICB0aGlzLmRlc2VsZWN0QWxsQ2VsbHMoKTtcbiAgICAgICAgc3VwZXIudW5yZWdpc3RlcigpO1xuICAgIH1cbn1cblxuTmVvLmFwcGx5Q2xhc3NDb25maWcoQ2VsbENvbHVtbk1vZGVsKTtcblxuZXhwb3J0IGRlZmF1bHQgQ2VsbENvbHVtbk1vZGVsO1xuIiwiaW1wb3J0IENlbGxSb3dNb2RlbCBmcm9tICcuL0NlbGxSb3dNb2RlbC5tanMnO1xuaW1wb3J0IENvbHVtbk1vZGVsICBmcm9tICcuL0NvbHVtbk1vZGVsLm1qcyc7XG5pbXBvcnQgVkRvbVV0aWwgICAgIGZyb20gJy4uLy4uL3V0aWwvVkRvbS5tanMnO1xuXG4vKipcbiAqIEBjbGFzcyBOZW8uc2VsZWN0aW9uLmdyaWQuQ2VsbENvbHVtblJvd01vZGVsXG4gKiBAZXh0ZW5kcyBOZW8uc2VsZWN0aW9uLmdyaWQuQ2VsbFJvd01vZGVsXG4gKi9cbmNsYXNzIENlbGxDb2x1bW5Sb3dNb2RlbCBleHRlbmRzIENlbGxSb3dNb2RlbCB7XG4gICAgc3RhdGljIGNvbmZpZyA9IHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge1N0cmluZ30gY2xhc3NOYW1lPSdOZW8uc2VsZWN0aW9uLmdyaWQuQ2VsbENvbHVtblJvd01vZGVsJ1xuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICBjbGFzc05hbWU6ICdOZW8uc2VsZWN0aW9uLmdyaWQuQ2VsbENvbHVtblJvd01vZGVsJyxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge1N0cmluZ30gbnR5cGU9J3NlbGVjdGlvbi1ncmlkLWNlbGxjb2x1bW5yb3dtb2RlbCdcbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKi9cbiAgICAgICAgbnR5cGU6ICdzZWxlY3Rpb24tZ3JpZC1jZWxsY29sdW1ucm93bW9kZWwnLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfSBjbHM9J25lby1zZWxlY3Rpb24tY2VsbGNvbHVtbnJvd21vZGVsJ1xuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICBjbHM6ICduZW8tc2VsZWN0aW9uLWNlbGxjb2x1bW5yb3dtb2RlbCcsXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtTdHJpbmd9IHNlbGVjdGVkQ29sdW1uQ2VsbENscz0nc2VsZWN0ZWQtY29sdW1uLWNlbGwnXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIHNlbGVjdGVkQ29sdW1uQ2VsbENsczogJ3NlbGVjdGVkLWNvbHVtbi1jZWxsJyxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge0FycmF5fG51bGx9IHNlbGVjdGVkQ29sdW1uQ2VsbElkcz1udWxsXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIHNlbGVjdGVkQ29sdW1uQ2VsbElkczogbnVsbFxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWdcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3QoY29uZmlnKSB7XG4gICAgICAgIHN1cGVyLmNvbnN0cnVjdChjb25maWcpO1xuXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRDb2x1bW5DZWxsSWRzID0gW107XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbc2lsZW50XSB0cnVlIHRvIHByZXZlbnQgYSB2ZG9tIHVwZGF0ZVxuICAgICAqL1xuICAgIGRlc2VsZWN0QWxsQ2VsbHMoc2lsZW50KSB7XG4gICAgICAgIGxldCBtZSAgICAgID0gdGhpcyxcbiAgICAgICAgICAgIGNlbGxJZHMgPSBbLi4ubWUuc2VsZWN0ZWRDb2x1bW5DZWxsSWRzXSxcbiAgICAgICAgICAgIHZpZXcgICAgPSBtZS52aWV3O1xuXG4gICAgICAgIGNlbGxJZHMuZm9yRWFjaChjZWxsSWQgPT4ge1xuICAgICAgICAgICAgbWUuZGVzZWxlY3QoY2VsbElkLCB0cnVlLCBtZS5zZWxlY3RlZENvbHVtbkNlbGxJZHMsIG1lLnNlbGVjdGVkQ29sdW1uQ2VsbENscyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgICFzaWxlbnQgJiYgdmlldy51cGRhdGUoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YVxuICAgICAqL1xuICAgIG9uQ2VsbENsaWNrKGRhdGEpIHtcbiAgICAgICAgbGV0IG1lICAgPSB0aGlzLFxuICAgICAgICAgICAgaWQgICA9IENvbHVtbk1vZGVsLmdldENlbGxJZChkYXRhLnBhdGgpLFxuICAgICAgICAgICAgY29sdW1uTm9kZUlkcywgaW5kZXgsIHRib2R5Tm9kZTtcblxuICAgICAgICBpZiAoaWQpIHtcbiAgICAgICAgICAgIGluZGV4ICAgICAgICAgPSBDb2x1bW5Nb2RlbC5nZXRDb2x1bW5JbmRleChpZCwgbWUudmlldy5pdGVtc1swXS5pdGVtcyk7XG4gICAgICAgICAgICB0Ym9keU5vZGUgICAgID0gVkRvbVV0aWwuZmluZFZkb21DaGlsZChtZS52aWV3LnZkb20sIHtjbHM6ICduZW8tZ3JpZC12aWV3J30pLnZkb207XG4gICAgICAgICAgICBjb2x1bW5Ob2RlSWRzID0gVkRvbVV0aWwuZ2V0Q29sdW1uTm9kZXNJZHModGJvZHlOb2RlLCBpbmRleCk7XG5cbiAgICAgICAgICAgIG1lLmRlc2VsZWN0QWxsQ2VsbHModHJ1ZSk7XG4gICAgICAgICAgICBtZS5zZWxlY3QoY29sdW1uTm9kZUlkcywgbWUuc2VsZWN0ZWRDb2x1bW5DZWxsSWRzLCBtZS5zZWxlY3RlZENvbHVtbkNlbGxDbHMpO1xuICAgICAgICB9XG5cbiAgICAgICAgc3VwZXIub25DZWxsQ2xpY2soZGF0YSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGRhdGFcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gc3RlcFxuICAgICAqL1xuICAgIG9uTmF2S2V5Q29sdW1uKGRhdGEsIHN0ZXApIHtcbiAgICAgICAgbGV0IG1lICAgICAgICAgICAgPSB0aGlzLFxuICAgICAgICAgICAgaWRBcnJheSAgICAgICA9IENvbHVtbk1vZGVsLmdldENlbGxJZChkYXRhLnBhdGgpLnNwbGl0KCdfXycpLFxuICAgICAgICAgICAgY3VycmVudENvbHVtbiA9IGlkQXJyYXlbMl0sXG4gICAgICAgICAgICB2aWV3ICAgICAgICAgID0gbWUudmlldyxcbiAgICAgICAgICAgIGZpZWxkcyAgICAgICAgPSB2aWV3LmNvbHVtbnMubWFwKGMgPT4gYy5maWVsZCksXG4gICAgICAgICAgICBuZXdJbmRleCAgICAgID0gKGZpZWxkcy5pbmRleE9mKGN1cnJlbnRDb2x1bW4pICsgc3RlcCkgJSBmaWVsZHMubGVuZ3RoLFxuICAgICAgICAgICAgY29sdW1uTm9kZUlkcywgdGJvZHlOb2RlO1xuXG4gICAgICAgIHdoaWxlIChuZXdJbmRleCA8IDApIHtcbiAgICAgICAgICAgIG5ld0luZGV4ICs9IGZpZWxkcy5sZW5ndGg7XG4gICAgICAgIH1cblxuICAgICAgICB0Ym9keU5vZGUgICAgID0gVkRvbVV0aWwuZmluZFZkb21DaGlsZChtZS52aWV3LnZkb20sIHtjbHM6ICduZW8tZ3JpZC12aWV3J30pLnZkb207XG4gICAgICAgIGNvbHVtbk5vZGVJZHMgPSBWRG9tVXRpbC5nZXRDb2x1bW5Ob2Rlc0lkcyh0Ym9keU5vZGUsIG5ld0luZGV4KTtcblxuICAgICAgICBtZS5kZXNlbGVjdEFsbENlbGxzKHRydWUpO1xuICAgICAgICBtZS5zZWxlY3QoY29sdW1uTm9kZUlkcywgbWUuc2VsZWN0ZWRDb2x1bW5DZWxsSWRzLCBtZS5zZWxlY3RlZENvbHVtbkNlbGxDbHMpO1xuXG4gICAgICAgIHN1cGVyLm9uTmF2S2V5Q29sdW1uKGRhdGEsIHN0ZXApO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqXG4gICAgICovXG4gICAgdW5yZWdpc3RlcigpIHtcbiAgICAgICAgdGhpcy5kZXNlbGVjdEFsbENlbGxzKCk7XG4gICAgICAgIHN1cGVyLnVucmVnaXN0ZXIoKTtcbiAgICB9XG59XG5cbk5lby5hcHBseUNsYXNzQ29uZmlnKENlbGxDb2x1bW5Sb3dNb2RlbCk7XG5cbmV4cG9ydCBkZWZhdWx0IENlbGxDb2x1bW5Sb3dNb2RlbDtcbiIsImltcG9ydCBNb2RlbCBmcm9tICcuLi9Nb2RlbC5tanMnO1xuXG4vKipcbiAqIEBjbGFzcyBOZW8uc2VsZWN0aW9uLmdyaWQuQ2VsbE1vZGVsXG4gKiBAZXh0ZW5kcyBOZW8uc2VsZWN0aW9uLk1vZGVsXG4gKi9cbmNsYXNzIENlbGxNb2RlbCBleHRlbmRzIE1vZGVsIHtcbiAgICBzdGF0aWMgY29uZmlnID0ge1xuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfSBjbGFzc05hbWU9J05lby5zZWxlY3Rpb24uZ3JpZC5DZWxsTW9kZWwnXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIGNsYXNzTmFtZTogJ05lby5zZWxlY3Rpb24uZ3JpZC5DZWxsTW9kZWwnLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfSBudHlwZT0nc2VsZWN0aW9uLWdyaWQtY2VsbG1vZGVsJ1xuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICBudHlwZTogJ3NlbGVjdGlvbi1ncmlkLWNlbGxtb2RlbCcsXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtTdHJpbmd9IGNscz0nc2VsZWN0aW9uLWNlbGxtb2RlbCdcbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKi9cbiAgICAgICAgY2xzOiAnbmVvLXNlbGVjdGlvbi1jZWxsbW9kZWwnXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICpcbiAgICAgKi9cbiAgICBhZGREb21MaXN0ZW5lcigpIHtcbiAgICAgICAgbGV0IG1lICAgPSB0aGlzLFxuICAgICAgICAgICAgdmlldyA9IG1lLnZpZXc7XG5cbiAgICAgICAgdmlldy5hZGREb21MaXN0ZW5lcnMoe1xuICAgICAgICAgICAgY2xpY2sgICA6IG1lLm9uQ2VsbENsaWNrLFxuICAgICAgICAgICAgZGVsZWdhdGU6ICcubmVvLWdyaWQtY2VsbCcsXG4gICAgICAgICAgICBzY29wZSAgIDogbWVcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGRhdGFcbiAgICAgKi9cbiAgICBvbkNlbGxDbGljayhkYXRhKSB7XG4gICAgICAgIGxldCBtZSAgID0gdGhpcyxcbiAgICAgICAgICAgIHBhdGggPSBkYXRhLnBhdGgsXG4gICAgICAgICAgICBpICAgID0gMCxcbiAgICAgICAgICAgIGxlbiAgPSBwYXRoLmxlbmd0aCxcbiAgICAgICAgICAgIGlkO1xuXG4gICAgICAgIGZvciAoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChwYXRoW2ldLmNscy5pbmNsdWRlcygnbmVvLWdyaWQtY2VsbCcpKSB7XG4gICAgICAgICAgICAgICAgaWQgPSBwYXRoW2ldLmlkO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWQgJiYgbWUudG9nZ2xlU2VsZWN0aW9uKGlkKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YVxuICAgICAqL1xuICAgIG9uS2V5RG93bkRvd24oZGF0YSkge1xuICAgICAgICB0aGlzLm9uTmF2S2V5Um93KGRhdGEsIDEpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBkYXRhXG4gICAgICovXG4gICAgb25LZXlEb3duTGVmdChkYXRhKSB7XG4gICAgICAgIHRoaXMub25OYXZLZXlDb2x1bW4oZGF0YSwgLTEpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBkYXRhXG4gICAgICovXG4gICAgb25LZXlEb3duUmlnaHQoZGF0YSkge1xuICAgICAgICB0aGlzLm9uTmF2S2V5Q29sdW1uKGRhdGEsIDEpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBkYXRhXG4gICAgICovXG4gICAgb25LZXlEb3duVXAoZGF0YSkge1xuICAgICAgICB0aGlzLm9uTmF2S2V5Um93KGRhdGEsIC0xKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBzdGVwXG4gICAgICovXG4gICAgb25OYXZLZXlDb2x1bW4oZGF0YSwgc3RlcCkge1xuICAgICAgICBsZXQgbWUgICAgICAgICAgICA9IHRoaXMsXG4gICAgICAgICAgICB2aWV3ICAgICAgICAgID0gbWUudmlldyxcbiAgICAgICAgICAgIGlkQXJyYXkgICAgICAgPSBkYXRhLnBhdGhbMF0uaWQuc3BsaXQoJ19fJyksXG4gICAgICAgICAgICBjdXJyZW50Q29sdW1uID0gaWRBcnJheVsyXSxcbiAgICAgICAgICAgIGRhdGFGaWVsZHMgICAgPSB2aWV3LmNvbHVtbnMubWFwKGMgPT4gYy5maWVsZCksXG4gICAgICAgICAgICBuZXdJbmRleCAgICAgID0gKGRhdGFGaWVsZHMuaW5kZXhPZihjdXJyZW50Q29sdW1uKSArIHN0ZXApICUgZGF0YUZpZWxkcy5sZW5ndGgsXG4gICAgICAgICAgICBpZDtcblxuICAgICAgICB3aGlsZSAobmV3SW5kZXggPCAwKSB7XG4gICAgICAgICAgICBuZXdJbmRleCArPSBkYXRhRmllbGRzLmxlbmd0aDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlkQXJyYXlbMl0gPSBkYXRhRmllbGRzW25ld0luZGV4XTtcbiAgICAgICAgaWQgPSBpZEFycmF5LmpvaW4oJ19fJyk7XG5cbiAgICAgICAgbWUuc2VsZWN0KGlkKTtcbiAgICAgICAgdmlldy5mb2N1cyhpZCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGRhdGFcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gc3RlcFxuICAgICAqL1xuICAgIG9uTmF2S2V5Um93KGRhdGEsIHN0ZXApIHtcbiAgICAgICAgbGV0IG1lICAgICAgID0gdGhpcyxcbiAgICAgICAgICAgIHZpZXcgICAgID0gbWUudmlldyxcbiAgICAgICAgICAgIHN0b3JlICAgID0gdmlldy5zdG9yZSxcbiAgICAgICAgICAgIGlkQXJyYXkgID0gZGF0YS5wYXRoWzBdLmlkLnNwbGl0KCdfXycpLFxuICAgICAgICAgICAgcmVjb3JkSWQgPSBpZEFycmF5WzFdLFxuICAgICAgICAgICAgbmV3SW5kZXggPSAoc3RvcmUuaW5kZXhPZihyZWNvcmRJZCkgKyBzdGVwKSAlIHN0b3JlLmdldENvdW50KCksXG4gICAgICAgICAgICBpZDtcblxuICAgICAgICB3aGlsZSAobmV3SW5kZXggPCAwKSB7XG4gICAgICAgICAgICBuZXdJbmRleCArPSBzdG9yZS5nZXRDb3VudCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWRBcnJheVsxXSA9IHN0b3JlLmdldEtleUF0KG5ld0luZGV4KTtcbiAgICAgICAgaWQgPSBpZEFycmF5LmpvaW4oJ19fJyk7XG5cbiAgICAgICAgbWUuc2VsZWN0KGlkKTtcbiAgICAgICAgdmlldy5mb2N1cyhpZCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtOZW8uY29tcG9uZW50LkJhc2V9IGNvbXBvbmVudFxuICAgICAqL1xuICAgIHJlZ2lzdGVyKGNvbXBvbmVudCkge1xuICAgICAgICBzdXBlci5yZWdpc3Rlcihjb21wb25lbnQpO1xuXG4gICAgICAgIGxldCBtZSAgID0gdGhpcyxcbiAgICAgICAgICAgIGlkICAgPSBtZS5pZCxcbiAgICAgICAgICAgIHZpZXcgPSBtZS52aWV3O1xuXG4gICAgICAgIHZpZXcua2V5cz8uX2tleXMucHVzaChcbiAgICAgICAgICAgIHtmbjogJ29uS2V5RG93bkRvd24nICAsa2V5OiAnRG93bicgICxzY29wZTogaWR9LFxuICAgICAgICAgICAge2ZuOiAnb25LZXlEb3duTGVmdCcgICxrZXk6ICdMZWZ0JyAgLHNjb3BlOiBpZH0sXG4gICAgICAgICAgICB7Zm46ICdvbktleURvd25SaWdodCcgLGtleTogJ1JpZ2h0JyAsc2NvcGU6IGlkfSxcbiAgICAgICAgICAgIHtmbjogJ29uS2V5RG93blVwJyAgICAsa2V5OiAnVXAnICAgICxzY29wZTogaWR9XG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICpcbiAgICAgKi9cbiAgICB1bnJlZ2lzdGVyKCkge1xuICAgICAgICBsZXQgbWUgICA9IHRoaXMsXG4gICAgICAgICAgICBpZCAgID0gbWUuaWQsXG4gICAgICAgICAgICB2aWV3ID0gbWUudmlldztcblxuICAgICAgICB2aWV3LmtleXM/LnJlbW92ZUtleXMoW1xuICAgICAgICAgICAge2ZuOiAnb25LZXlEb3duRG93bicgICxrZXk6ICdEb3duJyAgLHNjb3BlOiBpZH0sXG4gICAgICAgICAgICB7Zm46ICdvbktleURvd25MZWZ0JyAgLGtleTogJ0xlZnQnICAsc2NvcGU6IGlkfSxcbiAgICAgICAgICAgIHtmbjogJ29uS2V5RG93blJpZ2h0JyAsa2V5OiAnUmlnaHQnICxzY29wZTogaWR9LFxuICAgICAgICAgICAge2ZuOiAnb25LZXlEb3duVXAnICAgICxrZXk6ICdVcCcgICAgLHNjb3BlOiBpZH1cbiAgICAgICAgXSk7XG5cbiAgICAgICAgc3VwZXIudW5yZWdpc3RlcigpO1xuICAgIH1cbn1cblxuTmVvLmFwcGx5Q2xhc3NDb25maWcoQ2VsbE1vZGVsKTtcblxuZXhwb3J0IGRlZmF1bHQgQ2VsbE1vZGVsO1xuIiwiaW1wb3J0IENlbGxNb2RlbCBmcm9tICcuL0NlbGxNb2RlbC5tanMnO1xuaW1wb3J0IE5lb0FycmF5ICBmcm9tICcuLi8uLi91dGlsL0FycmF5Lm1qcyc7XG5pbXBvcnQgUm93TW9kZWwgIGZyb20gJy4vUm93TW9kZWwubWpzJztcbmltcG9ydCBWRG9tVXRpbCAgZnJvbSAnLi4vLi4vdXRpbC9WRG9tLm1qcyc7XG5cbi8qKlxuICogQGNsYXNzIE5lby5zZWxlY3Rpb24uZ3JpZC5DZWxsUm93TW9kZWxcbiAqIEBleHRlbmRzIE5lby5zZWxlY3Rpb24uZ3JpZC5DZWxsTW9kZWxcbiAqL1xuY2xhc3MgQ2VsbFJvd01vZGVsIGV4dGVuZHMgQ2VsbE1vZGVsIHtcbiAgICBzdGF0aWMgY29uZmlnID0ge1xuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfSBjbGFzc05hbWU9J05lby5zZWxlY3Rpb24uZ3JpZC5DZWxsUm93TW9kZWwnXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIGNsYXNzTmFtZTogJ05lby5zZWxlY3Rpb24uZ3JpZC5DZWxsUm93TW9kZWwnLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfSBudHlwZT0nc2VsZWN0aW9uLWdyaWQtY2VsbHJvd21vZGVsJ1xuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICBudHlwZTogJ3NlbGVjdGlvbi1ncmlkLWNlbGxyb3dtb2RlbCcsXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtTdHJpbmd9IGNscz0nbmVvLXNlbGVjdGlvbi1jZWxscm93bW9kZWwnXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIGNsczogJ25lby1zZWxlY3Rpb24tY2VsbHJvd21vZGVsJyxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge0FycmF5fG51bGx9IHNlbGVjdGVkUm93SWRzPW51bGxcbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKi9cbiAgICAgICAgc2VsZWN0ZWRSb3dJZHM6IG51bGxcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gY29uZmlnXG4gICAgICovXG4gICAgY29uc3RydWN0KGNvbmZpZykge1xuICAgICAgICBzdXBlci5jb25zdHJ1Y3QoY29uZmlnKTtcblxuICAgICAgICB0aGlzLnNlbGVjdGVkUm93SWRzID0gW107XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtCb29sZWFufSBbc2lsZW50XSB0cnVlIHRvIHByZXZlbnQgYSB2ZG9tIHVwZGF0ZVxuICAgICAqL1xuICAgIGRlc2VsZWN0QWxsUm93cyhzaWxlbnQpIHtcbiAgICAgICAgbGV0IG1lICAgICA9IHRoaXMsXG4gICAgICAgICAgICByb3dJZHMgPSBbLi4ubWUuc2VsZWN0ZWRSb3dJZHNdLFxuICAgICAgICAgICAgdmlldyAgID0gbWUudmlldztcblxuICAgICAgICByb3dJZHMuZm9yRWFjaChyb3dJZCA9PiB7XG4gICAgICAgICAgICBtZS5kZXNlbGVjdFJvdyhyb3dJZCwgdHJ1ZSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgICFzaWxlbnQgJiYgdmlldy51cGRhdGUoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gcm93SWRcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtzaWxlbnRdIHRydWUgdG8gcHJldmVudCBhIHZkb20gdXBkYXRlXG4gICAgICovXG4gICAgZGVzZWxlY3RSb3cocm93SWQsIHNpbGVudCkge1xuICAgICAgICBsZXQgbWUgICA9IHRoaXMsXG4gICAgICAgICAgICB2aWV3ID0gbWUudmlldyxcbiAgICAgICAgICAgIG5vZGUgPSB2aWV3LmdldFZkb21DaGlsZChyb3dJZCksXG4gICAgICAgICAgICBjbHM7XG5cbiAgICAgICAgaWYgKG5vZGUpIHtcbiAgICAgICAgICAgIGNscyA9IG5vZGUuY2xzIHx8IFtdO1xuICAgICAgICAgICAgTmVvQXJyYXkucmVtb3ZlKGNscywgbWUuc2VsZWN0ZWRDbHMpO1xuICAgICAgICAgICAgbm9kZS5jbHMgPSBjbHM7XG4gICAgICAgIH1cblxuICAgICAgICBOZW9BcnJheS5yZW1vdmUobWUuc2VsZWN0ZWRSb3dJZHMsIHJvd0lkKTtcblxuICAgICAgICAhc2lsZW50ICYmIHZpZXcudXBkYXRlKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGRhdGFcbiAgICAgKi9cbiAgICBvbkNlbGxDbGljayhkYXRhKSB7XG4gICAgICAgIGxldCBtZSAgID0gdGhpcyxcbiAgICAgICAgICAgIG5vZGUgPSBSb3dNb2RlbC5nZXRSb3dOb2RlKGRhdGEucGF0aCksIC8vIHdlIGNvdWxkIGFkZCBhIHNlcGFyYXRlIGV4cG9ydCBmb3IgdGhpcyBtZXRob2RcbiAgICAgICAgICAgIGlkICAgPSBub2RlPy5pZDtcblxuICAgICAgICBpZiAoaWQpIHtcbiAgICAgICAgICAgIG1lLmRlc2VsZWN0QWxsUm93cyh0cnVlKTtcbiAgICAgICAgICAgIG1lLnNlbGVjdFJvdyhpZCk7XG4gICAgICAgIH1cblxuICAgICAgICBzdXBlci5vbkNlbGxDbGljayhkYXRhKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBzdGVwXG4gICAgICovXG4gICAgb25OYXZLZXlSb3coZGF0YSwgc3RlcCkge1xuICAgICAgICBzdXBlci5vbk5hdktleVJvdyhkYXRhLCBzdGVwKTtcblxuICAgICAgICBsZXQgbWUgICAgICAgICA9IHRoaXMsXG4gICAgICAgICAgICBub2RlICAgICAgID0gUm93TW9kZWwuZ2V0Um93Tm9kZShkYXRhLnBhdGgpLFxuICAgICAgICAgICAgdmlldyAgICAgICA9IG1lLnZpZXcsXG4gICAgICAgICAgICBzdG9yZSAgICAgID0gdmlldy5zdG9yZSxcbiAgICAgICAgICAgIHZkb21Ob2RlICAgPSBWRG9tVXRpbC5maW5kVmRvbUNoaWxkKHZpZXcudmRvbSwgbm9kZS5pZCksXG4gICAgICAgICAgICBuZXdJbmRleCAgID0gKHZkb21Ob2RlLmluZGV4ICsgc3RlcCkgJSBzdG9yZS5nZXRDb3VudCgpLFxuICAgICAgICAgICAgcGFyZW50Tm9kZSA9IHZkb21Ob2RlLnBhcmVudE5vZGUsXG4gICAgICAgICAgICBpZDtcblxuICAgICAgICB3aGlsZSAobmV3SW5kZXggPCAwKSB7XG4gICAgICAgICAgICBuZXdJbmRleCArPSBzdG9yZS5nZXRDb3VudCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWQgPSBwYXJlbnROb2RlLmNuW25ld0luZGV4XS5pZDtcblxuICAgICAgICBpZiAoaWQpIHtcbiAgICAgICAgICAgIG1lLmRlc2VsZWN0QWxsUm93cyh0cnVlKTtcbiAgICAgICAgICAgIG1lLnNlbGVjdFJvdyhpZCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gaWRcbiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtzaWxlbnRdXG4gICAgICovXG4gICAgc2VsZWN0Um93KGlkLCBzaWxlbnQpIHtcbiAgICAgICAgbGV0IG1lICAgICAgID0gdGhpcyxcbiAgICAgICAgICAgIHZpZXcgICAgID0gbWUudmlldyxcbiAgICAgICAgICAgIHZkb21Ob2RlID0gaWQgJiYgdmlldy5nZXRWZG9tQ2hpbGQoaWQpLFxuICAgICAgICAgICAgY2xzO1xuXG4gICAgICAgIGlmICh2ZG9tTm9kZSkge1xuICAgICAgICAgICAgY2xzID0gdmRvbU5vZGUuY2xzIHx8IFtdO1xuICAgICAgICAgICAgTmVvQXJyYXkuYWRkKGNscywgbWUuc2VsZWN0ZWRDbHMpO1xuICAgICAgICAgICAgdmRvbU5vZGUuY2xzID0gY2xzO1xuXG4gICAgICAgICAgICBtZS5zZWxlY3RlZFJvd0lkcy5wdXNoKGlkKTtcbiAgICAgICAgfVxuXG4gICAgICAgICFzaWxlbnQgJiYgdmlldy51cGRhdGUoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKlxuICAgICAqL1xuICAgIHVucmVnaXN0ZXIoKSB7XG4gICAgICAgIHRoaXMuZGVzZWxlY3RBbGxSb3dzKCk7XG4gICAgICAgIHN1cGVyLnVucmVnaXN0ZXIoKTtcbiAgICB9XG59XG5cbk5lby5hcHBseUNsYXNzQ29uZmlnKENlbGxSb3dNb2RlbCk7XG5cbmV4cG9ydCBkZWZhdWx0IENlbGxSb3dNb2RlbDtcbiIsImltcG9ydCBNb2RlbCAgICBmcm9tICcuLi9Nb2RlbC5tanMnO1xuaW1wb3J0IFZEb21VdGlsIGZyb20gJy4uLy4uL3V0aWwvVkRvbS5tanMnO1xuXG4vKipcbiAqIEBjbGFzcyBOZW8uc2VsZWN0aW9uLmdyaWQuQ29sdW1uTW9kZWxcbiAqIEBleHRlbmRzIE5lby5zZWxlY3Rpb24uTW9kZWxcbiAqL1xuY2xhc3MgQ29sdW1uTW9kZWwgZXh0ZW5kcyBNb2RlbCB7XG4gICAgc3RhdGljIGNvbmZpZyA9IHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge1N0cmluZ30gY2xhc3NOYW1lPSdOZW8uc2VsZWN0aW9uLmdyaWQuQ29sdW1uTW9kZWwnXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIGNsYXNzTmFtZTogJ05lby5zZWxlY3Rpb24uZ3JpZC5Db2x1bW5Nb2RlbCcsXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtTdHJpbmd9IG50eXBlPSdzZWxlY3Rpb24tZ3JpZC1jb2x1bW5tb2RlbCdcbiAgICAgICAgICogQHByb3RlY3RlZFxuICAgICAgICAgKi9cbiAgICAgICAgbnR5cGU6ICdzZWxlY3Rpb24tZ3JpZC1jb2x1bW5tb2RlbCcsXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtTdHJpbmd9IGNscz0nc2VsZWN0aW9uLWNvbHVtbm1vZGVsJ1xuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICBjbHM6ICduZW8tc2VsZWN0aW9uLWNvbHVtbm1vZGVsJ1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqXG4gICAgICovXG4gICAgYWRkRG9tTGlzdGVuZXIoKSB7XG4gICAgICAgIGxldCBtZSAgID0gdGhpcyxcbiAgICAgICAgICAgIHZpZXcgPSBtZS52aWV3O1xuXG4gICAgICAgIHZpZXcuYWRkRG9tTGlzdGVuZXJzKHtcbiAgICAgICAgICAgIGNsaWNrICAgOiBtZS5vbkNlbGxDbGljayxcbiAgICAgICAgICAgIGRlbGVnYXRlOiAnLm5lby1ncmlkLWNlbGwnLFxuICAgICAgICAgICAgc2NvcGUgICA6IG1lXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBldmVudFBhdGhcbiAgICAgKiBAcmV0dXJucyB7U3RyaW5nfG51bGx9IGNlbGxJZFxuICAgICAqL1xuICAgIHN0YXRpYyBnZXRDZWxsSWQoZXZlbnRQYXRoKSB7XG4gICAgICAgIGxldCBpZCAgID0gbnVsbCxcbiAgICAgICAgICAgIGkgICAgPSAwLFxuICAgICAgICAgICAgbGVuICA9IGV2ZW50UGF0aC5sZW5ndGg7XG5cbiAgICAgICAgZm9yICg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgaWYgKGV2ZW50UGF0aFtpXS5jbHMuaW5jbHVkZXMoJ25lby1ncmlkLWNlbGwnKSkge1xuICAgICAgICAgICAgICAgIGlkID0gZXZlbnRQYXRoW2ldLmlkO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGlkO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIHRvZG86IG1vdmUgdG8gZ3JpZC5Db250YWluZXIgb3Igdmlld1xuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBjZWxsSWRcbiAgICAgKiBAcGFyYW0ge09iamVjdFtdfSBjb2x1bW5zXG4gICAgICogQHJldHVybnMge051bWJlcn0gaW5kZXhcbiAgICAgKi9cbiAgICBzdGF0aWMgZ2V0Q29sdW1uSW5kZXgoY2VsbElkLCBjb2x1bW5zKSB7XG4gICAgICAgIGxldCBpZEFycmF5ICAgICAgID0gY2VsbElkLnNwbGl0KCdfXycpLFxuICAgICAgICAgICAgY3VycmVudENvbHVtbiA9IGlkQXJyYXlbMl0sXG4gICAgICAgICAgICBkYXRhRmllbGRzICAgID0gY29sdW1ucy5tYXAoYyA9PiBjLmZpZWxkKTtcblxuICAgICAgICByZXR1cm4gZGF0YUZpZWxkcy5pbmRleE9mKGN1cnJlbnRDb2x1bW4pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBkYXRhXG4gICAgICovXG4gICAgb25DZWxsQ2xpY2soZGF0YSkge1xuICAgICAgICBsZXQgbWUgPSB0aGlzLFxuICAgICAgICAgICAgaWQgPSBDb2x1bW5Nb2RlbC5nZXRDZWxsSWQoZGF0YS5wYXRoKSxcbiAgICAgICAgICAgIGNvbHVtbk5vZGVJZHMsIGluZGV4LCB0Ym9keU5vZGU7XG5cbiAgICAgICAgaWYgKGlkKSB7XG4gICAgICAgICAgICBpbmRleCAgICAgICAgID0gQ29sdW1uTW9kZWwuZ2V0Q29sdW1uSW5kZXgoaWQsIG1lLnZpZXcuaXRlbXNbMF0uaXRlbXMpO1xuICAgICAgICAgICAgdGJvZHlOb2RlICAgICA9IFZEb21VdGlsLmZpbmRWZG9tQ2hpbGQobWUudmlldy52ZG9tLCB7Y2xzOiAnbmVvLWdyaWQtdmlldyd9KS52ZG9tO1xuICAgICAgICAgICAgY29sdW1uTm9kZUlkcyA9IFZEb21VdGlsLmdldENvbHVtbk5vZGVzSWRzKHRib2R5Tm9kZSwgaW5kZXgpO1xuXG4gICAgICAgICAgICBtZS5zZWxlY3QoY29sdW1uTm9kZUlkcyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YVxuICAgICAqL1xuICAgIG9uS2V5RG93bkxlZnQoZGF0YSkge1xuICAgICAgICB0aGlzLm9uTmF2S2V5Q29sdW1uKGRhdGEsIC0xKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YVxuICAgICAqL1xuICAgIG9uS2V5RG93blJpZ2h0KGRhdGEpIHtcbiAgICAgICAgdGhpcy5vbk5hdktleUNvbHVtbihkYXRhLCAxKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZGF0YVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBzdGVwXG4gICAgICovXG4gICAgb25OYXZLZXlDb2x1bW4oZGF0YSwgc3RlcCkge1xuICAgICAgICBsZXQgbWUgICAgICAgICAgICA9IHRoaXMsXG4gICAgICAgICAgICBpZEFycmF5ICAgICAgID0gQ29sdW1uTW9kZWwuZ2V0Q2VsbElkKGRhdGEucGF0aCkuc3BsaXQoJ19fJyksXG4gICAgICAgICAgICBjdXJyZW50Q29sdW1uID0gaWRBcnJheVsyXSxcbiAgICAgICAgICAgIHZpZXcgICAgICAgICAgPSBtZS52aWV3LFxuICAgICAgICAgICAgZmllbGRzICAgICAgICA9IHZpZXcuY29sdW1ucy5tYXAoYyA9PiBjLmZpZWxkKSxcbiAgICAgICAgICAgIG5ld0luZGV4ICAgICAgPSAoZmllbGRzLmluZGV4T2YoY3VycmVudENvbHVtbikgKyBzdGVwKSAlIGZpZWxkcy5sZW5ndGgsXG4gICAgICAgICAgICBjb2x1bW5Ob2RlSWRzLCBpZCwgdGJvZHlOb2RlO1xuXG4gICAgICAgIHdoaWxlIChuZXdJbmRleCA8IDApIHtcbiAgICAgICAgICAgIG5ld0luZGV4ICs9IGZpZWxkcy5sZW5ndGg7XG4gICAgICAgIH1cblxuICAgICAgICBpZEFycmF5WzJdID0gZmllbGRzW25ld0luZGV4XTtcbiAgICAgICAgaWQgPSBpZEFycmF5LmpvaW4oJ19fJyk7XG5cbiAgICAgICAgdGJvZHlOb2RlICAgICA9IFZEb21VdGlsLmZpbmRWZG9tQ2hpbGQobWUudmlldy52ZG9tLCB7Y2xzOiAnbmVvLWdyaWQtdmlldyd9KS52ZG9tO1xuICAgICAgICBjb2x1bW5Ob2RlSWRzID0gVkRvbVV0aWwuZ2V0Q29sdW1uTm9kZXNJZHModGJvZHlOb2RlLCBuZXdJbmRleCk7XG5cbiAgICAgICAgbWUuc2VsZWN0KGNvbHVtbk5vZGVJZHMpO1xuICAgICAgICB2aWV3LmZvY3VzKGlkKTsgLy8gd2UgaGF2ZSB0byBmb2N1cyBvbmUgY2VsbCB0byBlbnN1cmUgdGhlIGtleW5hdiBrZWVwcyB3b3JraW5nXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtOZW8uY29tcG9uZW50LkJhc2V9IGNvbXBvbmVudFxuICAgICAqL1xuICAgIHJlZ2lzdGVyKGNvbXBvbmVudCkge1xuICAgICAgICBzdXBlci5yZWdpc3Rlcihjb21wb25lbnQpO1xuXG4gICAgICAgIGxldCBtZSAgID0gdGhpcyxcbiAgICAgICAgICAgIGlkICAgPSBtZS5pZCxcbiAgICAgICAgICAgIHZpZXcgPSBtZS52aWV3O1xuXG4gICAgICAgIHZpZXcua2V5cz8uX2tleXMucHVzaCh7XG4gICAgICAgICAgICBmbiAgIDogJ29uS2V5RG93bkxlZnQnLFxuICAgICAgICAgICAga2V5ICA6ICdMZWZ0JyxcbiAgICAgICAgICAgIHNjb3BlOiBpZFxuICAgICAgICB9LCB7XG4gICAgICAgICAgICBmbiAgIDogJ29uS2V5RG93blJpZ2h0JyxcbiAgICAgICAgICAgIGtleSAgOiAnUmlnaHQnLFxuICAgICAgICAgICAgc2NvcGU6IGlkXG4gICAgICAgIH0pO1xuICAgIH1cblxuXG4gICAgLyoqXG4gICAgICpcbiAgICAgKi9cbiAgICB1bnJlZ2lzdGVyKCkge1xuICAgICAgICBsZXQgbWUgICA9IHRoaXMsXG4gICAgICAgICAgICBpZCAgID0gbWUuaWQsXG4gICAgICAgICAgICB2aWV3ID0gbWUudmlldztcblxuICAgICAgICB2aWV3LmtleXM/LnJlbW92ZUtleXMoW3tcbiAgICAgICAgICAgIGZuICAgOiAnb25LZXlEb3duTGVmdCcsXG4gICAgICAgICAgICBrZXkgIDogJ0xlZnQnLFxuICAgICAgICAgICAgc2NvcGU6IGlkXG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGZuICAgOiAnb25LZXlEb3duUmlnaHQnLFxuICAgICAgICAgICAga2V5ICA6ICdSaWdodCcsXG4gICAgICAgICAgICBzY29wZTogaWRcbiAgICAgICAgfV0pO1xuXG4gICAgICAgIHN1cGVyLnVucmVnaXN0ZXIoKTtcbiAgICB9XG59XG5cbk5lby5hcHBseUNsYXNzQ29uZmlnKENvbHVtbk1vZGVsKTtcblxuZXhwb3J0IGRlZmF1bHQgQ29sdW1uTW9kZWw7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=