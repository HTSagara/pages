"use strict";
(self["webpackChunkneo_mjs"] = self["webpackChunkneo_mjs"] || []).push([["src_container_Dialog_mjs"],{

/***/ "./src/container/Dialog.mjs":
/*!**********************************!*\
  !*** ./src/container/Dialog.mjs ***!
  \**********************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _container_Panel_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../container/Panel.mjs */ "./src/container/Panel.mjs");
/* harmony import */ var _util_Array_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../util/Array.mjs */ "./src/util/Array.mjs");
/* harmony import */ var _dialog_header_Toolbar_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../dialog/header/Toolbar.mjs */ "./src/dialog/header/Toolbar.mjs");




/**
 * Lightweight implementation using the dialog tag.
 * See: https://developer.mozilla.org/en-US/docs/Web/HTML/Element/dialog
 * @class Neo.container.Dialog
 * @extends Neo.container.Panel
 */
class Dialog extends _container_Panel_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        /**
         * @member {String} className='Neo.container.Dialog'
         * @protected
         */
        className: 'Neo.container.Dialog',
        /**
         * @member {String} ntype='container-dialog'
         * @protected
         */
        ntype: 'container-dialog',
        /**
         * @member {Boolean} autoMount=true
         */
        autoMount: true,
        /**
         * @member {Boolean} autoRender=true
         */
        autoRender: true,
        /**
         * @member {String[]} baseCls=['neo-container-dialog', 'neo-panel', 'neo-container']
         * @protected
         */
        baseCls: ['neo-container-dialog', 'neo-panel', 'neo-container'],
        /**
         * @member {Object} headerConfig=null
         */
        headerConfig: null,
        /**
         * @member {Neo.toolbar.Base|null} headerToolbar=null
         */
        headerToolbar: null,
        /**
         * The CSS class to use for an icon, e.g. ['fa', 'fa-home']
         * @member {String[]} [iconCls_=null]
         */
        iconCls_: null,
        /**
         * @member {Object} itemDefaults
         */
        itemDefaults: {
            baseCls: ['neo-dialog-content']
        },
        /**
         * @member {Object[]} items
         */
        items: [],
        /**
         * @member {String} title=null
         */
        title_: null,
        /**
         * @member {Object} _vdom={tag: 'dialog', cn: []}
         */
        _vdom:
        {tag: 'dialog', cn: []}
    }

    /**
     * @param {Object} config
     */
    construct(config) {
        super.construct(config);
        this.createHeader();
    }

    /**
     * Triggered after the iconCls config got changed
     * @param {String} value
     * @param {String} oldValue
     * @protected
     */
    afterSetIconCls(value, oldValue) {
        if (!this.headers) { return }
        let iconNode    = this.headers.down({flag: 'dialog-header-icon'}),
            iconNodeCls = [...iconNode.cls];

        _util_Array_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].remove(iconNodeCls, oldValue);
        _util_Array_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].add(   iconNodeCls, value);

        iconNode.cls = iconNodeCls;

        iconNode.removeDom = !value || value === '';
        this.update();
    } 

    /**
     * Triggered after the title config got changed
     * @param {String} value
     * @param {String} oldValue
     * @protected
     */
    afterSetTitle(value, oldValue) {
        this.headerToolbar?.down({flag: 'panel-header-title'}).set({
            text: value
        });
    }

    /**
     * close the dialog in main thread
     */
    close() {
        let me = this;

        Neo.main.addon.Dialog.close({
            id: me.id,
            appName: me.appName
        });
    }

    /**
     * @protected
     */
    createHeader() {
        let me               = this,
            cls              = ['neo-header-toolbar', 'neo-toolbar'],
            headers          = me.headers || [],
            headerConfigCopy = {...me.headerConfig};
        delete headerConfigCopy.items;

        me.headerToolbar = Neo.create({
            module   : _dialog_header_Toolbar_mjs__WEBPACK_IMPORTED_MODULE_2__["default"],
            actions  : [{action: 'close', iconCls: 'fa-solid fa-xmark'}],
            appName  : me.appName,
            cls,
            dock     : 'top',
            flex     : 'none',
            id       : me.getHeaderToolbarId(),
            listeners: {headerAction: me.executeHeaderAction, scope: me},
            items    : [{
                ntype: '',
                cls  : ['neo-dialog-header-icon', ...me.iconCls],
                flag : 'dialog-header-icon',
            }, {
                ntype : 'label',
                cls   : ['neo-panel-header-text', 'neo-label'],
                flag  : 'panel-header-title',
                hidden: !me.title,
                text  : me.title
            }, ...me.headerConfig.items || []],
            
            ...headerConfigCopy
        });

        headers.unshift(me.headerToolbar);

        me.headers = headers;
    }

    /**
     * {Object} data
     */
    executeHeaderAction(data) {
        let me = this,

        map = {
            close: me.close
        };

        map[data.action]?.call(me, data);

        me.fire('headerAction', {
            dialog: me,
            ...data
        })
    }

    /**
     * Returns the id of the header toolbar
     * @returns {String}
     */
    getHeaderToolbarId() {
        return this.id + '-header-toolbar';
    }

    /**
     * Shows the dialog (with / without Modal) in main thread
     * @param {Boolean} modal
     */
    async show(modal = true) {
        let me = this;
        await Neo.timeout(20);

        Neo.main.addon.Dialog[modal ? 'showModal': 'show']({
            id: me.id,
            appName: me.appName
        });
    }
}

Neo.applyClassConfig(Dialog);

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Dialog);


/***/ }),

/***/ "./src/dialog/header/Toolbar.mjs":
/*!***************************************!*\
  !*** ./src/dialog/header/Toolbar.mjs ***!
  \***************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _toolbar_Base_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../toolbar/Base.mjs */ "./src/toolbar/Base.mjs");


/**
 * @class Neo.dialog.header.Toolbar
 * @extends Neo.toolbar.Base
 */
class Toolbar extends _toolbar_Base_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        /**
         * @member {String} className='Neo.dialog.header.Toolbar'
         * @protected
         */
        className: 'Neo.dialog.header.Toolbar',
        /**
         * @member {String|null} title=null
         */
        title_: null
    }

    /**
     * @member {Object} actionMap
     */
    actionMap = {
        close   : () => ({action: 'close',    iconCls: 'far fa-window-close'}),
        maximize: () => ({action: 'maximize', iconCls: 'far fa-window-maximize'})
    }
    /**
     * You can define the action order and directly add custom actions.
     * @example
     * {
     *     actions: [
     *         'close',
     *         'maximize',
     *         {action: 'help', iconCls: 'far fa-circle-question'}
     *     ]
     * }
     *
     * You can also extend the actionMap if needed.
     * @member {Object[]|String[]|null} actions=['maximize','close']
     */
    actions = ['maximize', 'close']

    /**
     * Triggered after the title config got changed
     * @param {String} value
     * @param {String} oldValue
     * @protected
     */
    afterSetTitle(value, oldValue) {
        this.down({flag: 'title-label'})?.set({
            hidden: !value,
            text  : value
        })
    }

    /**
     *
     */
    createItems() {
        let me      = this,
            handler = me.fireAction.bind(me),
            items   = me.items || [];

        items.push({
            ntype : 'label',
            cls   : ['neo-panel-header-text', 'neo-label'],
            flag  : 'title-label',
            hidden: !me.title,
            text  : me.title
        });

        if (me.actions) {
            items.push('->');

            me.actions.forEach(action => {
                if (Neo.typeOf(action) !== 'Object') {
                    action = me.actionMap[action]()
                }

                items.push({handler, ...action})
            })
        }

        me.items = items;

        super.createItems();
    }

    /**
     * @param {Object} data
     */
    fireAction(data) {
        let component = data.component;

        this.fire('headerAction', {
            action: component.action,
            component,
            scope : this
        })
    }
}

Neo.applyClassConfig(Toolbar);

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Toolbar);


/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2h1bmtzL2FwcC9zcmNfY29udGFpbmVyX0RpYWxvZ19tanMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7OztBQUFtRDtBQUNMO0FBQ1c7O0FBRXpEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQiw0REFBSTtBQUN6QjtBQUNBO0FBQ0Esb0JBQW9CLFFBQVE7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsUUFBUTtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixTQUFTO0FBQzdCO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixTQUFTO0FBQzdCO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixVQUFVO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLFFBQVE7QUFDNUI7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLHVCQUF1QjtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixVQUFVO0FBQzlCO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixRQUFRO0FBQzVCO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLG9CQUFvQixVQUFVO0FBQzlCO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixRQUFRO0FBQzVCO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixRQUFRLE9BQU87QUFDbkM7QUFDQTtBQUNBLFNBQVM7QUFDVDs7QUFFQTtBQUNBLGVBQWUsUUFBUTtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxlQUFlLFFBQVE7QUFDdkIsZUFBZSxRQUFRO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3Qiw2Q0FBNkMsMkJBQTJCO0FBQ3hFOztBQUVBLFFBQVEsdURBQVE7QUFDaEIsUUFBUSx1REFBUTs7QUFFaEI7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxlQUFlLFFBQVE7QUFDdkIsZUFBZSxRQUFRO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQywyQkFBMkI7QUFDN0Q7QUFDQSxTQUFTO0FBQ1Q7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0M7QUFDaEM7O0FBRUE7QUFDQSx1QkFBdUIsa0VBQWE7QUFDcEMseUJBQXlCLDhDQUE4QztBQUN2RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdEQUFnRDtBQUN4RTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxTQUFTOztBQUVUOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxRQUFRLFFBQVE7QUFDaEI7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7O0FBRUE7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsZUFBZSxTQUFTO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBOztBQUVBOztBQUVBLGlFQUFlLE1BQU0sRUFBQzs7Ozs7Ozs7Ozs7Ozs7OztBQzNNb0I7O0FBRTFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLHlEQUFJO0FBQzFCO0FBQ0E7QUFDQSxvQkFBb0IsUUFBUTtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixhQUFhO0FBQ2pDO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGdCQUFnQixRQUFRO0FBQ3hCO0FBQ0E7QUFDQSwwQkFBMEIsbURBQW1EO0FBQzdFLDBCQUEwQixzREFBc0Q7QUFDaEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQix3QkFBd0I7QUFDeEM7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsZUFBZSxRQUFRO0FBQ3ZCLGVBQWUsUUFBUTtBQUN2QjtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsb0JBQW9CO0FBQ3ZDO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUzs7QUFFVDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLDRCQUE0QixtQkFBbUI7QUFDL0MsYUFBYTtBQUNiOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxlQUFlLFFBQVE7QUFDdkI7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7O0FBRUE7O0FBRUEsaUVBQWUsT0FBTyxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmVvLm1qcy8uL3NyYy9jb250YWluZXIvRGlhbG9nLm1qcyIsIndlYnBhY2s6Ly9uZW8ubWpzLy4vc3JjL2RpYWxvZy9oZWFkZXIvVG9vbGJhci5tanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEJhc2UgICAgICAgICAgZnJvbSAnLi4vY29udGFpbmVyL1BhbmVsLm1qcyc7XG5pbXBvcnQgTmVvQXJyYXkgICAgICBmcm9tICcuLi91dGlsL0FycmF5Lm1qcyc7XG5pbXBvcnQgSGVhZGVyVG9vbGJhciBmcm9tICcuLi9kaWFsb2cvaGVhZGVyL1Rvb2xiYXIubWpzJztcblxuLyoqXG4gKiBMaWdodHdlaWdodCBpbXBsZW1lbnRhdGlvbiB1c2luZyB0aGUgZGlhbG9nIHRhZy5cbiAqIFNlZTogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSFRNTC9FbGVtZW50L2RpYWxvZ1xuICogQGNsYXNzIE5lby5jb250YWluZXIuRGlhbG9nXG4gKiBAZXh0ZW5kcyBOZW8uY29udGFpbmVyLlBhbmVsXG4gKi9cbmNsYXNzIERpYWxvZyBleHRlbmRzIEJhc2Uge1xuICAgIHN0YXRpYyBjb25maWcgPSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtTdHJpbmd9IGNsYXNzTmFtZT0nTmVvLmNvbnRhaW5lci5EaWFsb2cnXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIGNsYXNzTmFtZTogJ05lby5jb250YWluZXIuRGlhbG9nJyxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge1N0cmluZ30gbnR5cGU9J2NvbnRhaW5lci1kaWFsb2cnXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIG50eXBlOiAnY29udGFpbmVyLWRpYWxvZycsXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtCb29sZWFufSBhdXRvTW91bnQ9dHJ1ZVxuICAgICAgICAgKi9cbiAgICAgICAgYXV0b01vdW50OiB0cnVlLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7Qm9vbGVhbn0gYXV0b1JlbmRlcj10cnVlXG4gICAgICAgICAqL1xuICAgICAgICBhdXRvUmVuZGVyOiB0cnVlLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nW119IGJhc2VDbHM9WyduZW8tY29udGFpbmVyLWRpYWxvZycsICduZW8tcGFuZWwnLCAnbmVvLWNvbnRhaW5lciddXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIGJhc2VDbHM6IFsnbmVvLWNvbnRhaW5lci1kaWFsb2cnLCAnbmVvLXBhbmVsJywgJ25lby1jb250YWluZXInXSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge09iamVjdH0gaGVhZGVyQ29uZmlnPW51bGxcbiAgICAgICAgICovXG4gICAgICAgIGhlYWRlckNvbmZpZzogbnVsbCxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge05lby50b29sYmFyLkJhc2V8bnVsbH0gaGVhZGVyVG9vbGJhcj1udWxsXG4gICAgICAgICAqL1xuICAgICAgICBoZWFkZXJUb29sYmFyOiBudWxsLFxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIENTUyBjbGFzcyB0byB1c2UgZm9yIGFuIGljb24sIGUuZy4gWydmYScsICdmYS1ob21lJ11cbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nW119IFtpY29uQ2xzXz1udWxsXVxuICAgICAgICAgKi9cbiAgICAgICAgaWNvbkNsc186IG51bGwsXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtPYmplY3R9IGl0ZW1EZWZhdWx0c1xuICAgICAgICAgKi9cbiAgICAgICAgaXRlbURlZmF1bHRzOiB7XG4gICAgICAgICAgICBiYXNlQ2xzOiBbJ25lby1kaWFsb2ctY29udGVudCddXG4gICAgICAgIH0sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtPYmplY3RbXX0gaXRlbXNcbiAgICAgICAgICovXG4gICAgICAgIGl0ZW1zOiBbXSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge1N0cmluZ30gdGl0bGU9bnVsbFxuICAgICAgICAgKi9cbiAgICAgICAgdGl0bGVfOiBudWxsLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7T2JqZWN0fSBfdmRvbT17dGFnOiAnZGlhbG9nJywgY246IFtdfVxuICAgICAgICAgKi9cbiAgICAgICAgX3Zkb206XG4gICAgICAgIHt0YWc6ICdkaWFsb2cnLCBjbjogW119XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGNvbmZpZ1xuICAgICAqL1xuICAgIGNvbnN0cnVjdChjb25maWcpIHtcbiAgICAgICAgc3VwZXIuY29uc3RydWN0KGNvbmZpZyk7XG4gICAgICAgIHRoaXMuY3JlYXRlSGVhZGVyKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVHJpZ2dlcmVkIGFmdGVyIHRoZSBpY29uQ2xzIGNvbmZpZyBnb3QgY2hhbmdlZFxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSB2YWx1ZVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBvbGRWYWx1ZVxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKi9cbiAgICBhZnRlclNldEljb25DbHModmFsdWUsIG9sZFZhbHVlKSB7XG4gICAgICAgIGlmICghdGhpcy5oZWFkZXJzKSB7IHJldHVybiB9XG4gICAgICAgIGxldCBpY29uTm9kZSAgICA9IHRoaXMuaGVhZGVycy5kb3duKHtmbGFnOiAnZGlhbG9nLWhlYWRlci1pY29uJ30pLFxuICAgICAgICAgICAgaWNvbk5vZGVDbHMgPSBbLi4uaWNvbk5vZGUuY2xzXTtcblxuICAgICAgICBOZW9BcnJheS5yZW1vdmUoaWNvbk5vZGVDbHMsIG9sZFZhbHVlKTtcbiAgICAgICAgTmVvQXJyYXkuYWRkKCAgIGljb25Ob2RlQ2xzLCB2YWx1ZSk7XG5cbiAgICAgICAgaWNvbk5vZGUuY2xzID0gaWNvbk5vZGVDbHM7XG5cbiAgICAgICAgaWNvbk5vZGUucmVtb3ZlRG9tID0gIXZhbHVlIHx8IHZhbHVlID09PSAnJztcbiAgICAgICAgdGhpcy51cGRhdGUoKTtcbiAgICB9IFxuXG4gICAgLyoqXG4gICAgICogVHJpZ2dlcmVkIGFmdGVyIHRoZSB0aXRsZSBjb25maWcgZ290IGNoYW5nZWRcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gdmFsdWVcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gb2xkVmFsdWVcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICovXG4gICAgYWZ0ZXJTZXRUaXRsZSh2YWx1ZSwgb2xkVmFsdWUpIHtcbiAgICAgICAgdGhpcy5oZWFkZXJUb29sYmFyPy5kb3duKHtmbGFnOiAncGFuZWwtaGVhZGVyLXRpdGxlJ30pLnNldCh7XG4gICAgICAgICAgICB0ZXh0OiB2YWx1ZVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBjbG9zZSB0aGUgZGlhbG9nIGluIG1haW4gdGhyZWFkXG4gICAgICovXG4gICAgY2xvc2UoKSB7XG4gICAgICAgIGxldCBtZSA9IHRoaXM7XG5cbiAgICAgICAgTmVvLm1haW4uYWRkb24uRGlhbG9nLmNsb3NlKHtcbiAgICAgICAgICAgIGlkOiBtZS5pZCxcbiAgICAgICAgICAgIGFwcE5hbWU6IG1lLmFwcE5hbWVcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIGNyZWF0ZUhlYWRlcigpIHtcbiAgICAgICAgbGV0IG1lICAgICAgICAgICAgICAgPSB0aGlzLFxuICAgICAgICAgICAgY2xzICAgICAgICAgICAgICA9IFsnbmVvLWhlYWRlci10b29sYmFyJywgJ25lby10b29sYmFyJ10sXG4gICAgICAgICAgICBoZWFkZXJzICAgICAgICAgID0gbWUuaGVhZGVycyB8fCBbXSxcbiAgICAgICAgICAgIGhlYWRlckNvbmZpZ0NvcHkgPSB7Li4ubWUuaGVhZGVyQ29uZmlnfTtcbiAgICAgICAgZGVsZXRlIGhlYWRlckNvbmZpZ0NvcHkuaXRlbXM7XG5cbiAgICAgICAgbWUuaGVhZGVyVG9vbGJhciA9IE5lby5jcmVhdGUoe1xuICAgICAgICAgICAgbW9kdWxlICAgOiBIZWFkZXJUb29sYmFyLFxuICAgICAgICAgICAgYWN0aW9ucyAgOiBbe2FjdGlvbjogJ2Nsb3NlJywgaWNvbkNsczogJ2ZhLXNvbGlkIGZhLXhtYXJrJ31dLFxuICAgICAgICAgICAgYXBwTmFtZSAgOiBtZS5hcHBOYW1lLFxuICAgICAgICAgICAgY2xzLFxuICAgICAgICAgICAgZG9jayAgICAgOiAndG9wJyxcbiAgICAgICAgICAgIGZsZXggICAgIDogJ25vbmUnLFxuICAgICAgICAgICAgaWQgICAgICAgOiBtZS5nZXRIZWFkZXJUb29sYmFySWQoKSxcbiAgICAgICAgICAgIGxpc3RlbmVyczoge2hlYWRlckFjdGlvbjogbWUuZXhlY3V0ZUhlYWRlckFjdGlvbiwgc2NvcGU6IG1lfSxcbiAgICAgICAgICAgIGl0ZW1zICAgIDogW3tcbiAgICAgICAgICAgICAgICBudHlwZTogJycsXG4gICAgICAgICAgICAgICAgY2xzICA6IFsnbmVvLWRpYWxvZy1oZWFkZXItaWNvbicsIC4uLm1lLmljb25DbHNdLFxuICAgICAgICAgICAgICAgIGZsYWcgOiAnZGlhbG9nLWhlYWRlci1pY29uJyxcbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICBudHlwZSA6ICdsYWJlbCcsXG4gICAgICAgICAgICAgICAgY2xzICAgOiBbJ25lby1wYW5lbC1oZWFkZXItdGV4dCcsICduZW8tbGFiZWwnXSxcbiAgICAgICAgICAgICAgICBmbGFnICA6ICdwYW5lbC1oZWFkZXItdGl0bGUnLFxuICAgICAgICAgICAgICAgIGhpZGRlbjogIW1lLnRpdGxlLFxuICAgICAgICAgICAgICAgIHRleHQgIDogbWUudGl0bGVcbiAgICAgICAgICAgIH0sIC4uLm1lLmhlYWRlckNvbmZpZy5pdGVtcyB8fCBbXV0sXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC4uLmhlYWRlckNvbmZpZ0NvcHlcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaGVhZGVycy51bnNoaWZ0KG1lLmhlYWRlclRvb2xiYXIpO1xuXG4gICAgICAgIG1lLmhlYWRlcnMgPSBoZWFkZXJzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIHtPYmplY3R9IGRhdGFcbiAgICAgKi9cbiAgICBleGVjdXRlSGVhZGVyQWN0aW9uKGRhdGEpIHtcbiAgICAgICAgbGV0IG1lID0gdGhpcyxcblxuICAgICAgICBtYXAgPSB7XG4gICAgICAgICAgICBjbG9zZTogbWUuY2xvc2VcbiAgICAgICAgfTtcblxuICAgICAgICBtYXBbZGF0YS5hY3Rpb25dPy5jYWxsKG1lLCBkYXRhKTtcblxuICAgICAgICBtZS5maXJlKCdoZWFkZXJBY3Rpb24nLCB7XG4gICAgICAgICAgICBkaWFsb2c6IG1lLFxuICAgICAgICAgICAgLi4uZGF0YVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIGlkIG9mIHRoZSBoZWFkZXIgdG9vbGJhclxuICAgICAqIEByZXR1cm5zIHtTdHJpbmd9XG4gICAgICovXG4gICAgZ2V0SGVhZGVyVG9vbGJhcklkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pZCArICctaGVhZGVyLXRvb2xiYXInO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNob3dzIHRoZSBkaWFsb2cgKHdpdGggLyB3aXRob3V0IE1vZGFsKSBpbiBtYWluIHRocmVhZFxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gbW9kYWxcbiAgICAgKi9cbiAgICBhc3luYyBzaG93KG1vZGFsID0gdHJ1ZSkge1xuICAgICAgICBsZXQgbWUgPSB0aGlzO1xuICAgICAgICBhd2FpdCBOZW8udGltZW91dCgyMCk7XG5cbiAgICAgICAgTmVvLm1haW4uYWRkb24uRGlhbG9nW21vZGFsID8gJ3Nob3dNb2RhbCc6ICdzaG93J10oe1xuICAgICAgICAgICAgaWQ6IG1lLmlkLFxuICAgICAgICAgICAgYXBwTmFtZTogbWUuYXBwTmFtZVxuICAgICAgICB9KTtcbiAgICB9XG59XG5cbk5lby5hcHBseUNsYXNzQ29uZmlnKERpYWxvZyk7XG5cbmV4cG9ydCBkZWZhdWx0IERpYWxvZztcbiIsImltcG9ydCBCYXNlIGZyb20gJy4uLy4uL3Rvb2xiYXIvQmFzZS5tanMnO1xuXG4vKipcbiAqIEBjbGFzcyBOZW8uZGlhbG9nLmhlYWRlci5Ub29sYmFyXG4gKiBAZXh0ZW5kcyBOZW8udG9vbGJhci5CYXNlXG4gKi9cbmNsYXNzIFRvb2xiYXIgZXh0ZW5kcyBCYXNlIHtcbiAgICBzdGF0aWMgY29uZmlnID0ge1xuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfSBjbGFzc05hbWU9J05lby5kaWFsb2cuaGVhZGVyLlRvb2xiYXInXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIGNsYXNzTmFtZTogJ05lby5kaWFsb2cuaGVhZGVyLlRvb2xiYXInLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfG51bGx9IHRpdGxlPW51bGxcbiAgICAgICAgICovXG4gICAgICAgIHRpdGxlXzogbnVsbFxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBtZW1iZXIge09iamVjdH0gYWN0aW9uTWFwXG4gICAgICovXG4gICAgYWN0aW9uTWFwID0ge1xuICAgICAgICBjbG9zZSAgIDogKCkgPT4gKHthY3Rpb246ICdjbG9zZScsICAgIGljb25DbHM6ICdmYXIgZmEtd2luZG93LWNsb3NlJ30pLFxuICAgICAgICBtYXhpbWl6ZTogKCkgPT4gKHthY3Rpb246ICdtYXhpbWl6ZScsIGljb25DbHM6ICdmYXIgZmEtd2luZG93LW1heGltaXplJ30pXG4gICAgfVxuICAgIC8qKlxuICAgICAqIFlvdSBjYW4gZGVmaW5lIHRoZSBhY3Rpb24gb3JkZXIgYW5kIGRpcmVjdGx5IGFkZCBjdXN0b20gYWN0aW9ucy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIHtcbiAgICAgKiAgICAgYWN0aW9uczogW1xuICAgICAqICAgICAgICAgJ2Nsb3NlJyxcbiAgICAgKiAgICAgICAgICdtYXhpbWl6ZScsXG4gICAgICogICAgICAgICB7YWN0aW9uOiAnaGVscCcsIGljb25DbHM6ICdmYXIgZmEtY2lyY2xlLXF1ZXN0aW9uJ31cbiAgICAgKiAgICAgXVxuICAgICAqIH1cbiAgICAgKlxuICAgICAqIFlvdSBjYW4gYWxzbyBleHRlbmQgdGhlIGFjdGlvbk1hcCBpZiBuZWVkZWQuXG4gICAgICogQG1lbWJlciB7T2JqZWN0W118U3RyaW5nW118bnVsbH0gYWN0aW9ucz1bJ21heGltaXplJywnY2xvc2UnXVxuICAgICAqL1xuICAgIGFjdGlvbnMgPSBbJ21heGltaXplJywgJ2Nsb3NlJ11cblxuICAgIC8qKlxuICAgICAqIFRyaWdnZXJlZCBhZnRlciB0aGUgdGl0bGUgY29uZmlnIGdvdCBjaGFuZ2VkXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHZhbHVlXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IG9sZFZhbHVlXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIGFmdGVyU2V0VGl0bGUodmFsdWUsIG9sZFZhbHVlKSB7XG4gICAgICAgIHRoaXMuZG93bih7ZmxhZzogJ3RpdGxlLWxhYmVsJ30pPy5zZXQoe1xuICAgICAgICAgICAgaGlkZGVuOiAhdmFsdWUsXG4gICAgICAgICAgICB0ZXh0ICA6IHZhbHVlXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICpcbiAgICAgKi9cbiAgICBjcmVhdGVJdGVtcygpIHtcbiAgICAgICAgbGV0IG1lICAgICAgPSB0aGlzLFxuICAgICAgICAgICAgaGFuZGxlciA9IG1lLmZpcmVBY3Rpb24uYmluZChtZSksXG4gICAgICAgICAgICBpdGVtcyAgID0gbWUuaXRlbXMgfHwgW107XG5cbiAgICAgICAgaXRlbXMucHVzaCh7XG4gICAgICAgICAgICBudHlwZSA6ICdsYWJlbCcsXG4gICAgICAgICAgICBjbHMgICA6IFsnbmVvLXBhbmVsLWhlYWRlci10ZXh0JywgJ25lby1sYWJlbCddLFxuICAgICAgICAgICAgZmxhZyAgOiAndGl0bGUtbGFiZWwnLFxuICAgICAgICAgICAgaGlkZGVuOiAhbWUudGl0bGUsXG4gICAgICAgICAgICB0ZXh0ICA6IG1lLnRpdGxlXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmIChtZS5hY3Rpb25zKSB7XG4gICAgICAgICAgICBpdGVtcy5wdXNoKCctPicpO1xuXG4gICAgICAgICAgICBtZS5hY3Rpb25zLmZvckVhY2goYWN0aW9uID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoTmVvLnR5cGVPZihhY3Rpb24pICE9PSAnT2JqZWN0Jykge1xuICAgICAgICAgICAgICAgICAgICBhY3Rpb24gPSBtZS5hY3Rpb25NYXBbYWN0aW9uXSgpXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaXRlbXMucHVzaCh7aGFuZGxlciwgLi4uYWN0aW9ufSlcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cblxuICAgICAgICBtZS5pdGVtcyA9IGl0ZW1zO1xuXG4gICAgICAgIHN1cGVyLmNyZWF0ZUl0ZW1zKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGRhdGFcbiAgICAgKi9cbiAgICBmaXJlQWN0aW9uKGRhdGEpIHtcbiAgICAgICAgbGV0IGNvbXBvbmVudCA9IGRhdGEuY29tcG9uZW50O1xuXG4gICAgICAgIHRoaXMuZmlyZSgnaGVhZGVyQWN0aW9uJywge1xuICAgICAgICAgICAgYWN0aW9uOiBjb21wb25lbnQuYWN0aW9uLFxuICAgICAgICAgICAgY29tcG9uZW50LFxuICAgICAgICAgICAgc2NvcGUgOiB0aGlzXG4gICAgICAgIH0pXG4gICAgfVxufVxuXG5OZW8uYXBwbHlDbGFzc0NvbmZpZyhUb29sYmFyKTtcblxuZXhwb3J0IGRlZmF1bHQgVG9vbGJhcjtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==