"use strict";
(self["webpackChunkneo_mjs"] = self["webpackChunkneo_mjs"] || []).push([["src_container_Dialog_mjs"],{

/***/ "./src/container/Dialog.mjs":
/*!**********************************!*\
  !*** ./src/container/Dialog.mjs ***!
  \**********************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _container_Panel_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../container/Panel.mjs */ "./src/container/Panel.mjs");
/* harmony import */ var _util_Array_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../util/Array.mjs */ "./src/util/Array.mjs");
/* harmony import */ var _dialog_header_Toolbar_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../dialog/header/Toolbar.mjs */ "./src/dialog/header/Toolbar.mjs");




/**
 * Lightweight implementation using the dialog tag.
 * See: https://developer.mozilla.org/en-US/docs/Web/HTML/Element/dialog
 * @class Neo.container.Dialog
 * @extends Neo.container.Panel
 */
class Dialog extends _container_Panel_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        /**
         * @member {String} className='Neo.container.Dialog'
         * @protected
         */
        className: 'Neo.container.Dialog',
        /**
         * @member {String} ntype='container-dialog'
         * @protected
         */
        ntype: 'container-dialog',
        /**
         * @member {Boolean} autoMount=true
         */
        autoMount: true,
        /**
         * @member {Boolean} autoRender=true
         */
        autoRender: true,
        /**
         * @member {String[]} baseCls=['neo-container-dialog', 'neo-panel', 'neo-container']
         * @protected
         */
        baseCls: ['neo-container-dialog', 'neo-panel', 'neo-container'],
        /**
         * @member {Object} headerConfig=null
         */
        headerConfig: null,
        /**
         * @member {Neo.toolbar.Base|null} headerToolbar=null
         */
        headerToolbar: null,
        /**
         * The CSS class to use for an icon, e.g. ['fa', 'fa-home']
         * @member {String[]} [iconCls_=null]
         */
        iconCls_: null,
        /**
         * @member {Object} itemDefaults
         */
        itemDefaults: {
            baseCls: ['neo-dialog-content']
        },
        /**
         * @member {Object[]} items
         */
        items: [],
        /**
         * @member {String} title=null
         */
        title_: null,
        /**
         * @member {Object} _vdom={tag: 'dialog', cn: []}
         */
        _vdom:
        {tag: 'dialog', cn: []}
    }

    /**
     * @param {Object} config
     */
    construct(config) {
        super.construct(config);
        this.createHeader();
    }

    /**
     * Triggered after the iconCls config got changed
     * @param {String} value
     * @param {String} oldValue
     * @protected
     */
    afterSetIconCls(value, oldValue) {
        if (!this.headers) { return }
        let iconNode    = this.headers.down({flag: 'dialog-header-icon'}),
            iconNodeCls = [...iconNode.cls];

        _util_Array_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].remove(iconNodeCls, oldValue);
        _util_Array_mjs__WEBPACK_IMPORTED_MODULE_1__["default"].add(   iconNodeCls, value);

        iconNode.cls = iconNodeCls;

        iconNode.removeDom = !value || value === '';
        this.update();
    }

    /**
     * Triggered after the title config got changed
     * @param {String} value
     * @param {String} oldValue
     * @protected
     */
    afterSetTitle(value, oldValue) {
        this.headerToolbar?.down({flag: 'panel-header-title'}).set({
            text: value
        })
    }

    /**
     * close the dialog in main thread
     */
    close() {
        let me = this;

        Neo.main.addon.Dialog.close({
            appName: me.appName,
            id     : me.id
        })
    }

    /**
     * @protected
     */
    createHeader() {
        let me               = this,
            cls              = ['neo-header-toolbar', 'neo-toolbar'],
            headers          = me.headers || [],
            headerConfigCopy = {...me.headerConfig};
        delete headerConfigCopy.items;

        me.headerToolbar = Neo.create({
            module   : _dialog_header_Toolbar_mjs__WEBPACK_IMPORTED_MODULE_2__["default"],
            actions  : [{action: 'close', iconCls: 'fa-solid fa-xmark'}],
            appName  : me.appName,
            cls,
            dock     : 'top',
            flex     : 'none',
            id       : me.getHeaderToolbarId(),
            listeners: {headerAction: me.executeHeaderAction, scope: me},
            items    : [{
                ntype: '',
                cls  : ['neo-dialog-header-icon', ...me.iconCls],
                flag : 'dialog-header-icon',
            }, {
                ntype : 'label',
                cls   : ['neo-panel-header-text', 'neo-label'],
                flag  : 'panel-header-title',
                hidden: !me.title,
                text  : me.title
            }, ...me.headerConfig.items || []],

            ...headerConfigCopy
        });

        headers.unshift(me.headerToolbar);

        me.headers = headers;
    }

    /**
     * {Object} data
     */
    executeHeaderAction(data) {
        let me = this,

        map = {
            close: me.close
        };

        map[data.action]?.call(me, data);

        me.fire('headerAction', {
            dialog: me,
            ...data
        })
    }

    /**
     * Returns the id of the header toolbar
     * @returns {String}
     */
    getHeaderToolbarId() {
        return this.id + '-header-toolbar';
    }

    /**
     * Shows the dialog (with / without Modal) in main thread
     * @param {Boolean} modal
     */
    async show(modal = true) {
        let me = this;

        await me.timeout(20);

        Neo.main.addon.Dialog[modal ? 'showModal': 'show']({
            appName: me.appName,
            id     : me.id
        });
    }
}

Neo.applyClassConfig(Dialog);

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Dialog);


/***/ }),

/***/ "./src/dialog/header/Toolbar.mjs":
/*!***************************************!*\
  !*** ./src/dialog/header/Toolbar.mjs ***!
  \***************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _toolbar_Base_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../toolbar/Base.mjs */ "./src/toolbar/Base.mjs");


/**
 * @class Neo.dialog.header.Toolbar
 * @extends Neo.toolbar.Base
 */
class Toolbar extends _toolbar_Base_mjs__WEBPACK_IMPORTED_MODULE_0__["default"] {
    static config = {
        /**
         * @member {String} className='Neo.dialog.header.Toolbar'
         * @protected
         */
        className: 'Neo.dialog.header.Toolbar',
        /**
         * @member {Object} actionMap
         */
        actionMap: {
            close   : () => ({action: 'close',    iconCls: 'far fa-window-close'}),
            maximize: () => ({action: 'maximize', iconCls: 'far fa-window-maximize'})
        },
        /**
         * You can define the action order and directly add custom actions.
         * @example
         * {
         *     actions: [
         *         'close',
         *         'maximize',
         *         {action: 'help', iconCls: 'far fa-circle-question'}
         *     ]
         * }
         *
         * You can also extend the actionMap if needed.
         * @member {Object[]|String[]|null} actions=['maximize','close']
         */
        actions: ['maximize', 'close'],
        /**
         * @member {String|null} title=null
         */
        title_: null
    }

    /**
     * Triggered after the title config got changed
     * @param {String} value
     * @param {String} oldValue
     * @protected
     */
    afterSetTitle(value, oldValue) {
        this.down({flag: 'title-label'})?.set({
            hidden: !value,
            text  : value
        })
    }

    /**
     *
     */
    createItems() {
        let me      = this,
            handler = me.fireAction.bind(me),
            items   = me.items || [];

        items.push({
            ntype : 'label',
            cls   : ['neo-panel-header-text', 'neo-label'],
            flag  : 'title-label',
            hidden: !me.title,
            text  : me.title
        });

        if (me.actions) {
            items.push('->');

            me.actions.forEach(action => {
                if (Neo.typeOf(action) !== 'Object') {
                    action = me.actionMap[action]()
                }

                items.push({handler, ...action})
            })
        }

        me.items = items;

        super.createItems()
    }

    /**
     * @param {Object} data
     */
    fireAction(data) {
        let component = data.component;

        this.fire('headerAction', {
            action: component.action,
            component,
            scope : this
        })
    }
}

Neo.applyClassConfig(Toolbar);

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Toolbar);


/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2h1bmtzL2FwcC9zcmNfY29udGFpbmVyX0RpYWxvZ19tanMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7OztBQUFtRDtBQUNMO0FBQ1c7O0FBRXpEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQiw0REFBSTtBQUN6QjtBQUNBO0FBQ0Esb0JBQW9CLFFBQVE7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsUUFBUTtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixTQUFTO0FBQzdCO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixTQUFTO0FBQzdCO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixVQUFVO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLFFBQVE7QUFDNUI7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLHVCQUF1QjtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixVQUFVO0FBQzlCO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixRQUFRO0FBQzVCO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLG9CQUFvQixVQUFVO0FBQzlCO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixRQUFRO0FBQzVCO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixRQUFRLE9BQU87QUFDbkM7QUFDQTtBQUNBLFNBQVM7QUFDVDs7QUFFQTtBQUNBLGVBQWUsUUFBUTtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxlQUFlLFFBQVE7QUFDdkIsZUFBZSxRQUFRO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QjtBQUM3Qiw2Q0FBNkMsMkJBQTJCO0FBQ3hFOztBQUVBLFFBQVEsdURBQVE7QUFDaEIsUUFBUSx1REFBUTs7QUFFaEI7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxlQUFlLFFBQVE7QUFDdkIsZUFBZSxRQUFRO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQywyQkFBMkI7QUFDN0Q7QUFDQSxTQUFTO0FBQ1Q7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0M7QUFDaEM7O0FBRUE7QUFDQSx1QkFBdUIsa0VBQWE7QUFDcEMseUJBQXlCLDhDQUE4QztBQUN2RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdEQUFnRDtBQUN4RTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTs7QUFFYjtBQUNBLFNBQVM7O0FBRVQ7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLFFBQVEsUUFBUTtBQUNoQjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDs7QUFFQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxlQUFlLFNBQVM7QUFDeEI7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBOztBQUVBOztBQUVBLGlFQUFlLE1BQU0sRUFBQzs7Ozs7Ozs7Ozs7Ozs7OztBQzVNb0I7O0FBRTFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLHlEQUFJO0FBQzFCO0FBQ0E7QUFDQSxvQkFBb0IsUUFBUTtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixRQUFRO0FBQzVCO0FBQ0E7QUFDQSw4QkFBOEIsbURBQW1EO0FBQ2pGLDhCQUE4QixzREFBc0Q7QUFDcEYsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLHdCQUF3QjtBQUM1QztBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsYUFBYTtBQUNqQztBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGVBQWUsUUFBUTtBQUN2QixlQUFlLFFBQVE7QUFDdkI7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLG9CQUFvQjtBQUN2QztBQUNBO0FBQ0EsU0FBUztBQUNUOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSw0QkFBNEIsbUJBQW1CO0FBQy9DLGFBQWE7QUFDYjs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsZUFBZSxRQUFRO0FBQ3ZCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBOztBQUVBOztBQUVBLGlFQUFlLE9BQU8sRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL25lby5tanMvLi9zcmMvY29udGFpbmVyL0RpYWxvZy5tanMiLCJ3ZWJwYWNrOi8vbmVvLm1qcy8uL3NyYy9kaWFsb2cvaGVhZGVyL1Rvb2xiYXIubWpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBCYXNlICAgICAgICAgIGZyb20gJy4uL2NvbnRhaW5lci9QYW5lbC5tanMnO1xuaW1wb3J0IE5lb0FycmF5ICAgICAgZnJvbSAnLi4vdXRpbC9BcnJheS5tanMnO1xuaW1wb3J0IEhlYWRlclRvb2xiYXIgZnJvbSAnLi4vZGlhbG9nL2hlYWRlci9Ub29sYmFyLm1qcyc7XG5cbi8qKlxuICogTGlnaHR3ZWlnaHQgaW1wbGVtZW50YXRpb24gdXNpbmcgdGhlIGRpYWxvZyB0YWcuXG4gKiBTZWU6IGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0hUTUwvRWxlbWVudC9kaWFsb2dcbiAqIEBjbGFzcyBOZW8uY29udGFpbmVyLkRpYWxvZ1xuICogQGV4dGVuZHMgTmVvLmNvbnRhaW5lci5QYW5lbFxuICovXG5jbGFzcyBEaWFsb2cgZXh0ZW5kcyBCYXNlIHtcbiAgICBzdGF0aWMgY29uZmlnID0ge1xuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfSBjbGFzc05hbWU9J05lby5jb250YWluZXIuRGlhbG9nJ1xuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICBjbGFzc05hbWU6ICdOZW8uY29udGFpbmVyLkRpYWxvZycsXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtTdHJpbmd9IG50eXBlPSdjb250YWluZXItZGlhbG9nJ1xuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICBudHlwZTogJ2NvbnRhaW5lci1kaWFsb2cnLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7Qm9vbGVhbn0gYXV0b01vdW50PXRydWVcbiAgICAgICAgICovXG4gICAgICAgIGF1dG9Nb3VudDogdHJ1ZSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge0Jvb2xlYW59IGF1dG9SZW5kZXI9dHJ1ZVxuICAgICAgICAgKi9cbiAgICAgICAgYXV0b1JlbmRlcjogdHJ1ZSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge1N0cmluZ1tdfSBiYXNlQ2xzPVsnbmVvLWNvbnRhaW5lci1kaWFsb2cnLCAnbmVvLXBhbmVsJywgJ25lby1jb250YWluZXInXVxuICAgICAgICAgKiBAcHJvdGVjdGVkXG4gICAgICAgICAqL1xuICAgICAgICBiYXNlQ2xzOiBbJ25lby1jb250YWluZXItZGlhbG9nJywgJ25lby1wYW5lbCcsICduZW8tY29udGFpbmVyJ10sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtPYmplY3R9IGhlYWRlckNvbmZpZz1udWxsXG4gICAgICAgICAqL1xuICAgICAgICBoZWFkZXJDb25maWc6IG51bGwsXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtOZW8udG9vbGJhci5CYXNlfG51bGx9IGhlYWRlclRvb2xiYXI9bnVsbFxuICAgICAgICAgKi9cbiAgICAgICAgaGVhZGVyVG9vbGJhcjogbnVsbCxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBDU1MgY2xhc3MgdG8gdXNlIGZvciBhbiBpY29uLCBlLmcuIFsnZmEnLCAnZmEtaG9tZSddXG4gICAgICAgICAqIEBtZW1iZXIge1N0cmluZ1tdfSBbaWNvbkNsc189bnVsbF1cbiAgICAgICAgICovXG4gICAgICAgIGljb25DbHNfOiBudWxsLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7T2JqZWN0fSBpdGVtRGVmYXVsdHNcbiAgICAgICAgICovXG4gICAgICAgIGl0ZW1EZWZhdWx0czoge1xuICAgICAgICAgICAgYmFzZUNsczogWyduZW8tZGlhbG9nLWNvbnRlbnQnXVxuICAgICAgICB9LFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7T2JqZWN0W119IGl0ZW1zXG4gICAgICAgICAqL1xuICAgICAgICBpdGVtczogW10sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtTdHJpbmd9IHRpdGxlPW51bGxcbiAgICAgICAgICovXG4gICAgICAgIHRpdGxlXzogbnVsbCxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBtZW1iZXIge09iamVjdH0gX3Zkb209e3RhZzogJ2RpYWxvZycsIGNuOiBbXX1cbiAgICAgICAgICovXG4gICAgICAgIF92ZG9tOlxuICAgICAgICB7dGFnOiAnZGlhbG9nJywgY246IFtdfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWdcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3QoY29uZmlnKSB7XG4gICAgICAgIHN1cGVyLmNvbnN0cnVjdChjb25maWcpO1xuICAgICAgICB0aGlzLmNyZWF0ZUhlYWRlcigpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRyaWdnZXJlZCBhZnRlciB0aGUgaWNvbkNscyBjb25maWcgZ290IGNoYW5nZWRcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gdmFsdWVcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gb2xkVmFsdWVcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICovXG4gICAgYWZ0ZXJTZXRJY29uQ2xzKHZhbHVlLCBvbGRWYWx1ZSkge1xuICAgICAgICBpZiAoIXRoaXMuaGVhZGVycykgeyByZXR1cm4gfVxuICAgICAgICBsZXQgaWNvbk5vZGUgICAgPSB0aGlzLmhlYWRlcnMuZG93bih7ZmxhZzogJ2RpYWxvZy1oZWFkZXItaWNvbid9KSxcbiAgICAgICAgICAgIGljb25Ob2RlQ2xzID0gWy4uLmljb25Ob2RlLmNsc107XG5cbiAgICAgICAgTmVvQXJyYXkucmVtb3ZlKGljb25Ob2RlQ2xzLCBvbGRWYWx1ZSk7XG4gICAgICAgIE5lb0FycmF5LmFkZCggICBpY29uTm9kZUNscywgdmFsdWUpO1xuXG4gICAgICAgIGljb25Ob2RlLmNscyA9IGljb25Ob2RlQ2xzO1xuXG4gICAgICAgIGljb25Ob2RlLnJlbW92ZURvbSA9ICF2YWx1ZSB8fCB2YWx1ZSA9PT0gJyc7XG4gICAgICAgIHRoaXMudXBkYXRlKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVHJpZ2dlcmVkIGFmdGVyIHRoZSB0aXRsZSBjb25maWcgZ290IGNoYW5nZWRcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gdmFsdWVcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gb2xkVmFsdWVcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICovXG4gICAgYWZ0ZXJTZXRUaXRsZSh2YWx1ZSwgb2xkVmFsdWUpIHtcbiAgICAgICAgdGhpcy5oZWFkZXJUb29sYmFyPy5kb3duKHtmbGFnOiAncGFuZWwtaGVhZGVyLXRpdGxlJ30pLnNldCh7XG4gICAgICAgICAgICB0ZXh0OiB2YWx1ZVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGNsb3NlIHRoZSBkaWFsb2cgaW4gbWFpbiB0aHJlYWRcbiAgICAgKi9cbiAgICBjbG9zZSgpIHtcbiAgICAgICAgbGV0IG1lID0gdGhpcztcblxuICAgICAgICBOZW8ubWFpbi5hZGRvbi5EaWFsb2cuY2xvc2Uoe1xuICAgICAgICAgICAgYXBwTmFtZTogbWUuYXBwTmFtZSxcbiAgICAgICAgICAgIGlkICAgICA6IG1lLmlkXG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIGNyZWF0ZUhlYWRlcigpIHtcbiAgICAgICAgbGV0IG1lICAgICAgICAgICAgICAgPSB0aGlzLFxuICAgICAgICAgICAgY2xzICAgICAgICAgICAgICA9IFsnbmVvLWhlYWRlci10b29sYmFyJywgJ25lby10b29sYmFyJ10sXG4gICAgICAgICAgICBoZWFkZXJzICAgICAgICAgID0gbWUuaGVhZGVycyB8fCBbXSxcbiAgICAgICAgICAgIGhlYWRlckNvbmZpZ0NvcHkgPSB7Li4ubWUuaGVhZGVyQ29uZmlnfTtcbiAgICAgICAgZGVsZXRlIGhlYWRlckNvbmZpZ0NvcHkuaXRlbXM7XG5cbiAgICAgICAgbWUuaGVhZGVyVG9vbGJhciA9IE5lby5jcmVhdGUoe1xuICAgICAgICAgICAgbW9kdWxlICAgOiBIZWFkZXJUb29sYmFyLFxuICAgICAgICAgICAgYWN0aW9ucyAgOiBbe2FjdGlvbjogJ2Nsb3NlJywgaWNvbkNsczogJ2ZhLXNvbGlkIGZhLXhtYXJrJ31dLFxuICAgICAgICAgICAgYXBwTmFtZSAgOiBtZS5hcHBOYW1lLFxuICAgICAgICAgICAgY2xzLFxuICAgICAgICAgICAgZG9jayAgICAgOiAndG9wJyxcbiAgICAgICAgICAgIGZsZXggICAgIDogJ25vbmUnLFxuICAgICAgICAgICAgaWQgICAgICAgOiBtZS5nZXRIZWFkZXJUb29sYmFySWQoKSxcbiAgICAgICAgICAgIGxpc3RlbmVyczoge2hlYWRlckFjdGlvbjogbWUuZXhlY3V0ZUhlYWRlckFjdGlvbiwgc2NvcGU6IG1lfSxcbiAgICAgICAgICAgIGl0ZW1zICAgIDogW3tcbiAgICAgICAgICAgICAgICBudHlwZTogJycsXG4gICAgICAgICAgICAgICAgY2xzICA6IFsnbmVvLWRpYWxvZy1oZWFkZXItaWNvbicsIC4uLm1lLmljb25DbHNdLFxuICAgICAgICAgICAgICAgIGZsYWcgOiAnZGlhbG9nLWhlYWRlci1pY29uJyxcbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICBudHlwZSA6ICdsYWJlbCcsXG4gICAgICAgICAgICAgICAgY2xzICAgOiBbJ25lby1wYW5lbC1oZWFkZXItdGV4dCcsICduZW8tbGFiZWwnXSxcbiAgICAgICAgICAgICAgICBmbGFnICA6ICdwYW5lbC1oZWFkZXItdGl0bGUnLFxuICAgICAgICAgICAgICAgIGhpZGRlbjogIW1lLnRpdGxlLFxuICAgICAgICAgICAgICAgIHRleHQgIDogbWUudGl0bGVcbiAgICAgICAgICAgIH0sIC4uLm1lLmhlYWRlckNvbmZpZy5pdGVtcyB8fCBbXV0sXG5cbiAgICAgICAgICAgIC4uLmhlYWRlckNvbmZpZ0NvcHlcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaGVhZGVycy51bnNoaWZ0KG1lLmhlYWRlclRvb2xiYXIpO1xuXG4gICAgICAgIG1lLmhlYWRlcnMgPSBoZWFkZXJzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIHtPYmplY3R9IGRhdGFcbiAgICAgKi9cbiAgICBleGVjdXRlSGVhZGVyQWN0aW9uKGRhdGEpIHtcbiAgICAgICAgbGV0IG1lID0gdGhpcyxcblxuICAgICAgICBtYXAgPSB7XG4gICAgICAgICAgICBjbG9zZTogbWUuY2xvc2VcbiAgICAgICAgfTtcblxuICAgICAgICBtYXBbZGF0YS5hY3Rpb25dPy5jYWxsKG1lLCBkYXRhKTtcblxuICAgICAgICBtZS5maXJlKCdoZWFkZXJBY3Rpb24nLCB7XG4gICAgICAgICAgICBkaWFsb2c6IG1lLFxuICAgICAgICAgICAgLi4uZGF0YVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIGlkIG9mIHRoZSBoZWFkZXIgdG9vbGJhclxuICAgICAqIEByZXR1cm5zIHtTdHJpbmd9XG4gICAgICovXG4gICAgZ2V0SGVhZGVyVG9vbGJhcklkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pZCArICctaGVhZGVyLXRvb2xiYXInO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNob3dzIHRoZSBkaWFsb2cgKHdpdGggLyB3aXRob3V0IE1vZGFsKSBpbiBtYWluIHRocmVhZFxuICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gbW9kYWxcbiAgICAgKi9cbiAgICBhc3luYyBzaG93KG1vZGFsID0gdHJ1ZSkge1xuICAgICAgICBsZXQgbWUgPSB0aGlzO1xuXG4gICAgICAgIGF3YWl0IG1lLnRpbWVvdXQoMjApO1xuXG4gICAgICAgIE5lby5tYWluLmFkZG9uLkRpYWxvZ1ttb2RhbCA/ICdzaG93TW9kYWwnOiAnc2hvdyddKHtcbiAgICAgICAgICAgIGFwcE5hbWU6IG1lLmFwcE5hbWUsXG4gICAgICAgICAgICBpZCAgICAgOiBtZS5pZFxuICAgICAgICB9KTtcbiAgICB9XG59XG5cbk5lby5hcHBseUNsYXNzQ29uZmlnKERpYWxvZyk7XG5cbmV4cG9ydCBkZWZhdWx0IERpYWxvZztcbiIsImltcG9ydCBCYXNlIGZyb20gJy4uLy4uL3Rvb2xiYXIvQmFzZS5tanMnO1xuXG4vKipcbiAqIEBjbGFzcyBOZW8uZGlhbG9nLmhlYWRlci5Ub29sYmFyXG4gKiBAZXh0ZW5kcyBOZW8udG9vbGJhci5CYXNlXG4gKi9cbmNsYXNzIFRvb2xiYXIgZXh0ZW5kcyBCYXNlIHtcbiAgICBzdGF0aWMgY29uZmlnID0ge1xuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7U3RyaW5nfSBjbGFzc05hbWU9J05lby5kaWFsb2cuaGVhZGVyLlRvb2xiYXInXG4gICAgICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgICAgICovXG4gICAgICAgIGNsYXNzTmFtZTogJ05lby5kaWFsb2cuaGVhZGVyLlRvb2xiYXInLFxuICAgICAgICAvKipcbiAgICAgICAgICogQG1lbWJlciB7T2JqZWN0fSBhY3Rpb25NYXBcbiAgICAgICAgICovXG4gICAgICAgIGFjdGlvbk1hcDoge1xuICAgICAgICAgICAgY2xvc2UgICA6ICgpID0+ICh7YWN0aW9uOiAnY2xvc2UnLCAgICBpY29uQ2xzOiAnZmFyIGZhLXdpbmRvdy1jbG9zZSd9KSxcbiAgICAgICAgICAgIG1heGltaXplOiAoKSA9PiAoe2FjdGlvbjogJ21heGltaXplJywgaWNvbkNsczogJ2ZhciBmYS13aW5kb3ctbWF4aW1pemUnfSlcbiAgICAgICAgfSxcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFlvdSBjYW4gZGVmaW5lIHRoZSBhY3Rpb24gb3JkZXIgYW5kIGRpcmVjdGx5IGFkZCBjdXN0b20gYWN0aW9ucy5cbiAgICAgICAgICogQGV4YW1wbGVcbiAgICAgICAgICoge1xuICAgICAgICAgKiAgICAgYWN0aW9uczogW1xuICAgICAgICAgKiAgICAgICAgICdjbG9zZScsXG4gICAgICAgICAqICAgICAgICAgJ21heGltaXplJyxcbiAgICAgICAgICogICAgICAgICB7YWN0aW9uOiAnaGVscCcsIGljb25DbHM6ICdmYXIgZmEtY2lyY2xlLXF1ZXN0aW9uJ31cbiAgICAgICAgICogICAgIF1cbiAgICAgICAgICogfVxuICAgICAgICAgKlxuICAgICAgICAgKiBZb3UgY2FuIGFsc28gZXh0ZW5kIHRoZSBhY3Rpb25NYXAgaWYgbmVlZGVkLlxuICAgICAgICAgKiBAbWVtYmVyIHtPYmplY3RbXXxTdHJpbmdbXXxudWxsfSBhY3Rpb25zPVsnbWF4aW1pemUnLCdjbG9zZSddXG4gICAgICAgICAqL1xuICAgICAgICBhY3Rpb25zOiBbJ21heGltaXplJywgJ2Nsb3NlJ10sXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAbWVtYmVyIHtTdHJpbmd8bnVsbH0gdGl0bGU9bnVsbFxuICAgICAgICAgKi9cbiAgICAgICAgdGl0bGVfOiBudWxsXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVHJpZ2dlcmVkIGFmdGVyIHRoZSB0aXRsZSBjb25maWcgZ290IGNoYW5nZWRcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gdmFsdWVcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gb2xkVmFsdWVcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICovXG4gICAgYWZ0ZXJTZXRUaXRsZSh2YWx1ZSwgb2xkVmFsdWUpIHtcbiAgICAgICAgdGhpcy5kb3duKHtmbGFnOiAndGl0bGUtbGFiZWwnfSk/LnNldCh7XG4gICAgICAgICAgICBoaWRkZW46ICF2YWx1ZSxcbiAgICAgICAgICAgIHRleHQgIDogdmFsdWVcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKlxuICAgICAqL1xuICAgIGNyZWF0ZUl0ZW1zKCkge1xuICAgICAgICBsZXQgbWUgICAgICA9IHRoaXMsXG4gICAgICAgICAgICBoYW5kbGVyID0gbWUuZmlyZUFjdGlvbi5iaW5kKG1lKSxcbiAgICAgICAgICAgIGl0ZW1zICAgPSBtZS5pdGVtcyB8fCBbXTtcblxuICAgICAgICBpdGVtcy5wdXNoKHtcbiAgICAgICAgICAgIG50eXBlIDogJ2xhYmVsJyxcbiAgICAgICAgICAgIGNscyAgIDogWyduZW8tcGFuZWwtaGVhZGVyLXRleHQnLCAnbmVvLWxhYmVsJ10sXG4gICAgICAgICAgICBmbGFnICA6ICd0aXRsZS1sYWJlbCcsXG4gICAgICAgICAgICBoaWRkZW46ICFtZS50aXRsZSxcbiAgICAgICAgICAgIHRleHQgIDogbWUudGl0bGVcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKG1lLmFjdGlvbnMpIHtcbiAgICAgICAgICAgIGl0ZW1zLnB1c2goJy0+Jyk7XG5cbiAgICAgICAgICAgIG1lLmFjdGlvbnMuZm9yRWFjaChhY3Rpb24gPT4ge1xuICAgICAgICAgICAgICAgIGlmIChOZW8udHlwZU9mKGFjdGlvbikgIT09ICdPYmplY3QnKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbiA9IG1lLmFjdGlvbk1hcFthY3Rpb25dKClcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpdGVtcy5wdXNoKHtoYW5kbGVyLCAuLi5hY3Rpb259KVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuXG4gICAgICAgIG1lLml0ZW1zID0gaXRlbXM7XG5cbiAgICAgICAgc3VwZXIuY3JlYXRlSXRlbXMoKVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBkYXRhXG4gICAgICovXG4gICAgZmlyZUFjdGlvbihkYXRhKSB7XG4gICAgICAgIGxldCBjb21wb25lbnQgPSBkYXRhLmNvbXBvbmVudDtcblxuICAgICAgICB0aGlzLmZpcmUoJ2hlYWRlckFjdGlvbicsIHtcbiAgICAgICAgICAgIGFjdGlvbjogY29tcG9uZW50LmFjdGlvbixcbiAgICAgICAgICAgIGNvbXBvbmVudCxcbiAgICAgICAgICAgIHNjb3BlIDogdGhpc1xuICAgICAgICB9KVxuICAgIH1cbn1cblxuTmVvLmFwcGx5Q2xhc3NDb25maWcoVG9vbGJhcik7XG5cbmV4cG9ydCBkZWZhdWx0IFRvb2xiYXI7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=